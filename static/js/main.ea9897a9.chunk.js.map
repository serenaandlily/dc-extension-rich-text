{"version":3,"sources":["../../common/dist/index.js","../../common/dist/languages/index.js","../../common/dist/languages/RichLanguageFormat.js","../../common/dist/dialogs/index.js","../../common/dist/tools/index.js","../../common/dist/tools/StandardTools.js","../../common/dist/actions/index.js","../../common/dist/editor/index.js","../../language-json/dist/index.js","CodeTextArea/CodeTextArea.tsx","ProseMirror/ProseMirror.tsx","ViewSwitcher/ViewSwitcher.tsx","ProseMirrorToolbar/ProseMirrorToolbarContext.ts","ProseMirrorToolbarIconButton/ProseMirrorToolbarIconButton.tsx","ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown.tsx","ProseMirrorToolbarGroup/ProseMirrorToolbarGroup.tsx","RichTextEditor/RichTextEditorContext.tsx","SparklesIcon/SparklesIcon.tsx","Loader/Loader.tsx","ProseMirrorToolbar/ProseMirrorToolbar.tsx","RichTextEditor/DefaultToolbar.ts","AIPromptDialog/AIConfiguration.ts","AIPromptDialog/info-icon.svg","AIPromptDialog/AIPromptDialog.tsx","gainsight.ts","RichTextActions/RichTextActionsImpl.tsx","AnchorDialog/AnchorDialog.tsx","CodeDialog/CodeDialog.tsx","HyperlinkDialog/HyperlinkDialog.tsx","ImageDialog/ImageDialog.tsx","RichTextDialogs/RichTextDialogsContext.ts","RichTextDialogs/RichTextAlert.tsx","RichTextDialogs/RichTextDialogsContainer.tsx","RichTextEditorAIActionsBar/RichTextEditorAIActionsBar.tsx","CreditsError/CreditsError.tsx","HubContext/HubContext.ts","RichTextEditor/RichTextEditor.tsx","ProseMirrorToolbar/ProseMirrorToolbarState.ts","EditorRichTextField/EditorRichTextField.tsx","theme.ts","App.tsx","index.tsx","../../common/dist/tools/StandardToolOptions.js","../../common/dist/utils/ProseMirrorUtils.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkNode.js","../../prosemirror-dynamic-content/dist/InlineChooser/InlineChooser.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkView.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkNode.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkView.js","../../prosemirror-dynamic-content/dist/DynamicContentTools/DynamicContentTools.js","../../language-markdown/dist/alignment/AlignmentTools.js","../../language-markdown/dist/anchor/AnchorNode.js","../../language-markdown/dist/anchor/AnchorTool.js","../../language-markdown/dist/anchor/AnchorToMarkdown.js","../../language-markdown/dist/inline_styles/InlineStylesMark.js","../../language-markdown/dist/utils/MarkUtils.js","../../language-markdown/dist/inline_styles/InlineStylesTool.js","../../language-markdown/dist/inline_styles/InlineStylesToMarkdown.js","../../language-markdown/dist/alignment/RecursiveHtmlBlock.js","../../language-markdown/dist/soft_hyphen/SoftHyphenFromMarkdown.js","../../language-markdown/dist/soft_hyphen/SoftHyphenNode.js","../../language-markdown/dist/soft_hyphen/SoftHyphenToMarkdown.js","../../language-markdown/dist/markdown/MarkdownParser.js","../../language-markdown/dist/alignment/AlignmentPlugin.js","../../language-markdown/dist/tables/TableToMarkdown.js","../../language-markdown/dist/markdown/MarkdownSerializer.js","../../language-markdown/dist/schema/createSchema.js","../../language-markdown/dist/tables/TableTools.js","../../language-markdown/dist/MarkdownLanguage.js","../../language-markdown/dist/soft_hyphen/SoftHyphenTool.js","../../language-markdown/dist/MarkdownLanguageConfiguration.js","../../language-markdown/dist/index.js","../../language-json/dist/blocks/DcImageLinkBlock.js","../../language-json/dist/blocks/MarkdownBlock.js","../../language-json/dist/JSONLanguageConfiguration.js","../../language-json/dist/blocks/DcContentLinkBlock.js","../../language-json/dist/JSONLanguage.js"],"names":["RichLanguageFormat","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","_a","require","undoFn","undo","redoFn","redo","_b","toggleMark","setBlockType","lift","wrapInList","findParentNode","createMarkToggleTool","name","icon","type","displayIcon","isActive","state","isMarkActive","editLink","_this","dispatch","richTextEditorContext","marks","attrs","markAttrs","linkValue","newAttrs","tr","selection","getSelectionMarks","filter","mark","href","title","openInNewTab","target","dialogs","getHyperlink","cancel","undefined","rel","from","to","addMark","create","removeMark","editCode","params","val","getCurrentParams","getCode","insertImage","imageValue","getImage","replaceSelectionWith","createAndFill","src","alt","parent","x","node","blockTypeCommand","align","getCurrentAlignment","heading","schema","level","displayLabel","React","createElement","style","margin","nodes","isEnabled","view","createStandardTools","options","tools","isToolEnabled","Undo","Redo","strong","FormatBold","em","FormatItalic","code","Code","link","Link","empty","FormatIndentDecrease","isVisible","bullet_list","FormatListBulleted","ordered_list","FormatListNumbered","image","ImageIcon","blockquote","FormatQuote","paragraph","padding","display","code_block","horizontal_rule","CalendarViewDay","canInsert","FormatClearIcon","clearAllMarks","language","JSONLanguage","conf","JSONLanguageConfiguration","withStyles","root","flex","minHeight","maxHeight","textarea","outline","resize","backgroundColor","border","fontFamily","fontSize","props","classes","onChange","readOnly","handleChange","useCallback","event","className","EditorState","EditorView","exampleSetup","tableEditing","columnResizing","keymap","sinkListItem","getKeys","Tab","list_item","ProseMirror","ref","createRef","isLocked","doc","tablePlugins","table","plugins","menuBar","onUpdateState","editorState","createEditorState","self","editorViewOptions","dispatchTransaction","transaction","applyTransaction","transactions","updateState","scrollToSelection","domAtPos","anchor","scrollIntoView","some","docChanged","forceUpdate","editable","_props","bind","editorView","createEditorView","current","setState","prevProps","prevState","snapshot","Component","width","overflowY","marginBottom","button","transition","height","cursor","background","borderTop","borderBottom","color","fontWeight","selected","borderBottomColor","disableCodeView","disableEditView","useState","CODE","EDIT","selectedView","setSelectedView","renderButton","onClick","clsx","role","ProseMirrorToolbarContext","createContext","tooltip","maxWidth","arrow","toolName","useContext","getToolState","applyTool","toolState","handleClick","focus","document","activeElement","setTimeout","visible","Tooltip","IconButton","onMouseDown","size","disabled","enabled","active","paddingLeft","paddingRight","toolNames","toolStates","map","selectedItems","find","test","renderValue","cloneElement","Select","displayEmpty","preventDefault","MenuItem","key","alignItems","verticalAlign","lineHeight","borderRight","children","context","proseMirrorEditorView","actions","languages","sdk","hub","setIsLocked","locked","setShowCreditsError","show","useRichTextEditorContext","SparklesIcon","variant","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","clipPath","d","id","Loader","cx","cy","r","attributeName","begin","dur","values","calcMode","keySplines","repeatCount","keyTimes","styles","createStyles","flexWrap","group","alignSelf","textTransform","textAlign","divider","tooltips","layout","toolbarState","group1","slice","group2","isAiToolEnabled","ai","isContentStudioEnabled","contentStudio","renderToolbarElement","idx","element","findIndex","child","tool","toolVisible","showAIGenerateDialog","a","getAIPrompt","prompt","keywords","insertAIContent","launchContentStudio","insertContentStudioContent","Provider","areInlineStyles","keys","clearFormatting","disableGutters","Button","startIcon","DEFAULT_EDIT_PROMPTS","AIConfiguration","model","editPrompts","_extends","source","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","mask","_ref","svgRef","maskType","maskUnits","ForwardRef","forwardRef","minWidth","configureContent","configureGraphic","position","right","top","getStartedAction","borderRadius","cancelAction","marginLeft","keywordsContainer","chip","keywordCheckIcon","infoIcon","transform","CloseButton","aria-label","disableFocusRipple","disableRipple","Close","DialogHeader","onClose","DialogTitle","paddingBottom","gap","installation","instance","form","getValue","catch","pointer","get","keywordSource","SeoKeywords","chipStyles","useKeywords","Grid","container","spacing","item","Typography","SvgIcon","join","Chip","Check","handleKeywordClick","AIPromptDialogContent","SdkContext","onSubmit","setPrompt","setKeywords","setUseKeywords","useEffect","getKeywords","split","keyword","trim","strings","generate","placeholder","rewrite","handleSubmit","DialogContent","TextField","onKeyUp","keyCode","multiline","rowsMax","InputProps","endAdornment","InputAdornment","disableElevation","fullWidth","underline","DialogActions","open","configuration","Dialog","aria-labelledby","aptrinsicId","process","REACT_APP_APTRINSIC_ID","track","win","eventName","aptrinsic","CHAT_MODELS","version","maxTokens","getSuitableModel","desiredModelName","estimatedConsumedTokens","desiredModel","rightSizeModel","getDelta","usesKey","data","payload","JSON","parse","choices","delta","content","getCompletionUrl","prompts","hasKey","getKey","convertRolesToUppercase","toUpperCase","connection","request","mutation","vars","orgId","btoa","organizationId","generateRichText","url","invokeChatCompletions","onMessage","onError","maxOutputTokens","estimatedInputTokens","messages","reduce","partialSum","markdownBuffer","completionUrl","headers","Authorization","fetchEventSource","method","stringify","getModel","max_tokens","stream","onmessage","err","onopen","response","window","category","contentType","startsWith","json","Error","onerror","RichTextActionsImpl","datadogRum","addAction","cut","bodyMarkdown","serializeMarkdown","selectionMarkdown","handleInsertAIContent","formatRewritePrompt","startPosition","endPosition","resolved","buffer","complete","isEmpty","isDialog","couldBeDialog","alert","updateContent","Assistant","severity","fragment","parseMarkdown","replaceWith","newState","Math","max","errors","extensions","error","message","studio","AmplienceContentStudio","baseUrl","getContent","textFields","htmlIdRegex","AnchorDialog","existing","Set","setValue","lastValue","setLastValue","validate","checkValue","has","validateId","valid","validError","setValidError","handleInputChanged","fieldValue","newValue","reset","handleCancel","FormControl","autoFocus","required","helperText","FormHelperText","CodeDialog","HyperlinkDialog","isValid","setIsValid","validateUrl","handleClear","FormControlLabel","control","Checkbox","checked","ImageDialog","theme","typography","body2","flexDirection","shape","success","darken","palette","main","lighten","info","warning","fontWeightMedium","header","marginRight","opacity","action","alertId","RichTextDialogsContainer","openDialog","setOpenDialog","useReducer","alertIndex","splice","alerts","dispatchAlertEvent","handleCloseDialog","handleSubmitDialog","handleOpenDialog","handleUpdateAlertContent","handleCloseAlert","getAnchor","getDcImageLink","mediaLink","getDcContentLink","contentTypeIds","contentLink","dialogProps","alertProps","RichTextDialogsContext","Snackbar","autoHideDuration","anchorOrigin","vertical","horizontal","paddingTop","bottom","showCreditsError","getEditPrompts","handleEditPrompt","rewriteSelectedContentUsingAI","handleCustomAiRewrite","direction","visibility","CreditsError","textDecoration","frame","languagesProp","languageProp","toolbarLayoutProp","toolbarLayout","disableToolbar","readOnlyCodeView","valueProp","setProseMirrorEditorView","markdown","MarkdownLanguage","languageConfiguration","HubContext","editorContext","setRichTextEditorContext","setView","format","rawValue","setRawValue","proseMirrorDocument","setProseMirrorDocument","handleRawValueChange","newProseMirrorDocument","handleEditorChange","newRawValue","serialize","setToolbarState","DefaultToolbar","handleEditorUpdateState","computeToolbarState","loading","boxSizing","toolOptions","useMemo","settings","useClasses","classOverride","dynamicContent","stagingEnvironment","blacklist","nodeViews","getPos","DcImageLinkView","DcContentLinkView","dangerouslySetInnerHTML","__html","stylesheet","toolbar","codeView","outerTheme","forEach","App","connected","handleValueChange","handleChooseLink","handleConnect","handleInitRum","ddToken","REACT_APP_DATADOG_TOKEN","ddAppId","REACT_APP_DATADOG_APP_ID","ddEnv","REACT_APP_DATADOG_ENV_ID","init","applicationId","clientToken","env","site","service","trackResources","trackLongTasks","trackUserInteractions","defaultPrivacyLevel","sampleRate","useCrossSiteSessionCookie","proxy","startSessionReplayRecording","startAutoResizer","contentItem","getCurrent","setGlobalContext","deliveryId","field","withTheme","ThemeProvider","ReactDOM","render","getElementById","q","c","allowCrossDomain","script","async","getElementsByTagName","parentNode","insertBefore","initGainsight","whitelist","classNameRegex","getCustomClass","defaultName","name_1","getDefaultClass","customName","classes_1","inBlock","$from","depth","isInSet","storedMarks","rangeHasMark","$to","currentMarks","nodesBetween","pos","start","nodeSize","index","canReplaceWith","$cursor","ranges","_i","marks_1","removeStoredMark","ranges_1","range","_c","markName","DcImageLinkNode","defining","draggable","atom","parseDOM","tag","getAttrs","dom","getAttribute","toDOM","__rest","aspectRatio","other","aspectRatioPaddingTop","components","round","Number","Fragment","ViewComponent","broken","invalid","statusIcons","left","alignContent","justifyContent","onDelete","setBroken","setLoading","handleLoading","handleError","handleLoaded","hasValidValue","endpoint","Fab","StyledFab","InlineChooser","defaultHost","encodeURIComponent","onLoadStart","onLoad","CircularProgress","BrokenImageIcon","ChooserActions","DeleteIcon","handleDelete","delete","DcContentLinkNode","boxShadow","backgroundSize","backgroundRepeat","backgroundPosition","contentLinkOptions","Array","isArray","result_1","cards","icons","aspectRatios","setting","card","convertSettings","contentTypeSettings","customIcon","getContentTypeIcon","cardTemplateUrl","getContentTypeCard","schemaId","getContentTypeAspectRatio","backgroundImage","ContentItemIcon","Visualization","template","contentItemId","createDynamicContentTools","ImageSearchIcon","dcImageLink","contentTypes","AddCircleIcon","dcContentLink","getContainingTextBlocks","resultNodes","isTextblock","add","alignment","setNodeMarkup","alignActive","anyMismatch","alignable","inline","insertAnchor","existingAnchors_1","addAnchor_1","anchorValue","AnchorToMarkdown","attrsSerialized","write","inline_styles","class","default","attributes","getMarkFromRange","markType","mergeAttrs","oldAttrs","inlineStyleClassNameTool","classLabel","existingMark","getStoredMark","addStoredMark","ref$1","ref$2","$from$1","$to$1","found","rangeHasFilteredMark","isFilteredMarkActive","m","InlineStylesToMarkdown","close","HTML_OPEN_CLOSE_TAG_RE","RegExp","HTML_SEQUENCES","html_block","startLine","endLine","silent","nextLine","token","lineText","bMarks","tShift","eMarks","sCount","blkIndent","md","html","charCodeAt","getLines","DOMParser","parseFromString","firstChild","innerContent","innerHTML","line","meta","tagName","soft_hyphen_from","soft_hyphen","SoftHyphenToMarkdown","markdownit","markdownItTable","createMarkdownParser","linkify","use","ruler","before","block","parser","MarkdownParser","defaultMarkdownParser","tokens","tok","attrGet","fence","noCloseToken","th","td","originalParagraph","tokenHandlers","replace","html_inline","endsWith","nodeName","toLowerCase","openMark","closeMark","addNode","hard_break","linkMatch","match","content_1","hrefMatch","titleMatch","targetMatch","relMatch","addText","alignedParagraphTypes","Map","alignmentClasses","html_block_open","styleAttr","attr","alignAttr","ownerElement","classAttr","classList","asDefault","nodeType","openNode","html_block_close","closeNode","paragraph_align","getHeadingAttrs","heading_align","TableToMarkdown","rows","childCount","maybeChild","columnCount","closeBlock","table_row","_loop_1","out","substr","trimEnd","padEnd","closed","withTableEscapes","renderInline","table_cell","table_header","TextToMarkdown","text","escape","createMarkdownSerializer","serializers","defaultMarkdownSerializer","MarkdownSerializer","AlignedParagraphToMarkdown","repeat","AlignedHeaderToMarkdown","_linkOpen","openIndex","lastIndexOf","linkText","originalSerialize","output","_m","nl","tableNodes","Schema","inTable","path","$head","generateEmptyCell","fromArray","insertTable","__spreadArrays","il","k","j","jl","createMarkdownTools","concat","inlineStylesOptions","classNames","createInlineStylesTools","Directions","AnchorTool","Remove","SoftHyphenTool","FormatAlignLeft","FormatAlignCenter","FormatAlignRight","FormatAlignJustify","TableChart","CreateTableTool","BorderClear","deleteTable","VerticalAlignBottom","addRowAfter","LastPage","addColumnAfter","VerticalAlignTop","deleteRow","FirstPage","deleteColumn","createSchema","serializer","getNodeSerializers","canSerializeNodeToMarkdown","isInlineStylesEnabled","spec","update","inclusive","addToEnd","append","tableGroup","cellContent","cellAttributes","getFromDOM","setDOMAttr","TEXT","MarkdownLanguageConfiguration","Node","DcImageLinkBlock","canSerialize","canParse","blocks","MarkdownBlock","markdownLanguage","parsedNodes","fromJSON","toJSON","DcContentLinkBlock","__extends","extendStatics","b","setPrototypeOf","__proto__","__","constructor","_super","blockTypes","markdownBlock","nodesByConverter","groupBy","blockType","nodesByConverter_1","groupBlocks","items","blocksGroupedByConverter","blocksGroupedByConverter_1","addBefore","groupFn","currentGroup","currentGroupItems","items_1","itemGroup"],"mappings":"uJAAA,w0F,iCCAA,+wD,yECAO,IAAIA,EAAX,kCACA,SAAWA,GACPA,EAAkB,KAAW,OAC7BA,EAAkB,KAAW,OAFjC,CAGGA,IAAuBA,EAAqB,M,qDCJ/C,smB,qDCAA,66C,yECAA,gTAAIC,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAE5BQ,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,IAAW,MAAOG,GAAKL,EAAOK,IACpF,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAS,MAAUK,IAAW,MAAOG,GAAKL,EAAOK,IACvF,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,OAITO,KAAKR,EAAWK,GAClGH,GAAMN,EAAYA,EAAUN,MAAMG,EAASC,GAAc,KAAKS,YAGlEM,EAA4C,SAAUhB,EAASiB,GAC/D,IAAsGC,EAAGC,EAAGhC,EAAGiC,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAPpC,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOqC,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAEV,KAAMgB,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,oBAAXC,SAA0BP,EAAEO,OAAOC,UAAY,WAAa,OAAO9B,OAAUsB,EACvJ,SAASM,EAAKpC,GAAK,OAAO,SAAUuC,GAAK,OACzC,SAAcC,GACV,GAAIZ,EAAG,MAAM,IAAIa,UAAU,mCAC3B,KAAOV,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMhC,EAAY,EAAR2C,EAAG,GAASX,EAAC,OAAaW,EAAG,GAAKX,EAAC,SAAehC,EAAIgC,EAAC,SAAehC,EAAES,KAAKuB,GAAI,GAAKA,EAAET,SAAWvB,EAAIA,EAAES,KAAKuB,EAAGW,EAAG,KAAKhB,KAAM,OAAO3B,EAE3J,OADIgC,EAAI,EAAGhC,IAAG2C,EAAK,CAAS,EAARA,EAAG,GAAQ3C,EAAEqB,QACzBsB,EAAG,IACP,KAAK,EAAG,KAAK,EAAG3C,EAAI2C,EAAI,MACxB,KAAK,EAAc,OAAXT,EAAEC,QAAgB,CAAEd,MAAOsB,EAAG,GAAIhB,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIW,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKT,EAAEI,IAAIO,MAAOX,EAAEG,KAAKQ,MAAO,SACxC,QACI,KAAkB7C,GAAZA,EAAIkC,EAAEG,MAAYhC,OAAS,GAAKL,EAAEA,EAAEK,OAAS,MAAkB,IAAVsC,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAET,EAAI,EAAG,SACjG,GAAc,IAAVS,EAAG,MAAc3C,GAAM2C,EAAG,GAAK3C,EAAE,IAAM2C,EAAG,GAAK3C,EAAE,IAAM,CAAEkC,EAAEC,MAAQQ,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYT,EAAEC,MAAQnC,EAAE,GAAI,CAAEkC,EAAEC,MAAQnC,EAAE,GAAIA,EAAI2C,EAAI,MAC7D,GAAI3C,GAAKkC,EAAEC,MAAQnC,EAAE,GAAI,CAAEkC,EAAEC,MAAQnC,EAAE,GAAIkC,EAAEI,IAAIQ,KAAKH,GAAK,MACvD3C,EAAE,IAAIkC,EAAEI,IAAIO,MAChBX,EAAEG,KAAKQ,MAAO,SAEtBF,EAAKb,EAAKrB,KAAKI,EAASqB,GAC1B,MAAOV,GAAKmB,EAAK,CAAC,EAAGnB,GAAIQ,EAAI,EAjBrB,QAiBoCD,EAAI/B,EAAI,EACtD,GAAY,EAAR2C,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEtB,MAAOsB,EAAG,GAAKA,EAAG,QAAK,EAAQhB,MAAM,GArB9BL,CAAK,CAACnB,EAAGuC,OAyCzDK,EAAKC,EAAQ,IAAwBC,EAASF,EAAGG,KAAMC,EAASJ,EAAGK,KAEnEC,EAAKL,EAAQ,IAAyBM,EAAaD,EAAGC,WAAYC,EAAeF,EAAGE,aAAcC,EAAOH,EAAGG,KAE5GC,EAAaT,EAAQ,IAA2BS,WAEhDC,EAAiBV,EAAQ,KAAqBU,eAC3C,SAASC,EAAqBC,EAAMzB,EAAO0B,EAAMC,GACpD,MAAO,CACHF,KAAMA,EACNzB,MAAOA,EACP4B,YAAaF,EACbG,SAAU,SAAUC,GAAS,OAAOC,YAAaD,EAAOH,IACxDpD,MAAO4C,EAAWQ,IA8BnB,SAASK,EAASL,GACrB,IAAIM,EAAQzD,KACZ,OAAO,SAAUsD,EAAOI,EAAUC,GAAyB,OAAO1D,EAAUwD,OAAO,OAAQ,GAAQ,WAC/F,IAAIG,EAAOC,EAAOC,EAAWC,EAAWC,EAAUC,EAAIC,EACtD,OAAOhD,EAAYlB,MAAM,SAAUoC,GAC/B,OAAQA,EAAGZ,OACP,KAAK,EAEoB,KADrBoC,EAAQO,YAAkBb,GAAOc,QAAO,SAAUC,GAAQ,OAAOA,EAAKA,KAAKlB,OAASA,MAC1EzD,SACNoE,EAAYF,EAAM,GAAGS,KAAKR,MAC1BA,EAAQ,CACJS,KAAMR,EAAUQ,MAAQ,GACxBC,MAAOT,EAAUS,OAAS,GAE1BC,aAAmC,WAArBV,EAAUW,SAGhCrC,EAAGZ,MAAQ,EACf,KAAK,EAED,OADAY,EAAGV,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAawB,EAAsBe,QAAQC,aAAad,IACpE,KAAK,EAED,OADAE,EAAY3B,EAAGX,QACDmD,SAGdZ,EAAW,CACPM,KAAMP,EAAUO,KAChBC,MAA2B,KAApBR,EAAUQ,WAAeM,EAAYd,EAAUQ,MACtDE,OAAQV,EAAUS,aAAe,cAAWK,EAC5CC,IAAKf,EAAUS,aAAe,2BAAwBK,GAEtDjB,EAAMlE,OAAS,GACfuE,EAAKX,EAAMW,GAAIC,EAAYZ,EAAMY,UACX,KAAlBF,EAASM,OACLV,EAAMlE,OAAS,KACbwE,EAAUa,KAAOnB,EAAM,GAAGmB,MAAQb,EAAUc,GAAKpB,EAAM,GAAGoB,IAC5DtB,EAASO,EAAGgB,QAAQrB,EAAM,GAAGmB,KAAMnB,EAAM,GAAGoB,GAAI7B,EAAK+B,OAAOlB,KAG5DN,EAASO,EAAGgB,QAAQf,EAAUa,KAAMb,EAAUc,GAAI7B,EAAK+B,OAAOlB,OAKtErB,EAAWQ,EAAMa,EAAjBrB,CAA2BW,EAAOI,IArB3B,CAAC,GAwBhB,KAAK,EAED,OADQtB,EAAGX,OACJ,CAAC,EAAa,GACzB,KAAK,EAID,OAHI8B,YAAaD,EAAOH,IACpBO,EAASJ,EAAMW,GAAGkB,WAAWvB,EAAM,GAAGmB,KAAMnB,EAAM,GAAGoB,GAAI7B,IAEtD,CAAC,WAKrB,SAASiC,EAASjC,GACrB,IAAIM,EAAQzD,KACZ,OAAO,SAAUsD,EAAOI,EAAUC,GAAyB,OAAO1D,EAAUwD,OAAO,OAAQ,GAAQ,WAC/F,IAAI4B,EAAQC,EACZ,OAAOpE,EAAYlB,MAAM,SAAUoC,GAC/B,OAAQA,EAAGZ,OACP,KAAK,EACD6D,EAASE,EAAiBjC,EAAOH,GACjCf,EAAGZ,MAAQ,EACf,KAAK,EAED,OADAY,EAAGV,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAawB,EAAsBe,QAAQc,QAAQH,EAAOA,QAAU,KAChF,KAAK,EAED,OADAC,EAAMlD,EAAGX,OACF,CAAC,EAAcmB,EAAaO,EAAM,CAAEkC,OAAQC,GAA7B1C,CAAoCU,EAAOI,IACrE,KAAK,EAED,OADQtB,EAAGX,OACJ,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,WAkBzB,SAASgE,EAAYtC,GACxB,IAAIM,EAAQzD,KACZ,OAAO,SAAUsD,EAAOI,EAAUC,GAAyB,OAAO1D,EAAUwD,OAAO,OAAQ,GAAQ,WAC/F,IAAIiC,EACJ,OAAOxE,EAAYlB,MAAM,SAAUoC,GAC/B,OAAQA,EAAGZ,OACP,KAAK,EAED,OADAY,EAAGV,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAawB,EAAsBe,QAAQiB,YACvD,KAAK,EAOD,OANAD,EAAatD,EAAGX,OAChBiC,EAASJ,EAAMW,GAAG2B,qBAAqBzC,EAAK0C,cAAc,CACtDC,IAAKJ,EAAWI,IAChBvB,MAA4B,KAArBmB,EAAWnB,WAAeM,EAAYa,EAAWnB,MACxDwB,IAAwB,KAAnBL,EAAWK,SAAalB,EAAYa,EAAWK,QAEjD,CAAC,EAAa,GACzB,KAAK,EAED,OADQ3D,EAAGX,OACJ,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,WA8DhC,SAAS8D,EAAiBjC,EAAOH,GAC7B,GAAa,MAATG,GAA+B,eAAdH,EAAKF,KACtB,MAAO,GAGX,IAAI+C,EAASjD,GAAe,SAAUkD,GAAK,OAAOA,EAAEpC,MAAMwB,SAA7CtC,CAAwDO,EAAMY,WAC3E,OAAc,MAAV8B,EACO,CAAEX,OAAQW,EAAOE,KAAKrC,MAAMwB,QAAU,IAGtC,CAAEA,OAAQ,IAGzB,SAASc,EAAiB7C,EAAOH,EAAMU,GACnC,OAAOjB,EAAaO,EAAMjE,EAASA,EAAS,GAAI2E,GA3BpD,SAA6BP,GACzB,GAAa,MAATA,EACA,MAAO,GAGX,IAAI0C,EAASjD,GAAe,SAAUkD,GAAK,OAAOA,EAAEpC,MAAMuC,QAA7CrD,CAAuDO,EAAMY,WAC1E,OAAc,MAAV8B,EACO,CAAEI,MAAOJ,EAAOE,KAAKrC,MAAMuC,OAG3B,GAiB6CC,CAAoB/C,KAEzE,SAASgD,EAAQC,EAAQC,GAC5B,MAAO,CACHvD,KAAM,WAAauD,EACnBhF,MAAO,WAAagF,EACpBC,aAAcC,IAAMC,cAAc,IAAMH,EAAO,CAAEI,MAAO,CAAEC,OAAQ,IAAO,WAAaL,GACtFzG,MAAO,SAAUuD,EAAOI,GACpB,OAAOyC,EAAiB7C,EAAOiD,EAAOO,MAAMR,QAAS,CAAEE,MAAOA,GAAvDL,CAAgE7C,EAAOI,IAElFqD,UAAW,SAAUzD,GACjB,OAAO6C,EAAiB7C,EAAOiD,EAAOO,MAAMR,QAAS,CAAEE,MAAOA,GAAvDL,CAAgE7C,IAE3ED,SAAU,SAAUC,EAAO0D,GACvB,OAAQb,EAAiB7C,EAAOiD,EAAOO,MAAMR,QAAS,CAAEE,MAAOA,GAAvDL,CAAgE7C,EAAO,QAyDpF,SAAS2D,EAAoBV,EAAQW,GACxC,IAAIC,EAAQ,GAkCZ,GAjCIC,YAAc,OAAQF,IACtBC,EAAMhF,KApSH,CACHc,KAAM,OACNzB,MAAO,OACP4B,YAAasD,IAAMC,cAAcU,IAAM,MACvCN,UAAW,SAAUzD,GAAS,OAAOhB,EAAOgB,IAC5CvD,MAAOuC,IAiSP8E,YAAc,OAAQF,IACtBC,EAAMhF,KA9RH,CACHc,KAAM,OACNzB,MAAO,OACP4B,YAAasD,IAAMC,cAAcW,IAAM,MACvCP,UAAW,SAAUzD,GAAS,OAAOd,EAAOc,IAC5CvD,MAAOyC,IA2RP4E,YAAc,SAAUF,IAAYX,EAAO3C,MAAM2D,QACjDJ,EAAMhF,KAzRP,SAAgBoE,GACnB,OAAOvD,EAAqB,SAAU,OAAQ0D,IAAMC,cAAca,IAAY,MAAOjB,EAAO3C,MAAM2D,QAwRnFA,CAAOhB,IAElBa,YAAc,KAAMF,IAAYX,EAAO3C,MAAM6D,IAC7CN,EAAMhF,KAzRP,SAAYoE,GACf,OAAOvD,EAAqB,KAAM,SAAU0D,IAAMC,cAAce,IAAc,MAAOnB,EAAO3C,MAAM6D,IAwRnFA,CAAGlB,IAEda,YAAc,OAAQF,IAAYX,EAAO3C,MAAM+D,MAC/CR,EAAMhF,KAzRP,SAAcoE,GACjB,OAAOvD,EAAqB,OAAQ,OAAQ0D,IAAMC,cAAciB,IAAM,MAAOrB,EAAO3C,MAAM+D,MAwR3EA,CAAKpB,IAEhBa,YAAc,OAAQF,IAAYX,EAAO3C,MAAMiE,MAC/CV,EAAMhF,KAtMP,SAAcoE,GACjB,MAAO,CACHtD,KAAM,OACNzB,MAAO,qBACP4B,YAAasD,IAAMC,cAAcmB,IAAM,MACvCzE,SAAU,SAAUC,GAAS,OAAOC,YAAaD,EAAOiD,EAAO3C,MAAMiE,OACrEd,UAAW,SAAUzD,GACjB,OAASA,EAAMY,UAAU6D,OACrB5D,YAAkBb,GAAOc,QAAO,SAAUC,GAAQ,OAAOA,EAAKA,KAAKlB,OAASoD,EAAO3C,MAAMiE,QAASnI,OAAS,GAEnHK,MAAOyD,EAAS+C,EAAO3C,MAAMiE,OA4LlBA,CAAKtB,IAEhBa,YAAc,OAAQF,IACtBC,EAAMhF,KA1JH,CACHc,KAAM,OACNzB,MAAO,uBACP4B,YAAasD,IAAMC,cAAcqB,IAAsB,MACvDC,UAAW,SAAU3E,GAAS,OAAOT,EAAKS,IAC1CvD,MAAO8C,IAuJPuE,YAAc,cAAeF,IAAYX,EAAOO,MAAMoB,aACtDf,EAAMhF,KArJP,SAAqBoE,GACxB,MAAO,CACHtD,KAAM,cACNzB,MAAO,cACP4B,YAAasD,IAAMC,cAAcwB,IAAoB,MACrDpB,UAAW,SAAUzD,GAAS,OAAOR,EAAWyD,EAAOO,MAAMoB,YAAa,GAArCpF,CAAyCQ,IAC9EvD,MAAO+C,EAAWyD,EAAOO,MAAMoB,YAAa,KA+IjCA,CAAY3B,IAEvBa,YAAc,eAAgBF,IAAYX,EAAOO,MAAMsB,cACvDjB,EAAMhF,KA/IP,SAAsBoE,GACzB,MAAO,CACHtD,KAAM,eACNzB,MAAO,eACP4B,YAAasD,IAAMC,cAAc0B,IAAoB,MACrDtB,UAAW,SAAUzD,GAAS,OAAOR,EAAWyD,EAAOO,MAAMsB,aAAc,GAAtCtF,CAA0CQ,IAC/EvD,MAAO+C,EAAWyD,EAAOO,MAAMsB,aAAc,KAyIlCA,CAAa7B,IAExBa,YAAc,QAASF,IAAYX,EAAOO,MAAMwB,OAChDnB,EAAMhF,KA5KP,SAAeoE,GAClB,MAAO,CACHtD,KAAM,QACNzB,MAAO,wBACP4B,YAAasD,IAAMC,cAAc4B,IAAW,MAC5CxI,MAAO0F,EAAYc,EAAOO,MAAMwB,QAuKrBA,CAAM/B,IAEjBa,YAAc,aAAcF,IAAYX,EAAOO,MAAM0B,YACrDrB,EAAMhF,KA5IP,SAAoBoE,GACvB,MAAO,CACHtD,KAAM,aACNzB,MAAO,QACP4B,YAAasD,IAAMC,cAAc8B,IAAa,MAC9C1B,UAAW,SAAUzD,GAAS,OAAOR,EAAWyD,EAAOO,MAAM0B,WAAY,GAApC1F,CAAwCQ,IAC7EvD,MAAO+C,EAAWyD,EAAOO,MAAM0B,WAAY,KAsIhCA,CAAWjC,IAEtBa,YAAc,UAAWF,IAAYX,EAAOO,MAAMR,QAClD,IAAK,IAAI/G,EAAI,EAAGA,EAAI,EAAGA,IACnB4H,EAAMhF,KAAKmE,EAAQC,EAAQhH,IAgBnC,OAbI6H,YAAc,YAAaF,IAAYX,EAAOO,MAAM4B,WACpDvB,EAAMhF,KA9FP,SAAmBoE,GAEtB,OADc3D,EAAa2D,EAAOO,MAAM4B,WACjC,CACHzF,KAAM,YACNzB,MAAO,cACPiF,aAAeC,IAAMC,cAAc,IAAK,CAAEC,MAAO,CAAEC,OAAQ,EAAG8B,QAAS,EAAGC,QAAS,WAAc,eACjG7I,MAAO,SAAUuD,EAAOI,GACpB,OAAOyC,EAAiB7C,EAAOiD,EAAOO,MAAM4B,UAArCvC,CAAgD7C,EAAOI,IAElEqD,UAAW,SAAUzD,GACjB,OAAO6C,EAAiB7C,EAAOiD,EAAOO,MAAM4B,UAArCvC,CAAgD7C,IAE3DD,SAAU,SAAUC,GAChB,OAAQ6C,EAAiB7C,EAAOiD,EAAOO,MAAM4B,UAArCvC,CAAgD7C,EAAO,QAiFxDoF,CAAUnC,IAErBa,YAAc,aAAcF,IAAYX,EAAOO,MAAM+B,YACrD1B,EAAMhF,KAhFP,SAAoBoE,GACvB,MAAO,CACHtD,KAAM,aACNzB,MAAO,aACPiF,aAAcC,IAAMC,cAAc,OAAQ,KAAM,cAChDvD,YAAasD,IAAMC,cAAciB,IAAM,MACvC7H,MAAOqF,EAASmB,EAAOO,MAAM+B,YAC7BxF,SAAU,SAAUC,EAAOK,GACvB,IAAI0B,EAASE,EAAiBjC,EAAOiD,EAAOO,MAAM+B,YAClD,OAAQjG,EAAa2D,EAAOO,MAAM+B,WAAY3J,EAAS,GAAImG,GAAnDzC,CAA4DU,EAAO,QAuEpEuF,CAAWtC,IAEtBa,YAAc,kBAAmBF,IACjCX,EAAOO,MAAMgC,iBACb3B,EAAMhF,KAvEP,SAAyBoE,GAC5B,MAAO,CACHtD,KAAM,kBACNzB,MAAO,yBACP4B,YAAasD,IAAMC,cAAcoC,IAAiB,MAClDhJ,MAAO,SAAUuD,EAAOI,GACpBA,EAASJ,EAAMW,GAAG2B,qBAAqBW,EAAOO,MAAMgC,gBAAgB5D,YAExE6B,UAAW,SAAUzD,GAAS,OAAO0F,YAAU1F,EAAOiD,EAAOO,MAAMgC,mBA+DxDA,CAAgBvC,IAE3Ba,YAAc,mBAAoBF,IAClCC,EAAMhF,KA9DH,CACHc,KAAM,mBACNzB,MAAO,mBACP4B,YAAasD,IAAMC,cAAcsC,IAAiB,MAClDlJ,MAAOmJ,cACPnC,UAAW,SAAUzD,GAEjB,OAAO,KAyDR6D,I,iCCvaX,4d,qDCAA,4d,yECAA,uCAEe,mBAAUD,GACrB,MAAO,CACHiC,SAAU,IAAIC,IAAalC,GAC3BmC,KAAMC,O,ySCiDCC,cAnDA,CACbC,KAAM,CACJC,KAAM,EACNb,QAAS,OACTc,UAAW,IACXC,UAAW,KAEbC,SAAU,CACRH,KAAM,EACNI,QAAS,OACTC,OAAQ,OACRC,gBAAiB,UACjBC,OAAQ,iCACRrB,QAAS,aACTsB,WAAY,sCACZC,SAAU,KAoCCX,EA1BoC,SACjDY,GACI,IACIC,EAA+CD,EAA/CC,QAAS1J,EAAsCyJ,EAAtCzJ,MAAO2J,EAA+BF,EAA/BE,SADrB,EACoDF,EAArBG,gBAD/B,SAGGC,EAAe7D,IAAM8D,aACzB,SAACC,GACKJ,GACFA,EAASI,EAAMhG,OAAO/D,SAG1B,CAAC2J,IAGH,OACE,yBAAKK,UAAWN,EAAQZ,MACtB,8BACEc,SAAUA,EACVI,UAAWN,EAAQR,SACnBlJ,MAAOA,EACP2J,SAAUE,Q,QCzCZI,G,OAActI,EAAQ,GAAqBsI,aAE3CC,EAAavI,EAAQ,IAAoBuI,WAEzCC,EAAexI,EAAQ,KAA6BwI,a,EAEjBxI,EAAQ,IAAzCyI,E,EAAAA,aAAcC,E,EAAAA,eAEhBC,EAAS3I,EAAQ,IAAsB2I,OAErCC,EAAiB5I,EAAQ,IAAzB4I,aA0BR,SAASC,EAAQ3E,GACf,MAAO,CACL4E,IAAKF,EAAa1E,EAAOO,MAAMsE,Y,ICPvBR,EDWNS,E,kDACJ,WAAYlB,GAA0B,IAAD,sBACnC,cAAMA,GACN,IAAMmB,EAAM5E,IAAM6E,YAFiB,OAGnC,EAAKjI,MAAQ,CAAEgI,MAAKE,SAAUrB,EAAMqB,UAHD,E,gEAMJ,IAAD,EACNxL,KAAKmK,MAArB5D,EADsB,EACtBA,OAAQkF,EADc,EACdA,IAGVC,EADyC,MAAtBnF,EAAOO,MAAM6E,MAElC,CAACZ,IAAkBD,KACnB,GAEJ,OAAOH,EAAYzF,OAAO,CACxBqB,SACAkF,MACAG,QAAQ,GAAD,OACFF,EADE,CAELV,EAAOE,EAAQ3E,KAFV,YAGFsE,EAAa,CAAEtE,SAAQsF,SAAS,U,uCAKjB7F,GAAmB,IAAD,SACJhG,KAAKmK,MAAjC2B,EADgC,EAChCA,cAAezB,EADiB,EACjBA,SAEjB0B,EAAc/L,KAAKgM,oBAEnBC,EAAOjM,KAEPgH,EAAO,IAAI4D,EAAW5E,EAAf,2BACRhG,KAAKmK,MAAM+B,mBADH,IAEX5I,MAAOyI,EACPI,oBAAqB,SAACC,GAAsB,IAAD,EACTpF,EAAK1D,MAAM+I,iBACzCD,GADM9I,EADiC,EACjCA,MAAOgJ,EAD0B,EAC1BA,aA0Bf,OAtBAtF,EAAKuF,YAAYjJ,GAEbwI,GACFA,EAAcxI,EAAO0D,GAEvBA,EAAKwF,kBAAoB,WAAO,IAEpB,IADFtG,EAASc,EAAKyF,SAASnJ,EAAMY,UAAUwI,QAAvCxG,KACJA,IACF,QAAC,GAAD,EAACA,GAAayG,sBAAd,iBAA+B,KAI/BL,EAAaM,MAAK,SAAC3I,GAAD,OAAaA,EAAG4I,eAChCxC,IACFA,EAAS/G,EAAMmI,KACX,EAAKnI,MAAMkI,UACbxE,EAAKwF,qBAKX,EAAKM,cACExJ,GAETyJ,SAhCW,WAiCT,OAAQd,EAAK3I,MAAMkI,aAkBvB,OAdIM,GACFA,EAAc9E,EAAK1D,MAAO0D,GAI5BA,EAAKtD,SAAW,SAAoBO,GAClC,IAAMkI,EAAsBnM,KAAKgN,OAAOb,oBACxC,OAAIA,EACKA,EAAoBrM,KAAKE,KAAMiE,GAE/BjE,KAAKuM,YAAYvM,KAAKsD,MAAMvD,MAAMkE,KAE3CgJ,KAAKjG,GAEAA,I,0CAIP,GAAIhH,KAAKsD,MAAMgI,MAAQtL,KAAKsD,MAAM4J,WAAY,CAC5C,IAAMA,EAAalN,KAAKmN,iBAAiBnN,KAAKsD,MAAMgI,IAAI8B,SACxDpN,KAAKqN,SAAS,CAAEH,kB,yCAKlBI,EACAC,EACAC,GAEIxN,KAAKmK,MAAMqB,WAAa8B,EAAU9B,UACpCxL,KAAKqN,SAAL,2BAAmBrN,KAAKsD,OAAxB,IAA+BkI,SAAUxL,KAAKmK,MAAMqB,c,+BAInB,IAC3BpB,EAAYpK,KAAKmK,MAAjBC,QACR,OAAO,yBAAKM,UAAWN,EAAQZ,KAAM8B,IAAKtL,KAAKsD,MAAMgI,U,GA1G/B5E,IAAM+G,WA8GjBlE,cA5IA,CACbC,KAAM,CACJkE,MAAO,OACPhE,UAAW,IACXC,UAAW,IACXgE,UAAW,WAuIApE,CAAmB8B,G,yBCzHtBT,K,YAAAA,E,aAAAA,M,KAKZ,IAqDerB,cA5FA,CACbC,KAAM,CACJZ,QAAS,OACTgF,aAAc,GAEhBC,OAAQ,CACNhE,QAAS,OACTiE,WAAY,oDACZC,OAAQ,GACRC,OAAQ,UACRC,WAAY,cACZjE,OAAQ,sBACRkE,UAAW,wBACXC,aAAc,wBACdjE,SAAU,GACVvB,QAAS,SACTyF,MAAO,OACPC,WAAY,IACZpE,WAAY,+BAEdqE,SAAU,CACRF,MAAO,UACPG,kBAAmB,YAsERhF,EArDM,SAACY,GAA8B,IAEhDC,EAKED,EALFC,QACAC,EAIEF,EAJFE,SACAlB,EAGEgB,EAHFhB,SACAqF,EAEErE,EAFFqE,gBACAC,EACEtE,EADFsE,gBAN+C,EAST/H,IAAMgI,SAC3CD,EAAoC7D,EAAW+D,KAA7B/D,EAAWgE,MAViB,mBAS1CC,EAT0C,KAS5BC,EAT4B,KAa3CvE,EAAe7D,IAAM8D,aACzB,SAACxD,GACC8H,EAAgB9H,GACZqD,GACFA,EAASrD,KAIb,CAAC8H,IAGGC,EAAerI,IAAM8D,aACzB,SAAChJ,EAAewF,GACd,OACE,4BACEgI,QAAS,kBAAMzE,EAAavD,IAC5B0D,UAAWuE,YAAK7E,EAAQyD,OAAT,eACZzD,EAAQkE,SAAWO,IAAiB7H,IAEvC7D,KAAK,SACL+L,KAAK,OAEJ1N,KAKP,CAACqN,EAActE,IAGjB,OACE,yBAAKG,UAAWN,EAAQZ,OACrBiF,GAA0BM,EAAa,SAAUnE,EAAWgE,OAC5DJ,GAEGO,EAAa5F,GAAY,OAAQyB,EAAW+D,U,oDC/EvCQ,EAHmBzI,IAAM0I,cAEtC,I,SCqEa7F,cAnEA,CACbC,KAAM,CACJ3C,OAAQ,OAEVwI,QAAS,CACPnF,SAAU,GACVH,gBAAiB,UACjBuF,SAAU,KAEZC,MAAO,CACLnB,MAAO,YAyDI7E,EArDgE,SAC7EY,GACI,IACIqF,EAAsBrF,EAAtBqF,SAAUpF,EAAYD,EAAZC,QADf,EAGiC1D,IAAM+I,WACxCN,GADMO,EAHL,EAGKA,aAAcC,EAHnB,EAGmBA,UAIhBC,EAAYF,EAAeA,EAAaF,GAAY,KACpDK,EAAcnJ,IAAM8D,aACxB,SAAAC,GACE,IAAMqF,EAAQC,SAASC,cACnBL,GACFA,EAAUH,GAKC,MAATM,GACFG,YAAW,kBAAOH,EAAsBA,UAAS,KAGrD,CAACN,EAAUG,IAGb,OAAKC,GAAcA,EAAUM,QAK3B,kBAACC,EAAA,EAAD,CACE5L,MAAOqL,EAAUpO,MACjB+N,OAAK,EACLnF,QAAS,CACPmF,MAAON,YAAK7E,EAAQmF,OACpBF,QAASJ,YAAK7E,EAAQiF,WAGxB,kBAACe,EAAA,EAAD,CACE1F,UAAWuE,YAAK7E,EAAQZ,MACxB6G,YAAaR,EACbS,KAAK,QACLC,UAAWX,EAAUY,SAAWrG,EAAMqB,SACtC4C,MAAOwB,EAAUa,OAAS,UAAY,UACtClM,MAAOqL,EAAUpO,OAEhBoO,EAAUxM,YAAcwM,EAAUxM,YAAcwM,EAAUpO,QApBxD,Q,kBC+DI+H,cA/GA,CACb7I,MAAO,CACLwJ,SAAU,GACVwG,YAAa,EACbC,aAAc,EACdtC,WAAY,UA0GD9E,EA/F8D,SAC3EY,GACI,IACIyG,EAA8BzG,EAA9ByG,UAAWxG,EAAmBD,EAAnBC,QAAS5I,EAAU2I,EAAV3I,MADzB,EAGiCkF,IAAM+I,WACxCN,GADMO,EAHL,EAGKA,aAAcC,EAHnB,EAGmBA,UAIhBkB,EAAaD,EAChBE,KAAI,SAACtB,GAEJ,OADkBE,EAAeA,EAAaF,GAAY,QAG3DpL,QAAO,SAAC6B,GAAD,OAAY,MAALA,KAEX8K,EAAwCF,EAAWzM,QACvD,SAAC6B,GAAD,OAAOA,EAAEwK,UAGLnC,EACJyC,GAAiBA,EAAcrR,OAAS,EACpCqR,EAAcC,MAAK,SAAC/K,GAAD,MAAO,gBAAgBgL,KAAKhL,EAAEhD,UACjD8N,EAAc,GACdA,EAAcC,MAAK,SAAC/K,GAAD,OAAOA,EAAEwK,UAE5B/P,EAAQ4N,EAAWA,EAASrL,KAAO,GAEnCsH,EAAe7D,IAAM8D,aACzB,SAACC,GACKkF,GACFA,EAAUlF,EAAMhG,OAAO/D,SAG3B,CAACiP,IAIGuB,EAAcxK,IAAM8D,aACxB,SAACgF,GACC,IAAKA,EACH,OAAOhO,GAAS,GAGlB,IAAIoO,EAEYF,EAAeA,EAAaF,QAAY3K,EAMxD,OAJK+K,IACHA,EAAY,CAAEpO,MAAOgO,IAGnBI,EAAUnJ,aACLC,IAAMyK,aAAavB,EAAUnJ,aAAc,CAChDiE,UAAWN,EAAQ1J,QAGhBkP,EAAUpO,QAGnB,CAACkO,IAGH,OAA0B,IAAtBmB,EAAWnR,OACN,KAIP,kBAAC0R,EAAA,EAAD,CACE1Q,MAAOA,EACP2J,SAAUE,EACV2G,YAAaA,EACbG,cAAc,EACdhB,YAAa,SAACxP,GAAD,OAAOA,EAAEyQ,kBACtBf,SAAUpG,EAAMqB,UAEfqF,EAAWC,KAAI,SAAClB,GACf,OACE,kBAAC2B,EAAA,EAAD,CACE7Q,MAAOkP,EAAU3M,KACjBuO,IAAK5B,EAAU3M,KACfoN,YAAa,SAACxP,GAAD,OAAOA,EAAEyQ,mBAErB1B,EAAUnJ,aACTmJ,EAAUnJ,aAEV,8BAAOmJ,EAAUpO,eC9DhB+H,cAzCA,CACbC,KAAM,CACJZ,QAAS,OACT6I,WAAY,SACZ,aAAc,CACZC,cAAe,MACf9I,QAAS,cACTmF,OAAQ,GACR4D,WAAY,GACZC,YAAa,+BACb/K,OAAQ,WAEV,0BAA2B,CACzB+B,QAAS,SAGbb,MAAO,CACLa,QAAS,SAwBEW,EAjB0D,SACvEY,GACI,IACI0H,EAAsB1H,EAAtB0H,SAAUzH,EAAYD,EAAZC,QAElB,OACE,yBACEM,UAAWuE,YAAK7E,EAAQZ,KAAT,eACZY,EAAQrC,OAAS8J,KAGnBA,EACD,yBAAKnH,UAAU,gBCtCfoH,EAAUpL,IAAM0I,cAA0C,CAC9D/J,OAAQ,GACRmG,UAAU,EACVuG,2BAAuBlN,EACvBH,QAAS,GACTsN,QAAS,GACTC,UAAW,GACX9I,SAAU,GACV+I,IAAK,GACLC,IAAK,GACLC,YAAa,SAACC,KACdC,oBAAqB,SAACC,OAETT,IAER,SAASU,KACd,OAAO/C,qBAAWqC,GCjBb,IAAMW,GAAe,SAACtI,GAAgB,IACnCG,EAA6BH,EAA7BG,SAAU1D,EAAmBuD,EAAnBvD,MAClB,MAAmB,mBADkBuD,EAAZuI,QAEvB,yBACEC,MAAM,6BACNjF,MAAM,KACNK,OAAO,KACP6E,KAAK,OACLC,QAAQ,aAER,uBACEC,OAAQxI,EAAW,UAAY,UAC/ByI,cAAc,QACdC,eAAe,QACfC,YAAY,MACZC,SAAS,0BAET,0BAAMC,EAAE,4aAEV,8BACE,8BAAUC,GAAG,oBACX,0BAAMR,KAAK,OAAOO,EAAE,qBAK1B,yBACER,MAAM,6BACNjF,MAAM,KACNK,OAAO,KACPnH,MAAK,aAAI6C,KAAM,YAAe7C,GAC9BgM,KAAMtI,EAAW,UAAY,UAC7BuI,QAAQ,yBAER,0BAAMM,EAAE,g8BClCDE,GAAS,WACpB,OACE,yBACEV,MAAM,6BACNjF,MAAM,KACNK,OAAO,IACP8E,QAAQ,WACRD,KAAK,WAEL,4BAAQU,GAAG,IAAIC,GAAG,IAAIC,EAAE,KACtB,6BACEC,cAAc,IACd1O,KAAK,IACLC,GAAG,IACH0O,MAAM,KACNC,IAAI,OACJC,OAAO,UACPC,SAAS,SACTC,WAAW,oCACXC,YAAY,aACZC,SAAS,iBAGb,4BAAQV,GAAG,KAAKC,GAAG,IAAIC,EAAE,KACvB,6BACEC,cAAc,IACd1O,KAAK,IACLC,GAAG,IACH0O,MAAM,QACNC,IAAI,OACJC,OAAO,UACPC,SAAS,SACTC,WAAW,oCACXC,YAAY,aACZC,SAAS,iBAGb,4BAAQV,GAAG,KAAKC,GAAG,IAAIC,EAAE,KACvB,6BACEC,cAAc,IACd1O,KAAK,IACLC,GAAG,IACH0O,MAAM,QACNC,IAAI,OACJC,OAAO,UACPC,SAAS,SACTC,WAAW,oCACXC,YAAY,aACZC,SAAS,mBC7BbC,GAASC,YAAa,CAC1B1K,KAAM,CACJE,UAAW,GACXyE,aAAc,+BACdgG,SAAU,QAEZC,MAAO,CACLxL,QAAS,QAEXiF,OAAQ,CACNO,MAAO,OACPL,OAAQ,GACRsG,UAAW,SACXC,cAAe,OACfpK,SAAU,GACVqK,UAAW,UAEbC,QAAS,CACP5C,YAAa,+BACb7D,OAAQ,GACRlH,OAAQ,WAEVwI,QAAS,CACPnF,SAAU,GACVH,gBAAiB,UACjBuF,SAAU,KAEZC,MAAO,CACLnB,MAAO,aAILqG,GACA,CACFlQ,MAAO,oCAFLkQ,GAIW,CACblQ,MAAO,0DAqOIgF,eAAW0K,GAAX1K,EAxMgD,SAC7DY,GACI,IAAD,QACKC,EAA0CD,EAA1CC,QAASsK,EAAiCvK,EAAjCuK,OAAQC,EAAyBxK,EAAzBwK,aAActP,EAAW8E,EAAX9E,OACjC1B,EAAwB6O,KACxBoC,EAASF,EAAOG,MAAM,EAAG,GACzBC,EAASJ,EAAOG,MAAM,GACtBE,GAC+D,KAAnE,iBAAC1P,QAAD,IAACA,OAAD,EAACA,EAAQ8B,aAAT,mBAAkD6N,UAAlD,eAAsDzE,UAClD0E,GAAkH,KAAzF,iBAAC5P,QAAD,IAACA,OAAD,EAACA,EAAQ8B,aAAT,mBAA6D+N,qBAA7D,eAA4E3E,UAErG4E,EAAuB,SAAvBA,EAAwBC,EAAaC,GACzC,OAAQA,EAAQlS,MACd,IAAK,SACH,OACE,kBAAC,EAAD,CACEqM,SAAU6F,EAAQ7F,SAClBhE,SAAUrB,EAAMqB,SAChBgG,IAAK4D,IAGX,IAAK,WACH,OACE,kBAAC,EAAD,CACExE,UAAWyE,EAAQzE,UACnBpP,MAAO6T,EAAQ7T,MACfgK,SAAUrB,EAAMqB,SAChBgG,IAAK4D,IAGX,IAAK,QAaH,OADS,IAFPC,EAAQxD,SAASyD,WACf,SAACC,GAAD,MAA0B,WAAfA,EAAMpS,MAVD,SAACqS,GACnB,IAAMlS,EACY,MAAhBqR,EACI,KACAA,EAAa9D,WAAW2E,EAAKhG,UACnC,OAAgB,MAATlM,GAAuBA,EAAM4M,QAKIuF,CAAYF,MAGpD,kBAAC,EAAD,CAAyB/D,IAAK4D,GAC3BC,EAAQxD,SAASf,KAAI,SAACyE,EAAOH,GAAR,OACpBD,EAAqBC,EAAKG,OAG5B,KACN,QACE,OAAO,OAIPG,EAAoB,uCAAG,gCAAAC,EAAA,+EAKfhS,EAAsBe,QAAQkR,YAAY,CAClDlD,QAAS,aANc,uBAGvBmD,EAHuB,EAGvBA,OACAC,EAJuB,EAIvBA,SAJuB,SAQnBnS,EAAsBqO,QAAQ+D,gBAAgBF,EAAQC,GARnC,mHAAH,qDAYpBE,EAAmB,uCAAG,sBAAAL,EAAA,sEACpBhS,EAAsBqO,QAAQiE,6BADV,2CAAH,qDAIzB,OACE,kBAAC,EAA0BC,SAA3B,CACExV,MAAO,CACLiP,UAAW,SAACH,GACV,GAAKmF,EAAL,CAIA,IAAMa,EAAOb,EAAaxN,MAAM6J,MAAK,SAAC/K,GAAD,OAAOA,EAAEhD,OAASuM,KACjD2G,EAAkBhX,OAAOiX,KAAKzB,EAAa9D,YAAYzM,QAC3D,SAAC6B,GAAD,MACE,gBAAgBgL,KAAKhL,IAAM0O,EAAa9D,WAAW5K,GAAGwK,UAE1D,GAAK+E,EAAL,CAIA,GAAIW,GAAmBA,EAAgBzW,OAAQ,CAC7C,IAAM2W,EAAkB1B,EAAaxN,MAAM6J,MACzC,SAAC/K,GAAD,MAAkB,qBAAXA,EAAEhD,QAGPoT,GACFA,EAAgBtW,MACd4D,EAAsBoO,sBAAsBzO,MAC5CK,EAAsBoO,sBAAsBrO,SAC5CC,GAKN6R,EAAKzV,MACH4D,EAAsBoO,sBAAsBzO,MAC5CK,EAAsBoO,sBAAsBrO,SAC5CC,MAGJ+L,aAAc,SAACF,GACb,GAAKmF,EAIL,OAAOA,EAAa9D,WAAWrB,MAInC,kBAAC,IAAD,CAAiB9E,UAAWN,EAAQZ,KAAM8M,gBAAgB,GACxD,yBAAK5L,UAAWN,EAAQgK,OACrBa,EACC,oCACA,kBAAC9E,EAAA,EAAD,CACE5L,MAAOkQ,GAAuBlQ,MAC9BgL,OAAK,EACLnF,QAAS,CACPmF,MAAOpF,EAAMC,QAAQmF,MACrBF,QAASlF,EAAMC,QAAQiF,UAGzB,kBAACkH,EAAA,EAAD,CACEhG,SAAU5M,EAAsB6H,SAChCwD,QAASgH,EACTtL,UAAWN,EAAQyD,OACnByC,KAAK,QACLkG,WACG7S,EAAsB6H,UACrB,kBAAC,GAAD,CACE5E,MAAO,CAAE8G,MAAO,GAAIK,OAAQ,IAC5B2E,QAAQ,oBAKb/O,EAAsB6H,SACrB,kBAAC,GAAD,MAEA,mBAIN,yBAAKd,UAAWN,EAAQoK,WAGxB,GAEDO,EACC,oCACE,kBAAC5E,EAAA,EAAD,CACE5L,MAAOkQ,GAAYlQ,MACnBgL,OAAK,EACLnF,QAAS,CACPmF,MAAOpF,EAAMC,QAAQmF,MACrBF,QAASlF,EAAMC,QAAQiF,UAGzB,kBAACkH,EAAA,EAAD,CACEhG,SAAU5M,EAAsB6H,SAChCwD,QAAS0G,EACThL,UAAWN,EAAQyD,OACnByC,KAAK,QACLkG,WACG7S,EAAsB6H,UACrB,kBAAC,GAAD,CACE5E,MAAO,CAAE8G,MAAO,GAAIK,OAAQ,OAKjCpK,EAAsB6H,SACrB,kBAAC,GAAD,MAEA,iBAIN,yBAAKd,UAAWN,EAAQoK,WAG1B,GAEDI,EAAO9D,KAAI,SAACpQ,EAAO0U,GAAR,OAAgBD,EAAqBC,EAAK1U,OAExD,yBAAKgK,UAAWN,EAAQgK,OACrBU,EAAOhE,KAAI,SAACpQ,EAAO0U,GAAR,OAAgBD,EAAqBC,EAAK1U,YCtRjD,IACb,CACEyC,KAAM,QACN0O,SAAU,CACR,CAAE1O,KAAM,SAAUqM,SAAU,QAC5B,CAAErM,KAAM,SAAUqM,SAAU,UAIhC,CACErM,KAAM,WACN3B,MAAO,SACPoP,UAAW,CACT,YACA,YACA,YACA,YACA,YACA,YACA,YACA,eAIJ,CACEzN,KAAM,QACN0O,SAAU,CACR,CAAE1O,KAAM,SAAUqM,SAAU,UAC5B,CAAErM,KAAM,SAAUqM,SAAU,MAC5B,CAAErM,KAAM,SAAUqM,SAAU,eAC5B,CAAErM,KAAM,SAAUqM,SAAU,QAC5B,CAAErM,KAAM,SAAUqM,SAAU,YAIhC,CACErM,KAAM,QACN0O,SAAU,CACR,CAAE1O,KAAM,SAAUqM,SAAU,cAC5B,CAAErM,KAAM,SAAUqM,SAAU,gBAC5B,CAAErM,KAAM,SAAUqM,SAAU,eAC5B,CAAErM,KAAM,SAAUqM,SAAU,mBAIhC,CACErM,KAAM,QACN0O,SAAU,CACR,CAAE1O,KAAM,SAAUqM,SAAU,QAC5B,CAAErM,KAAM,SAAUqM,SAAU,eAC5B,CAAErM,KAAM,SAAUqM,SAAU,kBAIhC,CACErM,KAAM,QACN0O,SAAU,CACR,CAAE1O,KAAM,SAAUqM,SAAU,iBAC5B,CAAErM,KAAM,SAAUqM,SAAU,SAC5B,CAAErM,KAAM,SAAUqM,SAAU,mBAC5B,CAAErM,KAAM,SAAUqM,SAAU,cAC5B,CAAErM,KAAM,SAAUqM,SAAU,cAC5B,CAAErM,KAAM,SAAUqM,SAAU,mBAC5B,CAAErM,KAAM,SAAUqM,SAAU,kBAIhC,CACErM,KAAM,QACN0O,SAAU,CACR,CAAE1O,KAAM,SAAUqM,SAAU,iBAC5B,CAAErM,KAAM,SAAUqM,SAAU,oBAC5B,CAAErM,KAAM,SAAUqM,SAAU,iBAC5B,CAAErM,KAAM,SAAUqM,SAAU,oBAC5B,CAAErM,KAAM,SAAUqM,SAAU,gBAC5B,CAAErM,KAAM,SAAUqM,SAAU,sBAIhC,CAAErM,KAAM,SAAUqM,SAAU,O,uLC/ExBiH,GAAuB,CAC3B,CACEjV,MAAO,eACPqU,OAAQ,gBAEV,CACErU,MAAO,UACPqU,OAAQ,gBAEV,CACErU,MAAO,cACPqU,OAAQ,gBASCa,GAAb,WAGE,WAAYrR,GAAc,yBAFlBA,YAEiB,EACvBrF,KAAKqF,OAASA,EAJlB,qDAOuC,IAAD,MAClC,iBAAOrF,KAAKqF,cAAZ,iBAAO,EAAa8B,aAApB,iBAAO,EAAoB6N,UAA3B,aAAO,EAAwBxD,MARnC,iCAW6B,IAAD,MACxB,OAAO,UAAAxR,KAAKqF,cAAL,mBAAa8B,aAAb,mBAAoB6N,UAApB,eAAwB2B,QAlCE,kBAsBrC,uCAe2C,IAAD,MACtC,OAAO,UAAA3W,KAAKqF,cAAL,mBAAa8B,aAAb,mBAAoB6N,UAApB,eAAwB4B,cAAeH,OAhBlD,KCtBA,SAASI,KAA2Q,OAA9PA,GAAW1X,OAAOC,QAAU,SAAUqF,GAAU,IAAK,IAAIlF,EAAI,EAAGA,EAAIE,UAAUC,OAAQH,IAAK,CAAE,IAAIuX,EAASrX,UAAUF,GAAI,IAAK,IAAIiS,KAAOsF,EAAc3X,OAAOS,UAAUC,eAAeC,KAAKgX,EAAQtF,KAAQ/M,EAAO+M,GAAOsF,EAAOtF,IAAY,OAAO/M,IAA2B1E,MAAMC,KAAMP,WAEhT,SAASsX,GAAyBD,EAAQE,GAAY,GAAc,MAAVF,EAAgB,MAAO,GAAI,IAAkEtF,EAAKjS,EAAnEkF,EAEzF,SAAuCqS,EAAQE,GAAY,GAAc,MAAVF,EAAgB,MAAO,GAAI,IAA2DtF,EAAKjS,EAA5DkF,EAAS,GAAQwS,EAAa9X,OAAOiX,KAAKU,GAAqB,IAAKvX,EAAI,EAAGA,EAAI0X,EAAWvX,OAAQH,IAAOiS,EAAMyF,EAAW1X,GAAQyX,EAASE,QAAQ1F,IAAQ,IAAa/M,EAAO+M,GAAOsF,EAAOtF,IAAQ,OAAO/M,EAFxM0S,CAA8BL,EAAQE,GAAuB,GAAI7X,OAAOiY,sBAAuB,CAAE,IAAIC,EAAmBlY,OAAOiY,sBAAsBN,GAAS,IAAKvX,EAAI,EAAGA,EAAI8X,EAAiB3X,OAAQH,IAAOiS,EAAM6F,EAAiB9X,GAAQyX,EAASE,QAAQ1F,IAAQ,GAAkBrS,OAAOS,UAAU0X,qBAAqBxX,KAAKgX,EAAQtF,KAAgB/M,EAAO+M,GAAOsF,EAAOtF,IAAU,OAAO/M,EAMne,IAAI,GAAqB,IAAMkC,cAAc,OAAQ,CACnDwM,EAAG,8iDACHP,KAAM,UAGJ,GAAqB,IAAMjM,cAAc,IAAK,CAChD4Q,KAAM,yBACQ,IAAM5Q,cAAc,OAAQ,CAC1CwM,EAAG,sBACHP,KAAM,aAGJ,GAAc,SAAqB4E,GACrC,IAAIC,EAASD,EAAKC,OACdlT,EAAQiT,EAAKjT,MACb4F,EAAQ4M,GAAyBS,EAAM,CAAC,SAAU,UAEtD,OAAoB,IAAM7Q,cAAc,MAAOkQ,GAAS,CACtDnJ,MAAO,GACPK,OAAQ,GACR8E,QAAS,YACTD,KAAM,OACNtH,IAAKmM,GACJtN,GAAQ5F,EAAqB,IAAMoC,cAAc,QAAS,KAAMpC,GAAS,KAAmB,IAAMoC,cAAc,OAAQ,CACzHyM,GAAI,kBACJxM,MAAO,CACL8Q,SAAU,SAEZC,UAAW,iBACX1R,EAAG,EACH5E,EAAG,EACHqM,MAAO,GACPK,OAAQ,IACP,IAAQ,KAGT6J,GAA0B,IAAMC,YAAW,SAAU1N,EAAOmB,GAC9D,OAAoB,IAAM3E,cAAc,GAAakQ,GAAS,CAC5DY,OAAQnM,GACPnB,OCjBC8J,IDmBS,ICnBAC,YAAa,CAC1B1K,KAAM,CACJsO,SAAU,KAEZC,iBAAkB,CAChBzI,SAAU,OAEZ0I,iBAAkB,CAChBtK,MAAO,IACPuK,SAAU,WACVC,MAAO,EACPC,KAAM,IAERC,iBAAkB,CAChBrO,gBAAiB,wBACjBsO,aAAc,GACd1P,QAAS,YAEX2P,aAAc,CACZlK,MAAO,SAETP,OAAQ,CACN0K,WAAY,OACZjE,cAAe,OACf,UAAW,CACTvK,gBAAiB,UACjBqE,MAAO,SAGXoK,kBAAmB,CACjB5K,aAAc,QAEhB6K,KAAM,CACJrK,MAAO,OACPlE,SAAU,GACV6D,OAAQ,QAEV2K,iBAAkB,CAChBtK,MAAO,QAETuK,SAAU,CACR5K,OAAQ,OACRL,MAAO,OACPkL,UAAW,kBACXL,WAAY,OAEdlJ,QAAS,CACPnF,SAAU,GACVH,gBAAiB,WAEnBwF,MAAO,CACLnB,MAAO,cAaX,SAASyK,GAAY1O,GACnB,OACE,kBAACiG,EAAA,EAAD,eACE0I,aAAW,SACP3O,EAFN,CAGEvD,MAAO,CAAE2R,WAAY,QACrBQ,oBAAoB,EACpBC,eAAe,IAEf,kBAACC,GAAA,EAAD,CAAOrS,MAAO,CAAE8G,MAAO,GAAIK,OAAQ,OAKzC,SAASmL,GAAa/O,GAAa,IACzBgP,EAAmBhP,EAAnBgP,QAAS5U,EAAU4F,EAAV5F,MACjB,OACE,kBAAC6U,GAAA,EAAD,CAAaxS,MAAO,CAAEyS,cAAe,IACnC,yBAAKzS,MAAO,CAAEgC,QAAS,OAAQ6I,WAAY,SAAU6H,IAAK,SACxD,kBAAC,GAAD,MACA,0BAAM1S,MAAO,CAAEsD,SAAU,OAAQmE,WAAY,IAAKD,MAAO,SACtD7J,GAEH,kBAACsU,GAAD,CAAa7J,QAASmK,M,8CAM9B,WAA2BjH,GAA3B,iBAAAyD,EAAA,6DAKQtQ,EALR,2BAMO6M,EAAI7M,OAAOkU,cACXrH,EAAI7M,OAAOmU,UAPlB,SASqBtH,EAAIuH,KAAKC,WAAWC,OAAM,iBAAO,MATtD,cASQF,EATR,kCAYWG,KAAQC,IAAIJ,EAAMpU,EAAOyU,gBAZpC,yDAcW,IAdX,0D,sBAkBA,SAASC,GAAY5P,GACnB,IAGM6P,EAAa7P,EAAM8P,YACrB,GACA,CACElQ,gBAAiB,UACjBqE,MAAO,WAGb,OACE,kBAAC8L,GAAA,EAAD,CACEC,WAAS,EACTzP,UAAWP,EAAMC,QAAQoO,kBACzB4B,QAAS,EACT3I,WAAW,UAEX,kBAACyI,GAAA,EAAD,CAAMG,MAAI,GACR,kBAACC,GAAA,EAAD,CAAY5H,QAAQ,WAApB,2BACA,kBAACvC,EAAA,EAAD,CACE5L,MAnBN,8GAoBMgL,OAAK,EACLnF,QAAS,CACPmF,MAAOpF,EAAMC,QAAQmF,MACrBF,QAASlF,EAAMC,QAAQiF,UAGzB,kBAACkL,GAAA,EAAD,CAAS1H,QAAQ,YAAYnI,UAAWP,EAAMC,QAAQuO,UACpD,kBAAC,GAAD,SAKN,kBAACuB,GAAA,EAAD,CAAMG,MAAI,GACR,kBAAClK,EAAA,EAAD,CACE5L,MAAO4F,EAAM2L,SAAS0E,KAAK,MAC3BjL,OAAK,EACLnF,QAAS,CACPmF,MAAOpF,EAAMC,QAAQmF,MACrBF,QAASlF,EAAMC,QAAQiF,UAGzB,kBAACoL,GAAA,EAAD,CACEvX,KACEiH,EAAM8P,YACJ,kBAACS,GAAA,EAAD,CACExQ,SAAS,QACTQ,UAAWP,EAAMC,QAAQsO,wBAG3B7T,EAGJrD,MAAM,eACN4M,MAAM,UACN1D,UAAWP,EAAMC,QAAQqO,KACzB7R,MAAOoT,EACPhL,QAAS,kBAAM7E,EAAMwQ,2BAQjC,IAAMC,GAAwC,SAACzQ,GAAgC,IACrE+H,EAAQxL,IAAM+I,WAAWoL,KAAzB3I,IADoE,EAEf/H,EAArDuI,eAFoE,MAE1D,WAF0D,EAE9CoI,EAA+B3Q,EAA/B2Q,SAAU1Q,EAAqBD,EAArBC,QAAS+O,EAAYhP,EAAZgP,QAF2B,EAGhDzK,mBAAS,IAHuC,mBAGrEmH,EAHqE,KAG7DkF,EAH6D,OAI5CrM,mBAAmB,IAJyB,mBAIrEoH,EAJqE,KAI3DkF,EAJ2D,OAKtCtM,oBAAkB,GALoB,mBAKrEuL,EALqE,KAKxDgB,EALwD,KAO5EC,qBAAU,Y,6CACRC,CAAYjJ,GAAYjR,MAAK,SAAC6U,GACxBA,GACFkF,EACElF,EAASsF,MAAM,KAAKtK,KAAI,SAACuK,GAAD,OAAqBA,EAAQC,gBAI1D,IAEH,IAAMC,EAAU,CACdC,SAAU,CACRjX,MAAO,mCACPkX,YACE,gEACF5N,OAAQ,YAEV6N,QAAS,CACPnX,MAAO,kCACPkX,YACE,gEACF5N,OAAQ,YAEV6E,GAMIiJ,EAAY,uCAAG,sBAAAhG,EAAA,sDAEnBmF,EADsB,CAAEjF,SAAQC,SAAUmE,EAAcnE,EAAW,KADhD,2CAAH,qDAelB,OACE,oCACE,kBAACoD,GAAD,CACE9O,QAASA,EACT+O,QAASA,EACT5U,MAAOgX,EAAQhX,QAEjB,kBAACqX,GAAA,EAAD,KACG9F,EAASpW,OACR,kBAACqa,GAAD,CACE3P,QAASA,EACT6P,YAAaA,EACbnE,SAAUA,EACV6E,mBAjBiB,WACzBM,GAAgBhB,WAmBVpV,EAEF,kBAACgX,GAAA,EAAD,CACEnb,MAAOmV,EACP4F,YAAaF,EAAQE,YACrBpR,SAxCmB,SAACI,GAC1BsQ,EAAUtQ,EAAMhG,OAAO/D,QAwCjBob,QAhCY,SAACrR,GACD,UAAdA,EAAM+G,KAAqC,KAAlB/G,EAAMsR,SACjCJ,KA+BIK,WAAS,EACTC,QAAS,EACTC,WAAY,CACVC,aACE,kBAACC,GAAA,EAAD,CAAgBnE,SAAS,OACvB,kBAAC1B,EAAA,EAAD,CACEvH,QAAS2M,EACTjJ,QAAQ,WACRtE,MAAM,UACN1D,UAAWN,EAAQyD,OACnBwO,kBAAkB,EAClB9L,UAAWsF,EAAOnW,QAEjB6b,EAAQ1N,UAKjByO,WAAW,EACX5J,QAAQ,aAEV,kBAAC4H,GAAA,EAAD,CAAY5H,QAAQ,WAApB,0BAC0B,IACxB,kBAAC5K,GAAA,EAAD,CACEyU,UAAU,OACVjY,KAAK,gFACLG,OAAO,UAHT,gBASJ,kBAAC+X,GAAA,EAAD,QAyBSjT,eAAW0K,GAAX1K,EApBwC,SACrDY,GACI,IACIsS,EAA2BtS,EAA3BsS,KAAMtD,EAAqBhP,EAArBgP,QAAS/O,EAAYD,EAAZC,QACjBsS,EAAgB,IAAIhG,GAAgBvM,EAAM9E,QAEhD,OACE,kBAACsX,GAAA,EAAD,CACErN,SAAS,KACTgN,WAAW,EACXG,KAAMA,EACNtD,QAASA,EACTyD,kBAAgB,oBAChBlS,UAAWuE,YAAK7E,EAAQZ,OAExB,kBAAC,GAAD,iBAA2BW,EAA3B,CAAkCuS,cAAeA,SC7UjDG,GAAcC,oHAAYC,uBAoBzB,SAASC,GACdC,EACAC,EACAxc,GAEIuc,EAAIE,WACNF,EAAIE,UAAU,QAASD,EAAWxc,G,cCJhC0c,GAA2B,CAC/B,CACEna,KAAM,gBACNoa,QAAS,UACTC,UAAW,MAEb,CACEra,KAAM,oBACNoa,QAAS,UACTC,UAAW,OAEb,CACEra,KAAM,QACNoa,QAAS,QACTC,UAAW,MAEb,CACEra,KAAM,YACNoa,QAAS,QACTC,UAAW,QAKf,SAASC,GACPC,EACAC,GAEA,IAAMC,EAAeN,GAAYpM,MAAK,SAAC/K,GAAD,OAAOA,EAAEhD,OAASua,KAExD,GAAIE,GAAgBD,EAA0BC,EAAaJ,UAAW,CACpE,IAAMK,EAAiBP,GAAYpM,MACjC,SAAC/K,GAAD,OACEA,EAAEoX,UAAYK,EAAaL,SAC3BpX,EAAEqX,UAAYG,KAElB,OAAqB,OAAdE,QAAc,IAAdA,OAAA,EAAAA,EAAgB1a,OAAQua,EAE/B,OAAOA,EAIX,SAASI,GAASC,EAAcC,GAC9B,IACa,MADPC,EAAUC,KAAKC,MAAMH,GAC3B,OAAID,EACF,OAAOE,QAAP,IAAOA,GAAP,UAAOA,EAASG,eAAhB,iBAAO,EAAmB,UAA1B,iBAAO,EAAuBC,aAA9B,aAAO,EAA8BC,QAEvC,OAAOL,QAAP,IAAOA,OAAP,EAAOA,EAASK,Q,SAGHC,G,uFAAf,WACEnM,EACAC,EACAuK,EACA4B,GAJF,qBAAA3I,EAAA,yDAMQ4I,EAAS7B,EAAc8B,SACvBC,EAA0B,SAAC,GAAD,IAAGvP,EAAH,EAAGA,KAAMkP,EAAT,EAASA,QAAT,MAA6B,CAC3DlP,KAAMA,EAAKwP,cACXN,aAGEG,EAZN,yCApD6B,8CAoD7B,uBAgByBrM,EAAIyM,WAAWC,QACpC,wCACA,CACEC,SAAS,+PAUTC,KAAM,CACJC,MAAOC,KAAK,gBAAD,OAAiB7M,EAAI8M,iBAChCX,QAASA,EAAQxN,IAAI2N,MA/B7B,uBAgBUX,EAhBV,EAgBUA,KAhBV,kBAoCSA,EAAKoB,iBAAiBC,KApC/B,4C,+BAuCeC,G,2FAAf,WACElN,EACAC,EACAuK,EACAvb,EACAke,EACAC,GANF,2BAAA3J,EAAA,6DAQQ4J,EAAkB,KAClBC,EACJre,EAAKse,SACF3O,KAAI,SAAC7K,GAAD,OAAYA,EAAEmY,QAAQ1e,UAC1BggB,QAAO,SAACC,EAAoBhK,GAArB,OAAmCgK,EAAahK,IAAG,GAtG1B,EAwG/B8H,EAA0B8B,EAAkBC,EAC9CI,EAAiB,GAfvB,kBAiBgCvB,GAC1BnM,EACAC,EACAuK,EACAvb,EAAKse,UArBX,cAiBUI,EAjBV,OAuBUrO,EAAMkL,EAAc8B,SACpBsB,EAxBV,aAyBM,eAAgB,oBACZtO,EAAM,CAAEuO,cAAc,UAAD,OAAYvO,IAAU,IA1BrD,UA6BUwO,aAAiBH,EAAD,YAAC,aACrBC,UACAG,OAAQzO,EAAM,OAAS,OACnBA,EACA,CACErQ,KAAM6c,KAAKkC,UAAL,aACJvJ,MAAO4G,GACLb,EAAcyD,WACd1C,GAEF2C,WAAYb,EACZc,QAAQ,GACLlf,KAGP,IAfgB,IAgBpBmf,UAAW,SAACzf,GACV,IACE,GAAe,WAAXA,EAAEid,MAAkC,SAAZ,OAADjd,QAAC,IAADA,OAAA,EAAAA,EAAG4J,OAE5B,YADA4U,EAAUO,GAAgB,GAI5B,IAAMzB,EAAQP,GAASpM,EAAK3Q,EAAEid,WAChBjZ,IAAVsZ,GAEFkB,EADAO,GAAkBzB,GACQ,GAE5B,MAAOoC,MAELC,OA9Bc,SA8BPC,GAA0B,OAAD,6GAElCzD,GAAM0D,OADJlP,EACY,qBAKA,kBALsB,CAClCvO,KAAM,yBACN0d,SAAU,gBAJsB,QAY9BC,EAAcH,EAASX,QAAQjG,IAAI,uBAZL,IAahC+G,OAbgC,EAahCA,EAAaC,WAAW,qBAbQ,4BAclCvB,EAdkC,SAcpBmB,EAASK,OAdW,sEAkBhB,OAAhBF,GAAwBA,EAAYC,WAAW,qBAlBf,uBAoB5B,IAAIE,MAAJ,mEACwDH,IArB5B,+CAyBtCI,QAvDoB,SAuDZT,GACN,MAAMA,MArFd,mFAyFWjB,EAAQ,EAAD,KAzFlB,2D,sBA6FO,IAAM2B,GAAb,iDACUnP,aADV,uEAGkCA,GAC9B9R,KAAK8R,QAAUA,IAJnB,0CAQI3Q,EACA+C,EACA2R,GAEA,MAAM,2DAAN,OAEF1U,EAFE,gEAMF+C,EANE,8EAUF2R,KAtBF,6FA0BIA,EACAC,GA3BJ,uFA6BI,IACEoL,IAAWC,UAAU,gCAAiC,CAAEtL,WACxD,MAAO0K,IA/Bb,SAiCgDvgB,KAAK8R,SAAW,GAApDC,EAjCZ,EAiCYA,sBAAuB5I,EAjCnC,EAiCmCA,SAEvB7F,EAAUyO,EAAVzO,MAEFyB,EAAOzB,EAAMY,UAAUa,KACvBC,EAAK1B,EAAMY,UAAUc,GAErBoZ,EAAU9a,EAAMmI,IAAI2V,IAAIrc,EAAMC,GAE9Bqc,EAAgBlY,EAA8BmY,kBAClDhe,EAAMmI,KAEF8V,EAAqBpY,EAA8BmY,kBACvDlD,GA9CN,4uDAkFWpe,KAAKwhB,sBAAsB,CAChC/B,SAAU,CACR,CACEvQ,KAAM,SACNkP,QAAQ,0iDAAD,OAqBbtI,EAASpW,OAAT,wGAEmCoW,EAAS0E,KAAK,MAFjD,SAII,KAGA,CACEtL,KAAM,OACNkP,QAASpe,KAAKyhB,oBApHxB,kpDAoHmB,iBAMX,CACEvS,KAAM,YACNkP,QA5HV,yEA8HQ,CACElP,KAAM,OACNkP,QAASpe,KAAKyhB,oBACZJ,EACAE,EACA1L,QAnIZ,yLA2IIA,EACAC,GA5IJ,iEA8II,IACEoL,IAAWC,UAAU,kBAAmB,CAAEtL,WAC1C,MAAO0K,IAhJb,yBAkJWvgB,KAAKwhB,sBAAsB,CAChC/B,SAAU,CACR,CACEvQ,KAAM,SACNkP,QAAQ,soCAAD,OAqBbtI,EAASpW,OAAT,wGAEmCoW,EAAS0E,KAAK,MAFjD,SAII,KAGA,CACEtL,KAAM,OACNkP,QAASvI,OApLnB,8LA0LqCkI,GA1LrC,iIAgMQ/d,KAAK8R,QAJPC,EA5LN,EA4LMA,sBACAK,EA7LN,EA6LMA,YACA/M,EA9LN,EA8LMA,OACA8D,EA/LN,EA+LMA,SAEIuT,EAAgB,IAAIhG,GAAgBrR,GAElC3B,EAAaqO,EAAbrO,SACFJ,EAAUyO,EAAVzO,MAEN8O,GAAY,GAERsP,EAxMR,oBAwMwBpe,EAAMY,iBAxM9B,aAwMwB,EAAiBa,YAxMzC,QAwMiDzB,EAAMmI,IAAI2S,QAAQ9N,KAC3DqR,GAAc,UAAAre,EAAMY,iBAAN,eAAiBc,KAAM0c,EAEnCE,EAAWte,EAAMmI,IAAIlL,QAAQmhB,EAAeC,GAEf,eAAzB,OAARC,QAAQ,IAARA,GAAA,UAAAA,EAAU5b,cAAV,mBAAkB7C,YAAlB,eAAwBF,OACY,KAA5B,OAAR2e,QAAQ,IAARA,GAAA,UAAAA,EAAU5b,cAAV,mBAAkBoY,eAAlB,eAA2B9N,OAG3BoR,IAKF1hB,KAAK8R,QAASQ,qBAAoB,GAtNtC,oBAyNY8M,GAAqB,UACzBpf,KAAK8R,eADoB,aACzB,EAAcI,IADW,UAEzBlS,KAAK8R,eAFoB,aAEzB,EAAcK,IACduK,EACAqB,GACA,SAAC8D,EAAQC,GAAc,IAAD,EACdC,EAA4B,IAAlBF,EAAOniB,OACjBsiB,EAAWH,EAAOhB,WAhYZ,YAiYNoB,GACHH,GACDD,EAAOniB,OAnYG,WAmYoBA,QAC9BmiB,IApYU,WAoYehN,MAAM,EAAGgN,EAAOniB,QAE3C,GAAIsiB,EAAU,CACZ,IAAM5D,EAAUyD,EAAOhN,MAvYb,WAuYiCnV,QAY3C,OAXKwiB,EAQHA,EAAMC,cAAc/D,GAPpB8D,EAAQ,EAAKpQ,QAASpN,QAAQwd,MAAM,CAClC3d,MAAO,eACPrB,KAAM,kBAACkf,GAAA,EAAD,MACNC,SAAU,OACVjE,iBAKJhM,GAAY,GAId,IAAI2P,IAAWE,EAAf,CAIA,IAAIK,EAAYnZ,EAA8BoZ,cAC5CV,EAAOvG,QACP8C,QAE8B,IAA5BkE,EAASlE,QAAQ1e,SACnB4iB,EAAWA,EAASlE,QAAQ,GAAGA,SAGjC,IAAMhS,EAAc9I,EAAMW,GAAGue,YAC3Bd,EACAC,EACAW,GAEIG,EAAW/e,EAAS0I,GAC1B9I,EAAQmf,EACRd,EAAce,KAAKC,IAAL,UACZrf,EAAMY,iBADM,aACZ,EAAiBc,GACjB0c,EAAgBY,EAAShS,UAG7B,SAACiQ,GAAS,IAAD,UAUkB,GARsB,0BAA1C,OAAHA,QAAG,IAAHA,GAAA,UAAAA,EAAKzC,YAAL,mBAAW8E,cAAX,mBAAoB,UAApB,mBAAwBC,kBAAxB,eAAoClb,QAEpCqV,GAAM0D,OAAQ,2BAA4B,CACxCzd,KAAM,yBACN0d,SAAU,cAEZ,EAAK7O,QAASQ,qBAAoB,IAEpC,OAAIiO,QAAJ,IAAIA,GAAJ,UAAIA,EAAKuC,aAAT,aAAI,EAAYC,UACd,EAAKjR,QAASpN,QAAQwd,MAAM,CAC1B3d,MAAO,eACPrB,KAAM,kBAACkf,GAAA,EAAD,MACNC,SAAU,QACVjE,QAAO,OAAEmC,QAAF,IAAEA,GAAF,UAAEA,EAAKuC,aAAP,aAAE,EAAYC,aA7RnC,mEAoSI,UAAA/iB,KAAK8R,eAAL,SAAcM,aAAY,GApS9B,2UAyS0DpS,KAAK8R,QAAjDC,EAzSd,EAyScA,sBAAuB1M,EAzSrC,EAySqCA,OAAQ8D,EAzS7C,EAyS6CA,SAC/BzF,EAAaqO,EAAbrO,SACFJ,EAAUyO,EAAVzO,MAEA0f,EAAS,IAAIC,KAAuB,CACxCC,SACQ,OAAN7d,QAAM,IAANA,GAAA,UAAAA,EAAQ8B,aAAR,mBAAe+N,qBAAf,eAA8BgO,UAC9B,6CAhTV,SAmTgCF,EAAOG,aAnTvC,gBAmTc/E,EAnTd,EAmTcA,SACFgF,EAAajkB,OAAOyU,OAAOwK,GAC9Bha,QAAO,SAAC6B,GAAD,MAAoB,kBAANA,MAETvG,OAAS,IAKU,KAJ5B4iB,EAAYnZ,EAA8BoZ,cAC5Ca,EAAW,GAAG9H,QACd8C,SAEWA,QAAQ1e,SACnB4iB,EAAWA,EAASlE,QAAQ,GAAGA,SAG7BsD,EATqB,oBASLpe,EAAMY,iBATD,aASL,EAAiBa,YATZ,QASoBzB,EAAMmI,IAAI2S,QAAQ9N,KAC3DqR,GAAc,UAAAre,EAAMY,iBAAN,eAAiBc,KAAM0c,EAEnCtV,EAAc9I,EAAMW,GAAGue,YAC3Bd,EACAC,EACAW,GAGF5e,EAAS0I,IAzUjB,yK,oBCpLMiX,GAAc,qBAkBpB,IAyGeC,GAzGoC,SACjDnZ,GACI,IACIsS,EAA4BtS,EAA5BsS,KAAMtD,EAAsBhP,EAAtBgP,QAAS2B,EAAa3Q,EAAb2Q,SACjByI,EAAWpZ,EAAMzJ,MAAQyJ,EAAMzJ,MAAM6iB,SAAW,IAAIC,IAFvD,EAIuB9c,IAAMgI,SAAiB,CAC/ChO,MAAO,KALN,mBAIIA,EAJJ,KAIW+iB,EAJX,OAQ+B/c,IAAMgI,WARrC,mBAQIgV,EARJ,KAQeC,EARf,KAWc,MAAfxZ,EAAMzJ,OACe,MAArByJ,EAAMzJ,MAAMA,OACZgjB,IAAcvZ,EAAMzJ,MAAMA,QAE1B+iB,EAAStZ,EAAMzJ,MAAMA,OACrBijB,EAAaxZ,EAAMzJ,MAAMA,QAG3B,IAAMkjB,EAAW,SAACC,GAAD,OArCnB,SAAoBnjB,EAAe6iB,GACjC,OAAa,MAAT7iB,GAAkC,IAAjBA,EAAMhB,OAClB,sBAGJ2jB,GAAYpS,KAAKvQ,GAIlB6iB,EAASO,IAAIpjB,GACR,6BADT,EAHS,cA+BgCqjB,CAAWF,EAAYN,IAE1DS,EAAQJ,EAASljB,EAAMA,OArB1B,EAsBiCgG,IAAMgI,SAA6BsV,GAtBpE,mBAsBIC,EAtBJ,KAsBgBC,EAtBhB,KAuBCF,IAAUC,GACZC,EAAcF,GAGhB,IAAMG,EAAqBzd,IAAM8D,aAC/B,SAACvH,EAAcmhB,GACb,IAAMC,EAAQ,2BACT3jB,GADS,kBAEXuC,EAAOmhB,IAGVX,EAASY,GACT,IAAMvB,EAAQc,EAASS,EAAS3jB,OAChCwjB,EAAcpB,KAGhB,CAACpiB,EAAO+iB,EAAUS,IAGdI,EAAQ,WACZb,EAAS,CACP/iB,MAAO,MAIL6jB,EAAe7d,IAAM8D,aAAY,WACrC8Z,IACAnL,MAEC,CAACsK,EAAUtK,IAERwC,EAAejV,IAAM8D,aAAY,WACrC8Z,IACAxJ,EAASpa,KACR,CAACA,EAAO+iB,EAAU3I,IAErB,OACE,kBAAC6B,GAAA,EAAD,CACErN,SAAS,KACTgN,WAAW,EACXG,KAAMA,EACNtD,QAASA,EACTyD,kBAAgB,qBAEhB,kBAACxD,GAAA,EAAD,CAAahG,GAAG,qBAAhB,UACA,kBAACwI,GAAA,EAAD,KACE,kBAAC4I,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACEiH,WAAsBje,IAAfof,EACPQ,WAAW,EACXrR,GAAG,QACH5R,MAAM,YACN2B,KAAK,QACLuhB,UAAU,EACVpI,WAAW,EACX5b,MAAOA,EAAMA,MACb2J,SAAU,SAACI,GAAD,OACR0Z,EAAmB,QAAS1Z,EAAMhG,OAAO/D,QAE3CikB,WAAYV,IAEd,kBAACW,GAAA,EAAD,+BAGJ,kBAACpI,GAAA,EAAD,KACE,kBAACjG,EAAA,EAAD,CAAQvH,QAASuV,EAAcnW,MAAM,WAArC,UAGA,kBAACmI,EAAA,EAAD,CACEhG,cAAyB1L,IAAfof,EACVjV,QAAS2M,EACTvN,MAAM,WAHR,cCpHFiV,GAAc,wBAqFLwB,GAhFgC,SAAC1a,GAA4B,IAClEsS,EAA4BtS,EAA5BsS,KAAMtD,EAAsBhP,EAAtBgP,QAAS2B,EAAa3Q,EAAb2Q,SADkD,EAG/CpU,IAAMgI,SAAiB,IAHwB,mBAGlEhO,EAHkE,KAG3D+iB,EAH2D,OAKrC/c,IAAMgI,SAAiB,IALc,mBAKlEuV,EALkE,KAKtDC,EALsD,OAOvCxd,IAAMgI,WAPiC,mBAOlEgV,EAPkE,KAOvDC,EAPuD,KASrED,IAAcvZ,EAAMzJ,QACtB+iB,EAAStZ,EAAMzJ,OAAS,IACxBijB,EAAaxZ,EAAMzJ,QAGrB,IAAMyjB,EAAqBzd,IAAM8D,aAC/B,SAAClF,GACCme,EAASne,GAAO,IAEhB,IArBYue,EAqBNf,GArBMe,EAqBWve,EApB1B+d,GAAYpS,KAAK4S,GAAoD,GAAtC,qCAqB5BK,EAAcpB,KAGhB,CAACpiB,EAAO+iB,EAAUS,IAGdI,EAAQ,WACZb,EAAS,KAGLc,EAAe7d,IAAM8D,aAAY,WACrC8Z,IACAnL,MAEC,CAACsK,EAAUtK,IAERwC,EAAejV,IAAM8D,aAAY,WACrC8Z,IACAxJ,EAASpa,KAER,CAACA,EAAO+iB,EAAU3I,IAErB,OACE,kBAAC6B,GAAA,EAAD,CACErN,SAAS,KACTgN,WAAW,EACXG,KAAMA,EACNtD,QAASA,EACTyD,kBAAgB,qBAEhB,kBAACxD,GAAA,EAAD,CAAahG,GAAG,qBAAhB,cACA,kBAACwI,GAAA,EAAD,KACE,kBAAC4I,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACEiH,QAASmB,EACTU,WAAYV,EACZQ,WAAW,EACXrR,GAAG,OACH5R,MAAM,WACN2B,KAAK,QACLmZ,WAAW,EACX5b,MAAOA,EACP2J,SAAU,SAACI,GAAD,OAAW0Z,EAAmB1Z,EAAMhG,OAAO/D,OAAS,OAEhE,kBAACkkB,GAAA,EAAD,+EAKJ,kBAACpI,GAAA,EAAD,KACE,kBAACjG,EAAA,EAAD,CAAQvH,QAASuV,EAAcnW,MAAM,WAArC,UAGA,kBAACmI,EAAA,EAAD,CAAQhG,WAAY0T,EAAYjV,QAAS2M,EAAcvN,MAAM,WAA7D,c,oBCrER,IAkIe0W,GAlI0C,SACvD3a,GACI,IACIsS,EAA4BtS,EAA5BsS,KAAMtD,EAAsBhP,EAAtBgP,QAAS2B,EAAa3Q,EAAb2Q,SADpB,EAGuBpU,IAAMgI,SAAoB,CAClDpK,KAAM,GACNC,MAAO,GACPC,cAAc,IANb,mBAGI9D,EAHJ,KAGW+iB,EAHX,OAS+B/c,IAAMgI,WATrC,mBASIgV,EATJ,KASeC,EATf,KAWgB,MAAfxZ,EAAMzJ,OAAiBgjB,IAAcvZ,EAAMzJ,QAC7C+iB,EAAStZ,EAAMzJ,OACfijB,EAAaxZ,EAAMzJ,QAblB,MAgB2BgG,IAAMgI,UAAS,GAhB1C,mBAgBIqW,EAhBJ,KAgBaC,EAhBb,KAkBGb,EAAqBzd,IAAM8D,aAC/B,SAACvH,EAAcmhB,GACb,IAAMC,EAAQ,2BACT3jB,GADS,kBAEXuC,EAAOmhB,IAGVX,EAASY,GACTW,EAhCN,SAAqBtkB,GACnB,OAAgB,MAATA,GAAiBA,EAAMhB,OAAS,EA+BxBulB,CAAYZ,EAAS/f,SAElC,CAAC5D,EAAO+iB,EAAUuB,IAGdV,EAAQ,WACZb,EAAS,CACPnf,KAAM,GACNC,MAAO,GACPC,cAAc,IAEhBmf,OAAa9e,IAGT0f,EAAe7d,IAAM8D,aAAY,WACrC8Z,SACkBzf,IAAd6e,EACFvK,IAEA2B,EAAS,2BAAK4I,GAAN,IAAiB9e,QAAQ,OAGlC,CAAC8e,EAAWC,EAAc7I,IAEvBoK,EAAcxe,IAAM8D,aAAY,WACpC8Z,IACAnL,MACC,CAACA,IAEEwC,EAAejV,IAAM8D,aAAY,WACrC8Z,IACAxJ,EAASpa,KAER,CAACA,EAAO+iB,EAAU3I,IAErB,OACE,kBAAC6B,GAAA,EAAD,CACErN,SAAS,KACTgN,WAAW,EACXG,KAAMA,EACNtD,QAASoL,EACT3H,kBAAgB,qBAEhB,kBAACxD,GAAA,EAAD,CAAahG,GAAG,qBAAhB,aACA,kBAACwI,GAAA,EAAD,KACE,kBAAC4I,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACE4I,WAAW,EACXrR,GAAG,OACH5R,MAAM,cACN2B,KAAK,QACLuhB,UAAU,EACVpI,WAAW,EACX5b,MAAOA,EAAM4D,KACb+F,SAAU,SAACI,GAAD,OAAW0Z,EAAmB,OAAQ1Z,EAAMhG,OAAO/D,UAE/D,kBAACkkB,GAAA,EAAD,0DAKF,kBAACJ,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACEzI,GAAG,QACH5R,MAAM,QACN2B,KAAK,QACLmZ,WAAW,EACX5b,MAAOA,EAAM6D,MACb8F,SAAU,SAACI,GAAD,OACR0Z,EAAmB,QAAS1Z,EAAMhG,OAAO/D,UAG7C,kBAACkkB,GAAA,EAAD,oCAGF,kBAACJ,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAAC6I,GAAA,EAAD,CACEC,QACE,kBAACC,GAAA,EAAD,CACEC,UAAW5kB,EAAM8D,aACjB6F,SAAU,SAACI,GAAD,OACR0Z,EAAmB,eAAgB1Z,EAAMhG,OAAO6gB,UAElDlX,MAAM,YAGV5M,MAAM,sBAIZ,kBAACgb,GAAA,EAAD,KACE,kBAACjG,EAAA,EAAD,CAAQvH,QAASkW,EAAa9W,MAAM,WAApC,SAGA,kBAACmI,EAAA,EAAD,CAAQhG,UAAWwU,EAAS/V,QAAS2M,EAAcvN,MAAM,WAAzD,cC7HR,IA4GemX,GA5GkC,SAACpb,GAA6B,IACrEsS,EAA4BtS,EAA5BsS,KAAMtD,EAAsBhP,EAAtBgP,QAAS2B,EAAa3Q,EAAb2Q,SADqD,EAGlDpU,IAAMgI,SAAgB,CAC9C5I,IAAK,GACLC,IAAK,GACLxB,MAAO,KANmE,mBAGrE7D,EAHqE,KAG9D+iB,EAH8D,OAS9C/c,IAAMgI,UAAS,GAT+B,mBASrEqW,EATqE,KAS5DC,EAT4D,KAWtEb,EAAqBzd,IAAM8D,aAC/B,SAACvH,EAAcmhB,GACb,IAAMC,EAAQ,2BACT3jB,GADS,kBAEXuC,EAAOmhB,IAGVX,EAASY,GACTW,EAvBN,SAAqBtkB,GACnB,OAAgB,MAATA,GAAiBA,EAAMhB,OAAS,EAsBxBulB,CAAYZ,EAASve,QAElC,CAACpF,EAAO+iB,EAAUuB,IAGdV,EAAQ,WACZb,EAAS,CACP3d,IAAK,GACLC,IAAK,GACLxB,MAAO,MAILggB,EAAe7d,IAAM8D,aAAY,WACrC8Z,IACAnL,MAEC,CAACsK,EAAUtK,IAERwC,EAAejV,IAAM8D,aAAY,WACrC8Z,IACAxJ,EAASpa,KAER,CAACA,EAAO+iB,EAAU3I,IAErB,OACE,kBAAC6B,GAAA,EAAD,CACErN,SAAS,KACTgN,WAAW,EACXG,KAAMA,EACNtD,QAASA,EACTyD,kBAAgB,qBAEhB,kBAACxD,GAAA,EAAD,CAAahG,GAAG,qBAAhB,yBACA,kBAACwI,GAAA,EAAD,KACE,kBAAC4I,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACE4I,WAAW,EACXrR,GAAG,MACH5R,MAAM,gBACN2B,KAAK,QACLuhB,UAAU,EACVpI,WAAW,EACX5b,MAAOA,EAAMoF,IACbuE,SAAU,SAACI,GAAD,OAAW0Z,EAAmB,MAAO1Z,EAAMhG,OAAO/D,UAE9D,kBAACkkB,GAAA,EAAD,uDAKF,kBAACJ,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACEzI,GAAG,QACH5R,MAAM,cACN2B,KAAK,QACLmZ,WAAW,EACX5b,MAAOA,EAAM6D,MACb8F,SAAU,SAACI,GAAD,OACR0Z,EAAmB,QAAS1Z,EAAMhG,OAAO/D,UAG7C,kBAACkkB,GAAA,EAAD,oCAGF,kBAACJ,GAAA,EAAD,CAAalI,WAAW,GACtB,kBAACT,GAAA,EAAD,CACEzI,GAAG,MACH5R,MAAM,yBACN2B,KAAK,QACLmZ,WAAW,EACX5b,MAAOA,EAAMqF,IACbsE,SAAU,SAACI,GAAD,OAAW0Z,EAAmB,MAAO1Z,EAAMhG,OAAO/D,UAE9D,kBAACkkB,GAAA,EAAD,qCAGJ,kBAACpI,GAAA,EAAD,KACE,kBAACjG,EAAA,EAAD,CAAQvH,QAASuV,EAAcnW,MAAM,WAArC,UAGA,kBAACmI,EAAA,EAAD,CAAQhG,UAAWwU,EAAS/V,QAAS2M,EAAcvN,MAAM,WAAzD,aCpHO0D,GADCpL,IAAM0I,cAAsC,I,mBCyH7C7F,gBAlHA,SAACic,GAAD,MAAmB,CAChChc,KAAK,2BACAgc,EAAMC,WAAWC,OADlB,IAEF9c,QAAS,OACT+c,cAAe,MACfrW,SAAU,IACV+I,aAAcmN,EAAMI,MAAMvN,aAC1BtO,gBAAiB,cACjBpB,QAAS,aAGXkd,QAAS,CACPzX,MAAO0X,aAAON,EAAMO,QAAQF,QAAQG,KAAM,IAC1Cjc,gBAAiBkc,aAAQT,EAAMO,QAAQF,QAAQG,KAAM,IACrD,UAAW,CACT5X,MAAOoX,EAAMO,QAAQF,QAAQG,OAIjCE,KAAM,CACJ9X,MAAO0X,aAAON,EAAMO,QAAQG,KAAKF,KAAM,IACvCjc,gBAAiBkc,aAAQT,EAAMO,QAAQG,KAAKF,KAAM,IAClD,UAAW,CACT5X,MAAOoX,EAAMO,QAAQG,KAAKF,OAI9BG,QAAS,CACP/X,MAAO0X,aAAON,EAAMO,QAAQI,QAAQH,KAAM,IAC1Cjc,gBAAiBkc,aAAQT,EAAMO,QAAQI,QAAQH,KAAM,IACrD,UAAW,CACT5X,MAAOoX,EAAMO,QAAQI,QAAQH,OAIjClD,MAAO,CACL1U,MAAO0X,aAAON,EAAMO,QAAQjD,MAAMkD,KAAM,IACxCjc,gBAAiBkc,aAAQT,EAAMO,QAAQjD,MAAMkD,KAAM,IACnD,UAAW,CACT5X,MAAOoX,EAAMO,QAAQjD,MAAMkD,OAI/BzhB,MAAO,CACL8J,WAAYmX,EAAMC,WAAWW,kBAG/BC,OAAQ,CACNzd,QAAS,OACT+c,cAAe,OAGjBvH,QAAS,CACPzV,QAAS,SAGXzF,KAAM,CACJojB,YAAa,GACb3d,QAAS,QACTC,QAAS,OACTsB,SAAU,GACVqc,QAAS,IAGXC,OAAQ,CACN5d,QAAS,OACT6I,WAAY,SACZ8G,WAAY,OACZ7H,YAAa,GACb4V,aAAc,MA6CH/c,EAjCO,SAACY,GAA+B,IAC5CC,EAAsDD,EAAtDC,QAASyH,EAA6C1H,EAA7C0H,SAAUwQ,EAAmClY,EAAnCkY,SAAU9d,EAAyB4F,EAAzB5F,MAAOrB,EAAkBiH,EAAlBjH,KAAMiW,EAAYhP,EAAZgP,QAElD,OACE,yBACEzO,UAAWuE,YACT7E,EAAQZ,KACR,CACE0c,KAAM9b,EAAQ8b,KACdL,QAASzb,EAAQyb,QACjB/C,MAAO1Y,EAAQ0Y,MACfqD,QAAS/b,EAAQ+b,SACjB9D,KAGJ,yBAAK3X,UAAWN,EAAQlH,MAAOA,GAC/B,yBAAKwH,UAAWN,EAAQgU,SACtB,yBAAK1T,UAAWN,EAAQic,QACtB,kBAAC/L,GAAA,EAAD,CAAY5H,QAAQ,QAAQhI,UAAWN,EAAQ7F,OAC5CA,IAGJsN,GAEH,yBAAKnH,UAAWN,EAAQoc,QACtB,kBAACpW,EAAA,EAAD,CAAYpB,QAASmK,EAAS7I,KAAK,QAAQlC,MAAM,WAC/C,kBAAC6K,GAAA,EAAD,YCtFNwN,GAAU,EAmMCC,GAjMiD,SAC9Dvc,GACI,IACI0H,EAAqB1H,EAArB0H,SAAUxM,EAAW8E,EAAX9E,OADf,EAGiCqB,IAAMgI,WAHvC,mBAGIiY,EAHJ,KAGgBC,EAHhB,OAIkClgB,IAAMmgB,YACzC,SAACvjB,EAAgBkjB,GACf,OAAQA,EAAOrjB,MACb,IAAK,YACH,MAAM,GAAN,mBAAWG,GAAX,CAAkBkjB,EAAOtE,QAC3B,IAAK,eACH,IAAM4E,EAAaxjB,EAAMgS,WAAU,SAACrP,GAAD,OAAOA,EAAEmN,KAAOoT,EAAOpT,MAI1D,OAHoB,IAAhB0T,GACFxjB,EAAMyjB,OAAOD,EAAY,GAEpB,YAAIxjB,GACb,IAAK,uBACH,IAAM4e,EAAQ5e,EAAM0N,MAAK,SAAC/K,GAAD,OAAOA,EAAEmN,KAAOoT,EAAOpT,MAIhD,OAHI8O,IACFA,EAAM9D,QAAUoI,EAAOpI,SAElB,YAAI9a,GAEf,OAAOA,IAET,IAxBC,mBAII0jB,EAJJ,KAIYC,EAJZ,KA2BGC,EAAoBxgB,IAAM8D,aAAY,WACtCmc,GACFA,EAAWnmB,SAEbomB,OAAc/hB,KACb,CAAC8hB,EAAYC,IAEVO,EAAqBzgB,IAAM8D,aAC/B,SAAC9J,GACKimB,GACFA,EAAWpmB,QAAQG,GAErBkmB,OAAc/hB,KAEhB,CAAC8hB,EAAYC,IAGTQ,EAAmB1gB,IAAM8D,aAC7B,SAACrH,EAAczC,EAAawG,GAC1B,OAAO,IAAI5G,SAAQ,SAACC,EAASC,GAC3BomB,EAAc,CACZzjB,OACA5C,UACAC,SACAE,QACAwG,iBAIN,CAAC0f,IAGK1U,EAAQxL,IAAM+I,WAAWoL,KAAzB3I,IAEFmV,EAA2B3gB,IAAM8D,aACrC,SAAC4I,EAAIgL,GACH6I,EAAmB,CACjB9jB,KAAM,uBACNiQ,KACAgL,cAGJ,CAAC6I,IAGGK,EAAmB5gB,IAAM8D,aAC7B,SAAC4I,GACC6T,EAAmB,CACjB9jB,KAAM,eACNiQ,SAGJ,CAAC6T,IAGGviB,EAA2B,CAC/B6iB,UAAW,SAAChE,EAAuB7iB,GACjC,OAAO0mB,EAAiB,SAAU,CAAE1mB,QAAO6iB,cAE7C/d,QAAS,SAAC9E,GACR,OAAO0mB,EAAiB,OAAQ1mB,IAElCiE,aAAc,SAACjE,GACb,OAAO0mB,EAAiB,YAAa1mB,IAEvCiF,SAAU,SAACjF,GACT,OAAO0mB,EAAiB,UAE1BI,eAAgB,SAAC9mB,GACf,OAAKwR,EAGIA,EAAIuV,UAAU9hB,WAFdrF,QAAQE,UAKnBknB,iBAAkB,SAACC,EAA0BjnB,GAC3C,OAAKwR,EAGIA,EAAI0V,YAAY/N,IAAI8N,GAFpBrnB,QAAQE,UAKnBoV,YA3B+B,SA4B7BiS,GAEA,OAAOT,EAAiB,iBAAaviB,EAAWgjB,IAKlD3F,MAnC+B,SAmCzB4F,GACJ,IAAM5F,EAAU,aACd9O,GAAG,GAAD,OAAKqT,OACJqB,GASL,OAPA5F,EAAMC,cAAgB,SAAC/D,GACrBiJ,EAAyBnF,EAAM9O,GAAIgL,IAErC6I,EAAmB,CACjB9jB,KAAM,YACN+e,UAEKA,IAIX,OACE,kBAAC6F,GAAuB7R,SAAxB,CAAiCxV,MAAO,CAAEgE,YACvCmN,EAED,kBAAC,GAAD,CACEnR,MAAqB,MAAdimB,EAAqBA,EAAWjmB,WAAQmE,EAC/C4X,KAAoB,MAAdkK,GAA0C,WAApBA,EAAWxjB,KACvCgW,QAAS+N,EACTpM,SAAUqM,IAEZ,kBAAC,GAAD,CACEzmB,MAAqB,MAAdimB,EAAqBA,EAAWjmB,WAAQmE,EAC/C4X,KAAoB,MAAdkK,GAA0C,SAApBA,EAAWxjB,KACvCgW,QAAS+N,EACTpM,SAAUqM,IAEZ,kBAAC,GAAD,CACEzmB,MAAqB,MAAdimB,EAAqBA,EAAWjmB,WAAQmE,EAC/C4X,KAAoB,MAAdkK,GAA0C,cAApBA,EAAWxjB,KACvCgW,QAAS+N,EACTpM,SAAUqM,IAEZ,kBAAC,GAAD,CACE1K,KAAoB,MAAdkK,GAA0C,UAApBA,EAAWxjB,KACvCgW,QAAS+N,EACTpM,SAAUqM,IAGZ,kBAAC,GAAD,eACE1K,KAAoB,MAAdkK,GAA0C,cAApBA,EAAWxjB,KACvCgW,QAAS+N,EACTpM,SAAUqM,EACV9hB,OAAQA,IACO,OAAVshB,QAAU,IAAVA,OAAA,EAAAA,EAAYzf,UAAW,KAG7B8f,EAAOlW,KAAI,SAACoR,GAAD,OACV,kBAAC8F,GAAA,EAAD,CACExW,IAAK0Q,EAAM9O,GACX+F,QAAS,kBAAMmO,EAAiBpF,EAAM9O,KACtCqJ,MAAM,EACNwL,iBAAkB,IAClBC,aAAc,CAAEC,SAAU,SAAUC,WAAY,UAEhD,kBAAC,GAAD,CACE/F,SAAUH,EAAMG,SAChB9d,MAAO2d,EAAM3d,MACbrB,KAAMgf,EAAMhf,KACZiW,QAAS,kBAAMmO,EAAiBpF,EAAM9O,MAErC8O,EAAM9D,eCpHJ7U,gBApGA,SAACic,GAAD,MAAmB,CAChChc,KAAM,CACJ0E,UAAW,+BACX+J,SAAU,WACVhK,WAAY,QACZoa,WAAY,OACZ3a,MAAO,OACP4a,OAAQ,GAEV7P,KAAM,CACJrK,MAAO,UACPpE,OAAQ,mCACRqO,aAAc,MACdnO,SAAU,OACVvB,QAAS,QACToF,OAAQ,OACR,UAAW,CACT/D,OAAQ,iCACRD,gBAAiB,mBAEnB,UAAW,CACTA,gBAAiB,uBA+ERR,EArEgE,SAC7EY,GACI,IAAD,IACKC,EAA8BD,EAA9BC,QAASme,EAAqBpe,EAArBoe,iBADd,EAOC/V,KAJFnN,EAHC,EAGDA,OACA2M,EAJC,EAIDA,QACAtN,EALC,EAKDA,QACAqN,EANC,EAMDA,sBAGI2K,EAAgB,IAAIhG,GAAgBrR,GACpC0P,GAC+D,KAAnE,iBAAC1P,QAAD,IAACA,OAAD,EAACA,EAAQ8B,aAAT,mBAAkD6N,UAAlD,eAAsDzE,UAClDqG,EAAc8F,EAAc8L,iBAE5BC,EAAgB,uCAAG,WAAO5S,GAAP,SAAAF,EAAA,sEACjB3D,EAAQ0W,8BAA8B7S,EAAOA,OAAQ,IADpC,2CAAH,sDAIhB8S,EAAqB,uCAAG,gCAAAhT,EAAA,sEACOjR,EAAQkR,YAAY,CACrDlD,QAAS,YAFiB,uBACpBmD,EADoB,EACpBA,OAAQC,EADY,EACZA,SADY,SAItB9D,EAAQ0W,8BAA8B7S,EAAQC,GAJxB,2CAAH,qDAO3B,OAAOf,EACL,yBAAKrK,UAAWN,EAAQZ,MACtB,kBAAC0Q,GAAA,EAAD,CAAM0O,UAAU,MAAMxO,QAAS,EAAGD,WAAW,EAAMvT,MAAO,CAAE0S,IAAK,KAC9D1C,EAAY9F,KAAI,SAAC+E,GAChB,OACE,kBAACqE,GAAA,EAAD,CAAM1I,IAAKqE,EAAOrU,MAAO6Y,MAAM,GAC7B,kBAACI,GAAA,EAAD,CACE/P,UAAWN,EAAQqO,KACnBjX,MAAOqU,EAAOrU,MACdkR,QAAQ,WACR1D,QAAS,kBAAMyZ,EAAiB5S,IAChCtF,SAAUgY,EACV3hB,MAAO,CACLiiB,YAAiC,OAArB9W,QAAqB,IAArBA,OAAA,EAAAA,EAAuBzO,MAAMY,UAAU6D,OAC/C,SACA,iBAMd,kBAACmS,GAAA,EAAD,CAAMG,MAAM,GACV,kBAACI,GAAA,EAAD,CACE/P,UAAWN,EAAQqO,KACnBjX,MAAM,iBACNkR,QAAQ,WACR1D,QAAS,kBAAM2Z,KACfpY,SAAUgY,EACV3hB,MAAO,CACLiiB,YAAiC,OAArB9W,QAAqB,IAArBA,OAAA,EAAAA,EAAuBzO,MAAMY,UAAU6D,OAC/C,SACA,gBAOd,wCCpGW,SAAS+gB,GAAa3e,GAGnC,OAF6BA,EAArBoe,iBAIJ,uBACE3hB,MAAO,CACLsD,SAAU,OACVkE,MAAO,UACPnE,WAAY,gCAJhB,0FAQiB,IACf,uBACE3F,KAAK,4DACLsC,MAAO,CAAEwH,MAAO,UAAW2a,eAAgB,QAC3CtkB,OAAO,SACPK,IAAI,uBAJN,wBAYC,qCCvBMsK,+BAA0B,ICqP1B7F,eA7NA,CACbC,KAAM,CACJkE,MAAO,OACPK,OAAQ,OACRnF,QAAS,QAEXogB,MAAO,CACLvf,KAAM,EACNb,QAAS,OACT+c,cAAe,SACf3b,OAAQ,iCACRqO,aAAc,EACd1P,QAAS,cAiNEY,EAhMwC,SACrDY,GACI,IAEFC,EAWED,EAXFC,QACW6e,EAUT9e,EAVF8H,UAHC,EAaC9H,EATFhB,SAAU+f,OAJT,MAIwB,WAJxB,EAKcC,EAQbhf,EARFif,cALC,EAaCjf,EAPFkf,sBANC,WAaClf,EANFqE,uBAPC,WAaCrE,EALFmf,wBARC,SASDpd,EAIE/B,EAJF+B,kBACOqd,EAGLpf,EAHFzJ,MACA2J,EAEEF,EAFFE,SACAhF,EACE8E,EADF9E,OAZC,EAe6BqJ,oBAAS,GAftC,mBAeIlD,EAfJ,KAec4G,EAfd,OAgB6C1D,oBAAS,GAhBtD,mBAgBI6Z,EAhBJ,KAgBsBjW,EAhBtB,OAiBuD5D,wBAExD7J,GAnBC,mBAiBIkN,EAjBJ,KAiB2ByX,EAjB3B,KAoBK9kB,EAAYgC,IAAM+I,WAAWsY,IAA7BrjB,QApBL,EAqBegK,mBAAS,IAAIuS,IAAxBjP,EArBJ,oBAuBGC,EAAiCgX,GAAiB,CACtDQ,SAAUC,YAAiB,KAG7B,IAAKzX,EAAUiX,GACb,MAAM,IAAInI,MAAJ,kCAAqC5W,EAAMhB,WA5BhD,MA+B+C8I,EAAUiX,GAApD/f,EA/BL,EA+BKA,SAAgBwgB,EA/BrB,EA+BetgB,KACV6I,EAAQxL,IAAM+I,WAAWoL,KAAzB3I,IACAC,EAAQzL,IAAM+I,WAAWma,IAAzBzX,IAEF0X,EAA4C,CAChDre,WACA4G,cACAL,wBACArN,QAASA,EACTsN,UACA3M,SACA4M,YACA9I,WACA+I,MACAC,MACAG,uBAGFN,EAAQ8X,yBAAyBD,GAjD9B,MAmDqBnjB,IAAMgI,SAAS9D,EAAWgE,MAnD/C,mBAmDI5H,EAnDJ,KAmDU+iB,EAnDV,QAoD6BrjB,IAAMgI,UAAS,WAC7C,GAAK6a,EAIL,OAAII,EAAsBK,SAAW/qB,qBAAmB+e,KAC/CA,KAAKkC,UAAUqJ,EAAW,KAAM,GAEhCA,KA5DR,qBAoDIU,GApDJ,MAoDcC,GApDd,SA+DmDxjB,IAAMgI,UAAS,WACnE,GAAK6a,EAIL,IACE,OAAOpgB,EAAS8U,MAAMsL,GAEtB,MAAOhJ,QAvER,qBA+DI4J,GA/DJ,MA+DyBC,GA/DzB,MA0EGC,GAAuB3jB,IAAM8D,aACjC,SAAC9J,GAGC,GAFAwpB,GAAYxpB,GAERipB,EAAsBK,SAAW/qB,qBAAmB+e,KACtD,IACEtd,EAAQsd,KAAKC,MAAMvd,GACnB,MAAO6f,GACP,OAIAlW,GACFA,EAAS3J,GAGX,IACE,IAAM4pB,EAAyBnhB,EAAS8U,MAAMvd,GAC9C0pB,GAAuBE,GAEvB,MAAO/J,OAEX,CAACoJ,EAAuBO,GAAaE,GAAwB/f,IAGzDkgB,GAAqB7jB,IAAM8D,aAC/B,SAACiB,GACC2e,GAAuB3e,GACvB,IACE,IAAM+e,EAAcrhB,EAASshB,UAAUhf,GAEnCke,EAAsBK,SAAW/qB,qBAAmB+e,KACtDkM,GAAYlM,KAAKkC,UAAUsK,EAAa,KAAM,IAE9CN,GAAYM,GAGVngB,GACFA,EAASmgB,GAGX,MAAOjK,OAEX,CAACoJ,EAAuBS,GAAwBF,KArH/C,GAwHqCxjB,IAAMgI,WAxH3C,qBAwHIiG,GAxHJ,MAwHkB+V,GAxHlB,MA2HGtB,GAAgBD,GAAqBwB,GAErCC,GAA0BlkB,IAAM8D,aACpC,SAAClH,EAAY4J,GACXsc,EAAyBtc,GACzBwd,GChLC,SACLvjB,EACA4E,EACApI,GAEA,IADyB,EACnBkN,EAA2D,GADxC,eAGN1J,GAHM,IAGzB,2BAA0B,CAAC,IAAhBqO,EAAe,QAClBlS,EAAK,aACTmN,QAAQ,EACRD,SAAS,EACTN,SAAS,GACNsF,GAGDA,EAAKnS,WACPC,EAAMmN,OAAS+E,EAAKnS,SAAS0I,EAAapI,IAGxC6R,EAAKvN,YACP3E,EAAM4M,QAAUsF,EAAKvN,UAAU8D,EAAapI,IAG1C6R,EAAKzO,YACPzD,EAAMkN,QAAUgF,EAAKzO,UAAUgF,EAAapI,IAG9CkN,EAAW2E,EAAKvS,MAAQK,GAvBD,8BA0BzB,MAAO,CACL6D,QACA0J,aACAxL,OAAQ,IDgJJwlB,CAAoB1hB,EAAShC,MAAO7D,EAAOumB,MAI/C,CAAC1gB,EAAUuhB,KAGb,OACE,kBAAC,EAAsBxU,SAAvB,CAAgCxV,MAAOmpB,GACrC,yBAAKnf,UAAWN,EAAQZ,MACtB,yBAAKkB,UAAWN,EAAQ4e,OACtB,kBAAC,EAAD,CACE3e,SAAU0f,EACV5gB,SAAUA,EAAS3H,MACnBgN,gBAAiBA,IAElBxH,IAAS4D,EAAWgE,KACnB,8BACGya,GAGC,oCACE,kBAACP,GAAD,CACEP,iBAAkBA,EAClBuC,QAAStf,IAEX,kBAAC,GAAD,CACEmJ,aAAcA,GACdD,OAAQ0U,GACR5d,SAAUqe,EAAcre,SACxBnG,OAAQA,KAId,yBAAKuB,MAAO,CAAEqR,SAAU,aACtB,kBAAC,EAAD,CACE/L,kBAAmBA,EACnB3F,OAAQ4C,EAAS5C,OACjB8D,SAAUkgB,GACVze,cAAe8e,GACfnf,IAAK0e,GACL3e,SAAUqe,EAAcre,WAE1B,kBAAC,GAAD,CACE+c,iBAAkBA,MAKxB,kBAAC,EAAD,CACE7nB,MAAOupB,GACP5f,SAAUggB,GACV/f,SAAUuf,EAAcre,UAAY8d,U,mBEjEnC/f,eAvJO,CACpBC,KAAM,CACJkE,MAAO,OACPoK,SAAU,KAEZvT,MAAO,CACLoE,QAAS,QACTe,UAAW,OACX0E,MAAO,OACPlE,SAAU,OACV6gB,UAAW,aACX,yBAA0B,OAC1B9gB,WAAY,gCA2IDV,EA5FkD,SAC/DY,GACI,IAAD,MACK5D,EAAgD4D,EAAhD5D,OAAegjB,EAAiCpf,EAAxCzJ,MAAkB2J,EAAsBF,EAAtBE,SAAUD,EAAYD,EAAZC,QAExC/E,GACI,OAANkB,QAAM,IAANA,GAAA,UAAAA,EAAS,uBAAT,eAA0BlB,SAAU,GAE9B6M,EAAQxL,IAAM+I,WAAWoL,KAAzB3I,IACAxN,EAAYgC,IAAM+I,WAAWsY,IAA7BrjB,QAERW,EAAS6M,EAAG,mDACH7M,GADG,UACQ6M,EAAI7M,cADZ,aACQ,EAAYkU,cADpB,UACqCrH,EAAI7M,cADzC,aACqC,EAAYmU,UADjD,IAC2DtH,QACnE7M,EAEJ,IAAM2lB,EAActkB,IAAMukB,SAAmC,WAC3D,IAAMC,EAAW,CACfC,WAAY9lB,EAAO8lB,WACnBC,cAAe/lB,EAAO+lB,cACtB1mB,UACAsN,QAAS,IAAIiP,GACboK,eAAgB,CACdC,mBAAoBpZ,EAAMA,EAAIoZ,wBAAqBzmB,GAErDsC,MAAO9B,EAAO8B,OAQhB,OALI+jB,EAAS/jB,QAAU+jB,EAAS/jB,MAAMokB,YAEpCL,EAAS/jB,MAAMokB,UAAY,CAAC,kBAGvBL,IACN,CAAChZ,EAAKxN,EAASW,IAEZ4M,EAAYvL,IAAMukB,SAErB,WACD,MAAO,CACLxB,SAAUC,YAAiBsB,GAC3BlK,KAAM1X,mBAAa4hB,MAEpB,IAEG9e,EAAoBxF,IAAMukB,SAAQ,WACtC,MAAO,CACLO,UAAW,CACT,gBAAiB,SAACtlB,EAAWc,EAAWykB,GAAvB,OACf,IAAIC,KAAgBxlB,EAAMc,EAAMykB,EAAQT,IAC1C,kBAAmB,SAAC9kB,EAAWc,EAAWykB,GAAvB,OACjB,IAAIE,KAAkBzlB,EAAMc,EAAMykB,EAAQT,QAG/C,CAAC9Y,EAAK8Y,IAET,OACE,yBAAKtgB,UAAWN,EAAQZ,QACrBnE,EAAO4O,QACN,2BAAO2X,wBAAyB,CAAEC,OAAQxmB,EAAO4O,YAIlD5O,EAAOymB,YACN,0BAAMhnB,IAAI,aAAaR,KAAMe,EAAOymB,eAKrCzmB,EAAOd,OACN,yBAAKmG,UAAWN,EAAQ7F,OAAQc,EAAOd,OAKzC,kBAAC,GAAD,CACE0N,UAAWA,EACX9I,SAAU9D,EAAO8D,SACjB+C,kBAAmBA,EACnBkd,cAAe/jB,EAAO0mB,QAAU1mB,EAAO0mB,QAAQrX,YAAS7P,EACxDwkB,eAAgBhkB,EAAO0mB,QAAU1mB,EAAO0mB,QAAQxb,cAAW1L,EAC3D2J,gBAAiBnJ,EAAO2mB,SAAW3mB,EAAO2mB,SAASzb,cAAW1L,EAC9DykB,iBACEjkB,EAAO2mB,SAAW3mB,EAAO2mB,SAAS1hB,cAAWzF,EAE/CwF,SAAUA,EACVhF,OAAQA,EACR3E,MAAO6oB,QC1KA,YAAC0C,GACd,IAAMxG,EAAU,eAAQwG,EAAWxG,YAsBnC,OALAA,EAAWxb,WAhBQ,8BACF,CACf,KACA,KACA,KACA,KACA,KACA,KACA,YACA,YACA,QACA,QACA,SACA,UACA,YAGOiiB,SAAQ,SAAC7W,GAChBoQ,EAAWpQ,GAASpL,WAlBH,iCAqBZ,2BAAKgiB,GAAZ,IAAwBxG,gBCJL0G,G,kDACnB,WAAYhiB,GAAY,IAAD,8BACrB,cAAMA,IACD7G,MAAQ,CAAE8oB,WAAW,GAC1B,EAAKC,kBAAoB,EAAKA,kBAAkBpf,KAAvB,gBACzB,EAAKqf,iBAAmB,EAAKA,iBAAiBrf,KAAtB,gBAJH,E,gEAQrBjN,KAAKusB,gBACLvsB,KAAKwsB,kB,sCAIL,IAAMC,EAAU3P,oHAAY4P,wBACtBC,EAAU7P,oHAAY8P,yBACtBC,EAAQ/P,oHAAYgQ,yBAEtBL,GAAWE,GAAWE,IACxB3L,IAAW6L,KAAK,CACdC,cAAeL,EACfM,YAAaR,EACbS,IAAKL,EACLM,KAAM,gBACNC,QAAS,yBACT/P,QAAS,QACTgQ,gBAAgB,EAChBC,gBAAgB,EAChBC,uBAAuB,EACvBC,oBAAqB,QACrBC,WAAY,IACZC,2BAA2B,EAC3BC,MAAO,mCAGTzM,IAAW0M,iC,sLAKKb,c,cAAZ7a,E,QACF8W,MAAM6E,mBAEV3b,EAAI4b,YACDC,aACA9sB,MAAK,SAACoZ,GACL6G,IAAW8M,iBAAiB,CAC1BC,WAAY5T,EAAK4T,gBAGpBtU,OAAM,e,SAESzH,EAAIyM,WACnBC,QAAQ,eACR3d,MAAK,qBAAGkR,OACRwH,OAAM,iBAAO,M,cAHVxH,E,OAKA9M,E,iDACD6M,EAAIgc,a,iBAAJ,EAAW3nB,c,iBAAX,EAAoB,uB,aAApB,EAAqClB,Q,UACrC6M,EAAI7M,c,aAAJ,EAAYkU,c,UACZrH,EAAI7M,c,aAAJ,EAAYmU,U,UAGQtH,EAAIgc,MAAMxU,W,QAA7BhZ,E,OACNV,KAAKqN,SAAS,CACZ6E,MACAka,WAAW,EACX1rB,QACA2E,SACA8M,Q,+IAIqBzR,GACnBV,KAAKsD,MAAM8oB,WAAapsB,KAAKsD,MAAM4O,KACrClS,KAAKsD,MAAM4O,IAAIgc,MAAMzK,SAAS/iB,K,4KAKzB,CAAE4D,KAAM,GAAIC,MAAO,K,gIAGS,IAAD,EACKvE,KAAKsD,MAApC8oB,EAD0B,EAC1BA,UAAW1rB,EADe,EACfA,MAAOwR,EADQ,EACRA,IAAKC,EADG,EACHA,IAE/B,OACE,yBAAKzH,UAAU,OACZ0hB,GAAala,EACZ,6BACGic,YACC,kBAACC,EAAA,EAAD,CAAe5I,MAAOA,IACpB,kBAAC,IAAWtP,SAAZ,CAAqBxV,MAAO,CAAEwR,QAC5B,kBAAC0X,GAAW1T,SAAZ,CAAqBxV,MAAO,CAAEyR,QAC5B,kBAAC,GAAD,CAA0B9M,OAAQrF,KAAKsD,MAAM+B,QAC3C,kBAAC,GAAD,CACEgF,SAAUrK,KAAKqsB,kBACf3rB,MAAOA,EACP6F,OAAQ2L,EAAIgc,MAAM3nB,eAShC,0C,GA3GuBG,IAAM+G,W,OCXvC4gB,IAASC,OAAO,kBAAC,GAAD,MAASve,SAASwe,eAAe,SjBN1C,WAA0B,IAAD,EAC9B,GAAK1R,GAAL,CAGA6D,OAAOvD,UAAY,YAChBuD,OAAOvD,UAAUqR,EAAI9N,OAAOvD,UAAUqR,GAAK,IAAIrsB,KAAK1C,YAGvDihB,OAAOvD,UAAUxd,EAAIkd,GACrB6D,OAAOvD,UAAUsR,EAAI,CAAEC,kBAAkB,GAEzC,IAAMC,EAASjO,OAAO3Q,SAASpJ,cAAc,UAC7CgoB,EAAOC,OAAQ,EACfD,EAAO7oB,IAAP,2DAAiE+W,IACjE,IAAMvd,EAAIohB,OAAO3Q,SAAS8e,qBAAqB,UAAU,GACzD,UAAAvvB,EAAEwvB,kBAAF,SAAcC,aAAaJ,EAAQrvB,IiBPrC0vB,I,gCCVO,SAAS5nB,EAAcoI,EAAUtI,GACpC,QAAIA,EAAQC,QACRD,EAAQC,MAAMokB,YACiC,IAA/CrkB,EAAQC,MAAMokB,UAAUrU,QAAQ1H,OAGhCtI,EAAQC,QACRD,EAAQC,MAAM8nB,YACiC,IAA/C/nB,EAAQC,MAAM8nB,UAAU/X,QAAQ1H,IARxC,sGAaA,IAAI0f,EAAiB,+BACd,SAASC,EAAeC,EAAaloB,GACxC,GAAIA,GAAWA,EAAQkkB,cAAe,CAClC,IAAIiE,EAASnoB,EAAQkkB,cAAcgE,GACnC,OAAOC,GAAUH,EAAeje,KAAKoe,GAAUA,EAASD,EAE5D,OAAOA,EAEJ,SAASE,EAAgBC,EAAYroB,GACxC,GAAIA,GAAWA,EAAQkkB,cAAe,CAClC,IAAIoE,EAAYtoB,EAAQkkB,cAExB,OADWjsB,OAAOiX,KAAKoZ,GACXxe,MAAK,SAAUQ,GAAO,OAAOge,EAAUhe,KAAS+d,MAAkBA,EAElF,OAAOA,I,gCC3BJ,SAASE,EAAQnsB,GAEpB,OADYA,EAAMY,UAAUwrB,MACfC,MAAQ,EAElB,SAASpsB,EAAaD,EAAOH,GAChC,IAAIf,EAAKkB,EAAMY,UAAWa,EAAO3C,EAAG2C,KAAM2qB,EAAQttB,EAAGstB,MAAO1qB,EAAK5C,EAAG4C,GACpE,OADgF5C,EAAG2F,MAExE5E,EAAKysB,QAAQtsB,EAAMusB,aAAeH,EAAM9rB,SAGxCN,EAAMmI,IAAIqkB,aAAa/qB,EAAMC,EAAI7B,GAGzC,SAASgB,EAAkBb,GAC9B,IAAIlB,EAAKkB,EAAMY,UAAWwrB,EAAQttB,EAAGstB,MAAOK,EAAM3tB,EAAG2tB,IACjDC,EAAe,GAMnB,OALA1sB,EAAMmI,IAAIwkB,aAAaP,EAAMQ,IAAKH,EAAIG,KAAK,SAAUhqB,EAAMiqB,GACvDjqB,EAAKtC,MAAMsoB,SAAQ,SAAU7nB,GACzB,OAAO2rB,EAAa7tB,KAAK,CAAE4C,KAAMorB,EAAOnrB,GAAImrB,EAAQjqB,EAAKkqB,SAAU/rB,KAAMA,UAG1E2rB,EASJ,SAAShnB,EAAU1F,EAAOH,GAE7B,IADA,IAAIusB,EAAQpsB,EAAMY,UAAUwrB,MACnBvc,EAAIuc,EAAMC,MAAOxc,GAAK,EAAGA,IAAK,CACnC,IAAIkd,EAAQX,EAAMW,MAAMld,GACxB,GAAIuc,EAAMxpB,KAAKiN,GAAGmd,eAAeD,EAAOA,EAAOltB,GAC3C,OAAO,EAGf,OAAO,EAEJ,SAAS+F,IACZ,OAAO,SAAU5F,EAAOI,GACpB,IAAI4H,EAAMhI,EAAMY,UACZqsB,EAAUjlB,EAAIilB,QACdC,EAASllB,EAAIklB,OACjB,GAAI9sB,EACA,GAAI6sB,EAEA,IADA,IACSE,EAAK,EAAGC,EADLptB,EAAMusB,aAAeU,EAAQ3sB,QACP6sB,EAAKC,EAAQhxB,OAAQ+wB,IAAM,CACzD,IAAIpsB,EAAOqsB,EAAQD,GACnB/sB,EAASJ,EAAMW,GAAG0sB,iBAAiBtsB,EAAKlB,WAG3C,CAED,IADA,IAAIc,EAAKX,EAAMW,GACN7B,EAAK,EAAGwuB,EAAWJ,EAAQpuB,EAAKwuB,EAASlxB,OAAQ0C,IAEtD,IADA,IAAIyuB,EAAQD,EAASxuB,GACZM,EAAK,EAAGouB,EAAK3xB,OAAOiX,KAAK9S,EAAMiD,OAAO3C,OAAQlB,EAAKouB,EAAGpxB,OAAQgD,IAAM,CACzE,IAAIquB,EAAWD,EAAGpuB,GAClBuB,EAAGkB,WAAW0rB,EAAMnB,MAAMQ,IAAKW,EAAMd,IAAIG,IAAK5sB,EAAMiD,OAAO3C,MAAMmtB,IAGzErtB,EAASO,GAGjB,OAAO,G,2MCjER,SAAS+sB,IACZ,MAAO,CACH5S,QAAS,QACThK,MAAO,QACP6c,UAAU,EACVptB,MAAO,CACHnD,MAAO,IAEX0vB,SAAU,EACVc,WAAW,EACXC,MAAM,EACNC,SAAU,CACN,CACIC,IAAK,oCACLC,SAAU,SAAUC,GAEhB,MAAO,CACH7wB,MAFQsd,KAAKC,MAAMsT,EAAIC,aAAa,2BAOpDC,MAAO,SAAUvrB,GACb,IAAIxF,EAAQwF,EAAKrC,MAAMnD,MACvB,MAAO,CAAC,gBAAiB,CAAE,qBAAsBsd,KAAKkC,UAAUxf,O,qOCxBxExB,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAE5BiyB,EAAkC,SAAUpyB,EAAGuB,GAC/C,IAAIxB,EAAI,GACR,IAAK,IAAIM,KAAKL,EAAOH,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,IAAMkB,EAAEqW,QAAQvX,GAAK,IAC9EN,EAAEM,GAAKL,EAAEK,IACb,GAAS,MAALL,GAAqD,oBAAjCH,OAAOiY,sBACtB,KAAI7X,EAAI,EAAb,IAAgBI,EAAIR,OAAOiY,sBAAsB9X,GAAIC,EAAII,EAAED,OAAQH,IAC3DsB,EAAEqW,QAAQvX,EAAEJ,IAAM,GAAKJ,OAAOS,UAAU0X,qBAAqBxX,KAAKR,EAAGK,EAAEJ,MACvEF,EAAEM,EAAEJ,IAAMD,EAAEK,EAAEJ,KAE1B,OAAOF,GAqCIkK,cAhCF,CACTC,KAAM,CACFZ,QAAS,QACT8E,MAAO,OACPhE,UAAW,IACX7C,OAAQ,gBACRoR,SAAU,YAEdmG,QAAS,GACT,aAAc,GACd,iBAAkB,IAsBP7U,EApBK,SAAUY,GAC1B,IAAI/H,EACAgI,EAAUD,EAAMC,QAASyH,EAAW1H,EAAM0H,SAAUnH,EAAYP,EAAMO,UAAWhI,EAAKyH,EAAMuI,QAASA,OAAiB,IAAPhQ,EAAgB,QAAUA,EAAIivB,EAAcxnB,EAAMwnB,YAAaC,EAAQF,EAAOvnB,EAAO,CAAC,UAAW,WAAY,YAAa,UAAW,gBACpP0nB,EAAwBnrB,IAAMukB,SAAQ,WACtC,GAAK0G,EAAL,CAGA,IAAIG,EAAaH,EAAYvW,MAAM,KACnC,GAA0B,IAAtB0W,EAAWpyB,OAGf,OAAOgjB,KAAKqP,MAAMC,OAAOF,EAAW,IAAME,OAAOF,EAAW,IAAM,KAAO,OAC1E,CAACH,IACJ,OAAQjrB,IAAMC,cAAc,MAAOzH,EAAS,GAAI0yB,EAAO,CAAElnB,UAAWuE,YAAK7E,EAAQZ,MAAOpH,EAAK,GACrFA,EAAGgI,EAAQ,eAA6B,eAAZsI,EAC5BtQ,EAAGgI,EAAQ,mBAAiC,mBAAZsI,EAChCtQ,GAAKsI,KAAeinB,EAAejrB,IAAMC,cAAcD,IAAMurB,SAAU,KAC3EvrB,IAAMC,cAAc,MAAO,CAAEC,MAAO,CAAEgC,QAAS,QAASyf,WAAYwJ,IAA2B,QAC/FnrB,IAAMC,cAAc,MAAO,CAAE+D,UAAWuE,YAAK7E,EAAQgU,UAAYvM,IAAenL,IAAMC,cAAc,MAAO,CAAE+D,UAAWuE,YAAK7E,EAAQgU,UAAYvM,O,2BCtBrJqgB,EAAgB3oB,YAzBP,CACTC,KAAM,CACF,sBAAuB,CACnByE,WAAY,YAGpB3F,MAAO,CACHgH,SAAU,QAEdwb,QAAS,GACTqH,OAAQ,GACRC,QAAS,GACTC,YAAa,CACTla,IAAK,EACLma,KAAM,EACNpa,MAAO,EACPoQ,OAAQ,EACR1f,QAAS,OACTqP,SAAU,WACVxG,WAAY,SACZ8gB,aAAc,SACd5M,cAAe,MACf6M,eAAgB,WAGJjpB,EAAmB,SAAUY,GAC7C,IAAI/H,EACA8D,EAAOiE,EAAMjE,KAAMusB,EAAWtoB,EAAMsoB,SAAUroB,EAAUD,EAAMC,QAASlD,EAAUiD,EAAMjD,QACvFxG,EAAQwF,EAAKrC,MAAMnD,MAEnBgC,EAAKgE,IAAMgI,UAAS,GAAQyjB,EAASzvB,EAAG,GAAIgwB,EAAYhwB,EAAG,GAC3DouB,EAAKpqB,IAAMgI,UAAS,GAAQoc,EAAUgG,EAAG,GAAI6B,EAAa7B,EAAG,GAC7D8B,EAAgBlsB,IAAM8D,aAAY,WAClCmoB,GAAW,KACZ,CAACA,IACAE,EAAcnsB,IAAM8D,aAAY,WAChCkoB,GAAU,GACVC,GAAW,KACZ,CAACD,EAAWC,IACXG,EAAepsB,IAAM8D,aAAY,WACjCkoB,GAAU,GACVC,GAAW,KACZ,CAACD,EAAWC,IACXI,EAAgBryB,GAASA,EAAMsyB,UAAYtyB,EAAMuC,KAEjDgwB,EAAMC,IACV,OAAQxsB,IAAMC,cAAc,MAAO,CAAE+D,UAAWuE,YAAK7E,EAAQZ,MAAOpH,EAAK,GACjEA,EAAGgI,EAAQ+nB,QAAUA,EACrB/vB,EAAGgI,EAAQ0gB,SAAWA,EACtB1oB,EAAGgI,EAAQgoB,UAAYW,EACvB3wB,KACJsE,IAAMC,cAAcwsB,EAAe,CAAEzgB,QAAS,iBAAkBif,YAAaQ,GAAUrH,IAAYiI,EAAgB,WAAQluB,KACvHkuB,GACKrsB,IAAMC,cAAc,MAAO,CAAE+D,UAAWN,EAAQ9B,MAAOxC,IAAK,MAAQoB,GAAWA,EAAQmkB,gBAAkBnkB,EAAQmkB,eAAeC,mBAAqBpkB,EAAQmkB,eAAeC,mBAAqB5qB,EAAM0yB,aAAe,MAAQ1yB,EAAMsyB,SAAW,IAAMK,mBAAmB3yB,EAAMuC,MAAOqwB,YAAaV,EAAetT,QAASuT,EAAaU,OAAQT,EAAc/sB,IAAK,KACvWW,IAAMC,cAAc,MAAO,CAAE+D,UAAWN,EAAQioB,aAAevH,EAC3DpkB,IAAMC,cAAc6sB,IAAkB,SACrCrB,GAAWY,IAAgBrsB,IAAMC,cAAc8sB,IAAiB,CAAEvpB,SAAU,WACjFxD,IAAMC,cAAc+sB,IAAgB,CAAEhhB,QAAS,kBAC3ChM,IAAMC,cAAcssB,EAAK,CAAEvgB,QAAS,OAAQ1D,QAASyjB,GAAYkB,WAE7EjI,EAAiC,WACjC,SAASA,EAAgBxlB,EAAMc,EAAMykB,EAAQvkB,QACzB,IAAZA,IAAsBA,EAAU,IACpClH,KAAKkG,KAAOA,EACZlG,KAAKgH,KAAOA,EACZhH,KAAKyrB,OAASA,EACdzrB,KAAKkH,QAAUA,EACflH,KAAKuxB,IAAMxhB,SAASpJ,cAAc,OAClC3G,KAAK4zB,aAAe5zB,KAAK4zB,aAAa3mB,KAAKjN,MAC3CA,KAAKsuB,SAUT,OARA5C,EAAgB9rB,UAAUg0B,aAAe,WACrC,IAAIzD,EAAQnwB,KAAKyrB,SACbxnB,EAAKjE,KAAKgH,KAAK1D,MAAMW,GAAG4vB,OAAO1D,EAAOA,EAAQnwB,KAAKkG,KAAKkqB,UAC5DpwB,KAAKgH,KAAKtD,SAASO,IAEvBynB,EAAgB9rB,UAAU0uB,OAAS,WAC/BD,IAASC,OAAOH,YAAUznB,IAAMC,cAAcurB,EAAe,CAAEhrB,QAASlH,KAAKkH,QAAShB,KAAMlG,KAAKkG,KAAMusB,SAAUzyB,KAAK4zB,gBAAkB5zB,KAAKuxB,MAE1I7F,EAnB0B,GCpE9B,SAASoI,IACZ,MAAO,CACH1V,QAAS,QACThK,MAAO,QACP6c,UAAU,EACVptB,MAAO,CACHnD,MAAO,IAEX0vB,SAAU,EACVc,WAAW,EACXC,MAAM,EACNC,SAAU,CACN,CACIC,IAAK,wCACLC,SAAU,SAAUC,GAEhB,MAAO,CACH7wB,MAFQsd,KAAKC,MAAMsT,EAAIC,aAAa,6BAOpDC,MAAO,SAAUvrB,GACb,IAAIxF,EAAQwF,EAAKrC,MAAMnD,MACvB,MAAO,CACH,kBACA,CAAE,uBAAwBsd,KAAKkC,UAAUxf,OCpBzD,IA0DIwxB,EAAgB3oB,YA1DP,CACTC,KAAM,CACF,sBAAuB,CACnByE,WAAY,WAEhB8lB,UAAW,kGAEf3B,QAAS,GACThU,QAAS,CACLnG,SAAU,WACVE,IAAK,EACLma,KAAM,EACNpa,MAAO,EACPoQ,OAAQ,EACR0L,eAAgB,UAChBC,iBAAkB,YAClBC,mBAAoB,OAExB7B,YAAa,CACTla,IAAK,EACLma,KAAM,EACNpa,MAAO,EACPoQ,OAAQ,EACR1f,QAAS,OACTqP,SAAU,WACVxG,WAAY,SACZ8gB,aAAc,SACd5M,cAAe,MACf6M,eAAgB,WA8BJjpB,EAAmB,SAAUY,GAC7C,IAAI/H,EACA8D,EAAOiE,EAAMjE,KAAMusB,EAAWtoB,EAAMsoB,SAAUroB,EAAUD,EAAMC,QAASlD,EAAUiD,EAAMjD,QACvFxG,EAAQwF,EAAKrC,MAAMnD,MACnBqyB,EAAgBryB,GAASA,EAAM0S,IAAM1S,EAAMkgB,YAC3CuT,EAAqBjtB,EAAQC,OAASD,EAAQC,MAAM,mBAAqBD,EAAQC,MAAM,wBAAqBtC,EAC5GqmB,EAAWiJ,EAjCG,SAAUjJ,GAC5B,QAAiBrmB,IAAbqmB,EAAJ,CAGK,GAAIkJ,MAAMC,QAAQnJ,GAAW,CAC9B,IAAIoJ,EAAW,CACXC,MAAO,GACPC,MAAO,GACPC,aAAc,IAalB,OAXAvJ,EAASgB,SAAQ,SAAUwI,GACnBA,EAAQC,OACRL,EAASC,MAAMG,EAAQthB,IAAMshB,EAAQC,MAErCD,EAAQxxB,OACRoxB,EAASE,MAAME,EAAQthB,IAAMshB,EAAQxxB,MAErCwxB,EAAQ/C,aAAe2C,EAASG,eAChCH,EAASG,aAAaC,EAAQthB,IAAMshB,EAAQ/C,gBAG7C2C,EAGP,OAAOpJ,GASyB0J,CAAgBT,EAAmBU,0BAAuBhwB,EAC1FiwB,EAAa5J,GAAY6H,EAAgBgC,YAAmB7J,EAAUxqB,EAAMkgB,kBAAe/b,EAC3FmwB,EAAkB9J,GAAY6H,EAAgBkC,YAAmB/J,EAAUxqB,EAAMkgB,kBAAe/b,EAChG8sB,EAAczG,GAAYA,EAASuJ,cAAgB1B,EAcpD,SAAmC0B,EAAcS,GACpD,IAAK,IAAIzE,EAAK,EAAGruB,EAAKjD,OAAOiX,KAAKqe,GAAehE,EAAKruB,EAAG1C,OAAQ+wB,IAAM,CACnE,IAAIjf,EAAMpP,EAAGquB,GACb,GAAY,MAARjf,GAAeA,IAAQ0jB,EACvB,OAAOT,EAAajjB,IAlB2C2jB,CAA0BjK,EAASuJ,aAAc/zB,EAAMkgB,kBAAe/b,EAEzIouB,EAAMC,IACV,OAAQxsB,IAAMC,cAAc,MAAO,CAAE+D,UAAWuE,YAAK7E,EAAQZ,MAAOpH,EAAK,GAAIA,EAAGgI,EAAQgoB,UAAYW,EAAe3wB,KAC/GsE,IAAMC,cAAcwsB,EAAe,CAAEzgB,QAAS,iBAAkBif,YAAaA,GAAe,OACxFjrB,IAAMC,cAAc,MAAO,CAAE+D,UAAWuE,YAAK7E,EAAQgU,SAAUxX,MAAO,CAC9DwuB,gBAAiB,QAAUN,GAAcO,KAAmB,SAC3DL,GAAmB9tB,GAAWA,EAAQmkB,gBAAkBnkB,EAAQmkB,eAAeC,qBAAsB5kB,IAAMC,cAAc2uB,IAAe,CAAEC,SAAUP,EAAiB3vB,OAAQ,CAC9KmwB,cAAe90B,EAAM0S,GACrBkY,mBAAoBpkB,EAAQmkB,eAAeC,uBAEnD5kB,IAAMC,cAAc+sB,IAAgB,CAAEhhB,QAAS,kBAC3ChM,IAAMC,cAAcssB,EAAK,CAAEvgB,QAAS,OAAQ1D,QAASyjB,GAAYkB,WAUjF,IAAIhI,EAAmC,WACnC,SAASA,EAAkBzlB,EAAMc,EAAMykB,EAAQvkB,QAC3B,IAAZA,IAAsBA,EAAU,IACpClH,KAAKkG,KAAOA,EACZlG,KAAKgH,KAAOA,EACZhH,KAAKyrB,OAASA,EACdzrB,KAAKkH,QAAUA,EACflH,KAAKuxB,IAAMxhB,SAASpJ,cAAc,OAClC3G,KAAK4zB,aAAe5zB,KAAK4zB,aAAa3mB,KAAKjN,MAC3CA,KAAKsuB,SAUT,OARA3C,EAAkB/rB,UAAUg0B,aAAe,WACvC,IAAIzD,EAAQnwB,KAAKyrB,SACbxnB,EAAKjE,KAAKgH,KAAK1D,MAAMW,GAAG4vB,OAAO1D,EAAOA,EAAQnwB,KAAKkG,KAAKkqB,UAC5DpwB,KAAKgH,KAAKtD,SAASO,IAEvB0nB,EAAkB/rB,UAAU0uB,OAAS,WACjCD,IAASC,OAAOH,YAAUznB,IAAMC,cAAcurB,EAAe,CAAEhrB,QAASlH,KAAKkH,QAAShB,KAAMlG,KAAKkG,KAAMusB,SAAUzyB,KAAK4zB,gBAAkB5zB,KAAKuxB,MAE1I5F,EAnB4B,G,4CC/FnC1rB,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,IAAW,MAAOG,GAAKL,EAAOK,IACpF,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAS,MAAUK,IAAW,MAAOG,GAAKL,EAAOK,IACvF,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,OAITO,KAAKR,EAAWK,GAClGH,GAAMN,EAAYA,EAAUN,MAAMG,EAASC,GAAc,KAAKS,YAGlEM,EAA4C,SAAUhB,EAASiB,GAC/D,IAAsGC,EAAGC,EAAGhC,EAAGiC,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAPpC,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOqC,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAEV,KAAMgB,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,oBAAXC,SAA0BP,EAAEO,OAAOC,UAAY,WAAa,OAAO9B,OAAUsB,EACvJ,SAASM,EAAKpC,GAAK,OAAO,SAAUuC,GAAK,OACzC,SAAcC,GACV,GAAIZ,EAAG,MAAM,IAAIa,UAAU,mCAC3B,KAAOV,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMhC,EAAY,EAAR2C,EAAG,GAASX,EAAC,OAAaW,EAAG,GAAKX,EAAC,SAAehC,EAAIgC,EAAC,SAAehC,EAAES,KAAKuB,GAAI,GAAKA,EAAET,SAAWvB,EAAIA,EAAES,KAAKuB,EAAGW,EAAG,KAAKhB,KAAM,OAAO3B,EAE3J,OADIgC,EAAI,EAAGhC,IAAG2C,EAAK,CAAS,EAARA,EAAG,GAAQ3C,EAAEqB,QACzBsB,EAAG,IACP,KAAK,EAAG,KAAK,EAAG3C,EAAI2C,EAAI,MACxB,KAAK,EAAc,OAAXT,EAAEC,QAAgB,CAAEd,MAAOsB,EAAG,GAAIhB,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIW,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKT,EAAEI,IAAIO,MAAOX,EAAEG,KAAKQ,MAAO,SACxC,QACI,KAAkB7C,GAAZA,EAAIkC,EAAEG,MAAYhC,OAAS,GAAKL,EAAEA,EAAEK,OAAS,MAAkB,IAAVsC,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAET,EAAI,EAAG,SACjG,GAAc,IAAVS,EAAG,MAAc3C,GAAM2C,EAAG,GAAK3C,EAAE,IAAM2C,EAAG,GAAK3C,EAAE,IAAM,CAAEkC,EAAEC,MAAQQ,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYT,EAAEC,MAAQnC,EAAE,GAAI,CAAEkC,EAAEC,MAAQnC,EAAE,GAAIA,EAAI2C,EAAI,MAC7D,GAAI3C,GAAKkC,EAAEC,MAAQnC,EAAE,GAAI,CAAEkC,EAAEC,MAAQnC,EAAE,GAAIkC,EAAEI,IAAIQ,KAAKH,GAAK,MACvD3C,EAAE,IAAIkC,EAAEI,IAAIO,MAChBX,EAAEG,KAAKQ,MAAO,SAEtBF,EAAKb,EAAKrB,KAAKI,EAASqB,GAC1B,MAAOV,GAAKmB,EAAK,CAAC,EAAGnB,GAAIQ,EAAI,EAjBrB,QAiBoCD,EAAI/B,EAAI,EACtD,GAAY,EAAR2C,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEtB,MAAOsB,EAAG,GAAKA,EAAG,QAAK,EAAQhB,MAAM,GArB9BL,CAAK,CAACnB,EAAGuC,OA0FtD,SAAS0zB,EAA0BlvB,EAAQW,GAC9C,IAAIC,EAAQ,GAcZ,OAbIC,wBAAc,gBAAiBF,IAC/BX,EAAOO,MAAM,kBACbK,EAAMhF,KAhEP,SAAqBoE,GACxB,IAAI9C,EAAQzD,KACRkG,EAAOK,EAAOO,MAAM,iBACxB,MAAO,CACH7D,KAAM,gBACNzB,MAAO,eACP4B,YAAasD,IAAMC,cAAc+uB,IAAiB,MAClD3uB,UAAW,SAAUzD,GAAS,OAAQmsB,kBAAQnsB,IAC9CvD,MAAO,SAAUuD,EAAOI,EAAUC,GAAyB,OAAO1D,EAAUwD,OAAO,OAAQ,GAAQ,WAC/F,IAAI/C,EACJ,OAAOQ,EAAYlB,MAAM,SAAUoC,GAC/B,OAAQA,EAAGZ,OACP,KAAK,EAED,OADAY,EAAGV,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAawB,EAAsBe,QAAQ8iB,kBACvD,KAAK,EAKD,OAJA9mB,EAAQ0B,EAAGX,OACXiC,EAASJ,EAAMW,GAAG2B,qBAAqBM,EAAKL,cAAc,CACtDnF,MAAOA,MAEJ,CAAC,EAAa,GACzB,KAAK,EAED,OADQ0B,EAAGX,OACJ,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,YAwCjBk0B,CAAYpvB,IAEvBa,wBAAc,kBAAmBF,IACjCX,EAAOO,MAAM,oBAEbI,EAAQC,OACRD,EAAQC,MAAM,oBACdD,EAAQC,MAAM,mBAAmByuB,cACjC1uB,EAAQC,MAAM,mBAAmByuB,cACjCzuB,EAAMhF,KA3CP,SAAuBoE,EAAQqvB,GAClC,IAAInyB,EAAQzD,KACRkG,EAAOK,EAAOO,MAAM,mBACxB,MAAO,CACH7D,KAAM,kBACNzB,MAAO,iBACP4B,YAAasD,IAAMC,cAAckvB,IAAe,MAChD9uB,UAAW,SAAUzD,GAAS,OAAQmsB,kBAAQnsB,IAC9CvD,MAAO,SAAUuD,EAAOI,EAAUC,GAAyB,OAAO1D,EAAUwD,OAAO,OAAQ,GAAQ,WAC/F,IAAI/C,EACJ,OAAOQ,EAAYlB,MAAM,SAAUoC,GAC/B,OAAQA,EAAGZ,OACP,KAAK,EAED,OADAY,EAAGV,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAawB,EAAsBe,QAAQgjB,iBAAiBkO,IACxE,KAAK,EAKD,OAJAl1B,EAAQ0B,EAAGX,OACXiC,EAASJ,EAAMW,GAAG2B,qBAAqBM,EAAKL,cAAc,CACtDnF,MAAOA,MAEJ,CAAC,EAAa,GACzB,KAAK,EAED,OADQ0B,EAAGX,OACJ,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,YAmBjBq0B,CAAcvvB,EAAQW,EAAQC,MAAM,mBAAmByuB,eAE/DzuB,I,mICrHPjI,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAIhC,SAASs2B,EAAwBzyB,GAC7B,IAAI0yB,EAAc,IAAIxS,IAClBziB,EAAS,GAOb,OANAuC,EAAMmI,IAAIwkB,aAAa3sB,EAAMY,UAAUa,KAAMzB,EAAMY,UAAUc,IAAI,SAAUkB,EAAMgqB,EAAKlqB,EAAQqqB,GACtFnqB,EAAK+vB,cAAgBD,EAAYlS,IAAI5d,KACrCnF,EAAOoB,KAAK,CAAE+D,KAAMA,EAAMgqB,IAAKA,EAAKC,MAAO,EAAGR,MAAO,IACrDqG,EAAYE,IAAIhwB,OAGjBkuB,MAAMrvB,KAAKhE,GAEtB,SAASqF,EAAM9C,EAAOI,EAAUyyB,GAE5B,IAAIp1B,EAASg1B,EAAwBzyB,GACjCW,EAAKX,EAAMW,GAQf,OAPAlD,EAAOmrB,SAAQ,SAAU7R,GACrB,IAAInU,EAAOmU,EAAKnU,KAAMgqB,EAAM7V,EAAK6V,IACjCjsB,EAAKA,EAAGmyB,cAAclG,EAAKhqB,EAAK/C,KAAMjE,EAASA,EAAS,GAAIgH,EAAKrC,OAAQ,CAAEuC,MAAO+vB,QAElFzyB,GACAA,EAASO,IAEN,EAEX,SAASoyB,EAAY/yB,EAAO0D,EAAMmvB,GAE9B,IAAIp1B,EAASg1B,EAAwBzyB,GACjCgzB,GAAc,EAMlB,OALAv1B,EAAOmrB,SAAQ,SAAU7R,IAChBtZ,EAAO,GAAGmF,KAAKrC,MAAMuC,OAAS,UAAY+vB,IAC3CG,GAAc,MAGA,IAAlBv1B,EAAOrB,SAGH42B,EAEZ,SAASC,EAAUjzB,EAAO0D,GAEtB,OAAO+uB,EAAwBzyB,GAAO5D,OAAS,ECpD5C,IAAIgN,EAAS,CAChB0H,MAAO,SACPoiB,QAAQ,EACR3yB,MAAO,CACHnD,MAAO,IAEX0wB,SAAU,CACN,CACIC,IAAK,QACLC,SAAU,SAAUC,GAEhB,MAAO,CACH7wB,MAFQsd,KAAKC,MAAMsT,EAAIC,aAAa,WAOpDC,MAAO,SAAUvrB,GACb,IAAIxF,EAAQwF,EAAKrC,MAAMnD,MACvB,MAAO,CAAC,IAAK,CAAE0S,GAAI4K,KAAKkC,UAAUxf,IAAUA,K,SCpBhDT,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,IAAW,MAAOG,GAAKL,EAAOK,IACpF,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAS,MAAUK,IAAW,MAAOG,GAAKL,EAAOK,IACvF,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,OAITO,KAAKR,EAAWK,GAClGH,GAAMN,EAAYA,EAAUN,MAAMG,EAASC,GAAc,KAAKS,YAGlEM,EAA4C,SAAUhB,EAASiB,GAC/D,IAAsGC,EAAGC,EAAGhC,EAAGiC,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAPpC,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOqC,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAEV,KAAMgB,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,oBAAXC,SAA0BP,EAAEO,OAAOC,UAAY,WAAa,OAAO9B,OAAUsB,EACvJ,SAASM,EAAKpC,GAAK,OAAO,SAAUuC,GAAK,OACzC,SAAcC,GACV,GAAIZ,EAAG,MAAM,IAAIa,UAAU,mCAC3B,KAAOV,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMhC,EAAY,EAAR2C,EAAG,GAASX,EAAC,OAAaW,EAAG,GAAKX,EAAC,SAAehC,EAAIgC,EAAC,SAAehC,EAAES,KAAKuB,GAAI,GAAKA,EAAET,SAAWvB,EAAIA,EAAES,KAAKuB,EAAGW,EAAG,KAAKhB,KAAM,OAAO3B,EAE3J,OADIgC,EAAI,EAAGhC,IAAG2C,EAAK,CAAS,EAARA,EAAG,GAAQ3C,EAAEqB,QACzBsB,EAAG,IACP,KAAK,EAAG,KAAK,EAAG3C,EAAI2C,EAAI,MACxB,KAAK,EAAc,OAAXT,EAAEC,QAAgB,CAAEd,MAAOsB,EAAG,GAAIhB,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIW,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKT,EAAEI,IAAIO,MAAOX,EAAEG,KAAKQ,MAAO,SACxC,QACI,KAAkB7C,GAAZA,EAAIkC,EAAEG,MAAYhC,OAAS,GAAKL,EAAEA,EAAEK,OAAS,MAAkB,IAAVsC,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAET,EAAI,EAAG,SACjG,GAAc,IAAVS,EAAG,MAAc3C,GAAM2C,EAAG,GAAK3C,EAAE,IAAM2C,EAAG,GAAK3C,EAAE,IAAM,CAAEkC,EAAEC,MAAQQ,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYT,EAAEC,MAAQnC,EAAE,GAAI,CAAEkC,EAAEC,MAAQnC,EAAE,GAAIA,EAAI2C,EAAI,MAC7D,GAAI3C,GAAKkC,EAAEC,MAAQnC,EAAE,GAAI,CAAEkC,EAAEC,MAAQnC,EAAE,GAAIkC,EAAEI,IAAIQ,KAAKH,GAAK,MACvD3C,EAAE,IAAIkC,EAAEI,IAAIO,MAChBX,EAAEG,KAAKQ,MAAO,SAEtBF,EAAKb,EAAKrB,KAAKI,EAASqB,GAC1B,MAAOV,GAAKmB,EAAK,CAAC,EAAGnB,GAAIQ,EAAI,EAjBrB,QAiBoCD,EAAI/B,EAAI,EACtD,GAAY,EAAR2C,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEtB,MAAOsB,EAAG,GAAKA,EAAG,QAAK,EAAQhB,MAAM,GArB9BL,CAAK,CAACnB,EAAGuC,OAoCtD,SAAS00B,EAAatzB,GACzB,IAAIM,EAAQzD,KACZ,OAAO,SAAUsD,EAAOI,EAAUC,GAAyB,OAAO1D,EAAUwD,OAAO,OAAQ,GAAQ,WAC/F,IAAIizB,EAAmBC,EAAav0B,EAAIstB,EAAOK,EAAK6G,EACpD,OAAO11B,EAAYlB,MAAM,SAAU0C,GAC/B,OAAQA,EAAGlB,OACP,KAAK,EAkBD,OAjBAkB,EAAGhB,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACtBu0B,EAAoB,IAAIlT,IACxBmT,EAAc,SAAUzwB,GACG,WAAnBA,EAAK/C,KAAKF,KACVyzB,EAAkBR,IAAIhwB,EAAKrC,MAAMnD,OAGjCwF,EAAKgmB,QAAQyK,IAGrBrzB,EAAMmI,IAAIygB,QAAQyK,GAClBv0B,EAAKkB,EAAMY,UAAWwrB,EAAQttB,EAAGstB,MAAOK,EAAM3tB,EAAG2tB,IACjDzsB,EAAMmI,IAAIwkB,aAAaP,EAAMQ,IAAKH,EAAIG,KAAK,SAAUhqB,EAAMiqB,GAChC,WAAnBjqB,EAAK/C,KAAKF,MACVyzB,EAAkB7C,OAAO3tB,EAAKrC,MAAMnD,UAGrC,CAAC,EAAaiD,EAAsBe,QAAQ6iB,UAAUmP,IACjE,KAAK,EAKD,OAJAE,EAAcl0B,EAAGjB,OACjBiC,EAASJ,EAAMW,GAAG2B,qBAAqBzC,EAAK0C,cAAc,CACtDnF,MAAOk2B,EAAYl2B,UAEhB,CAAC,EAAa,GACzB,KAAK,EAED,OADQgC,EAAGjB,OACJ,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,WClFzB,IAAIo1B,EAAmB,CAC1BnqB,OAAQ,SAAUpJ,EAAO4C,GACrB,IAAIrC,EAAQ,GACRqC,EAAKrC,MAAMnD,QACXmD,EAAMuP,GAAKlN,EAAKrC,MAAMnD,OAE1B,IAAIo2B,EAAkB33B,OAAOiX,KAAKvS,GAC7BiN,KAAI,SAAUU,GAAO,OAAOA,EAAM,KAAQ3N,EAAM2N,GAAO,OACvDgJ,KAAK,KACVlX,EAAMyzB,MAAM,MAAQD,EAAkB,WCN1C53B,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAGrBu3B,EAAgB,CACvBnzB,MAAO,CACHozB,MAAO,CAAEC,QAAS,IAClBtwB,MAAO,CAAEswB,QAAS,KAEtB9iB,MAAO,SACPgd,SAAU,CACN,CACIC,IAAK,OACLC,SAAU,SAAUprB,GAChB,MAAO,CACH+wB,MAAO/wB,EAAKsrB,aAAa,SACzB5qB,MAAOV,EAAKixB,WAAWvwB,MAAQV,EAAKixB,WAAWvwB,MAAMlG,WAAQmE,MAK7E4sB,MAAO,SAAUptB,GACb,MAAO,CACH,OACAnF,EAASA,EAAS,GAAKmF,EAAKR,MAAM+C,MAAQ,CAAEA,MAAOvC,EAAKR,MAAM+C,OAAU,IAAM,CAAEqwB,MAAO5yB,GAAQA,EAAKR,OAASQ,EAAKR,MAAMozB,MAAQ5yB,EAAKR,MAAMozB,MAAQ,KACnJ,KCpCR/3B,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YA2BhC,SAAS23B,EAAiB9zB,EAAOyB,EAAMC,EAAIqyB,GACvC,IAAIt2B,EAUJ,OATIiE,EAAKD,GACLzB,EAAMmI,IAAIwkB,aAAalrB,EAAMC,GAAI,SAAUkB,GACvC,OAAImxB,EAASzH,QAAQ1pB,EAAKtC,SACtB7C,EAASmF,EAAKtC,MAAMoN,MAAK,SAAU/K,GAAK,OAAOA,EAAE9C,OAASk0B,MACnD,MAKZt2B,EASX,SAASu2B,EAAWC,EAAUvzB,GAC1B,OAAO9E,EAASA,EAAS,GAAIq4B,GAAWvzB,GCtDrC,SAASwzB,EAAyBjxB,EAAQmE,EAAW+sB,GACxD,IDuD8BJ,EAAUxzB,ECvDpCQ,EAAOkC,EAAO3C,MAAMozB,cACxB,MAAO,CACH/zB,KAAM,2BAA6ByH,EACnClJ,MAAOi2B,EACPhxB,aAAcC,IAAMC,cAAc,OAAQ,CAAE+D,UAAWA,GAAa+sB,GACpE13B,ODkD0Bs3B,EClDDhzB,EDkDWR,EClDL,CAAEozB,MAAOvsB,GDmDrC,SAAUpH,EAAOI,GACpB,IAAI4H,EAAMhI,EAAMY,UACZqsB,EAAUjlB,EAAIilB,QACdC,EAASllB,EAAIklB,OACjB,GAAI9sB,EACA,GAAI6sB,EACA,GAAI8G,EAASzH,QAAQtsB,EAAMusB,aAAeU,EAAQ3sB,SAAU,CACxD,IAAI8zB,EAlBxB,SAAuBp0B,EAAO+zB,GAC1B,IACI9G,EADMjtB,EAAMY,UACEqsB,QAClB,GAAIA,EACA,OAAQjtB,EAAMusB,aAAeU,EAAQ3sB,SAASoN,MAAK,SAAU/K,GAAK,OAAOA,EAAE9C,OAASk0B,KAcrDM,CAAcr0B,EAAO+zB,GACxC3zB,EAASJ,EAAMW,GAAG0sB,iBAAiB0G,IAC/BK,GACAh0B,EAASJ,EAAMW,GAAG2zB,cAAcP,EAASnyB,OAAOoyB,EAAWI,EAAa7zB,MAAOA,WAInFH,EAASJ,EAAMW,GAAG2zB,cAAcP,EAASnyB,OAAOrB,SAGnD,CAGD,IAFA,IAAIigB,GAAM,EACN7f,EAAKX,EAAMW,GACN1E,EAAI,GAAIukB,GAAOvkB,EAAIixB,EAAO9wB,OAAQH,IAAK,CAC5C,IAAIs4B,EAAQrH,EAAOjxB,GACfmwB,EAAQmI,EAAMnI,MACdK,EAAM8H,EAAM9H,IAChBjM,EAAMxgB,EAAMmI,IAAIqkB,aAAaJ,EAAMQ,IAAKH,EAAIG,IAAKmH,GAErD,IAAK,IAAI5G,EAAK,EAAGG,EAAWJ,EAAQC,EAAKG,EAASlxB,OAAQ+wB,IAAM,CAC5D,IAAIqH,EAAQlH,EAASH,GACjBsH,EAAUD,EAAMpI,MAChBsI,EAAQF,EAAM/H,IAClB,GAAIjM,EAAK,CACL,IAAIhgB,EAAY5E,EAAS,GAAIk4B,EAAiB9zB,EAAOy0B,EAAQ7H,IAAK8H,EAAM9H,IAAKmH,GAAUxzB,OACvFI,EAAGkB,WAAW4yB,EAAQ7H,IAAK8H,EAAM9H,IAAKmH,GACtCpzB,EAAGgB,QAAQ8yB,EAAQ7H,IAAK8H,EAAM9H,IAAKmH,EAASnyB,OAAOoyB,EAAWxzB,EAAWD,UAGzEI,EAAGgB,QAAQ8yB,EAAQ7H,IAAK8H,EAAM9H,IAAKmH,EAASnyB,OAAOrB,IAG3DH,EAASO,EAAG0I,kBAGpB,OAAO,IC5FP5F,UAAW,SAAUzD,GAAS,OAAO,GACrCD,SAAU,SAAUC,GAAS,ODY9B,SAA8BA,EAAOH,EAAMiB,GAC9C,IAAIhC,EAAKkB,EAAMY,UAAWa,EAAO3C,EAAG2C,KAAM2qB,EAAQttB,EAAGstB,MAAO1qB,EAAK5C,EAAG4C,GACpE,OADgF5C,EAAG2F,QAE1E5E,EAAKysB,QAAQtsB,EAAMusB,aAAeH,EAAM9rB,WAG3BN,EAAMusB,aAAeH,EAAM9rB,SAASQ,OAAOA,GAC3C1E,OAAS,EAnBnC,SAA8B+L,EAAK1G,EAAMC,EAAI7B,EAAMiB,GAC/C,IAAI6zB,GAAQ,EASZ,OARIjzB,EAAKD,GACL0G,EAAIwkB,aAAalrB,EAAMC,GAAI,SAAUkB,GAIjC,OAHI/C,EAAKysB,QAAQ1pB,EAAKtC,QAAUsC,EAAKtC,MAAMQ,OAAOA,GAAQ1E,OAAS,IAC/Du4B,GAAQ,IAEJA,KAGTA,EAYIC,CAAqB50B,EAAMmI,IAAK1G,EAAMC,EAAI7B,EAAMiB,GCtBnB+zB,CAAqB70B,EAAOe,GAAM,SAAU+zB,GAAK,OAAOA,EAAEv0B,MAAMozB,QAAUvsB,OCX/G,IAAI2tB,EAAyB,CAChCrB,cAAe,CACXva,KAAM,SAAUnZ,EAAOe,EAAM2B,EAAQqqB,GACjC,IAAIxsB,EAAQ,GACRQ,EAAKR,MAAMozB,QACXpzB,EAAMozB,MAAQ5yB,EAAKR,MAAMozB,OAE7B,IAAIH,EAAkB33B,OAAOiX,KAAKvS,GAC7BiN,KAAI,SAAUU,GAAO,OAAOA,EAAM,KAAQ3N,EAAM2N,GAAO,OACvDgJ,KAAK,KACV,OAAIsc,EAAgBp3B,OAAS,EAClB,SAAWo3B,EAAkB,IAG7B,UAGfwB,MAAO,YC0DXC,EAAyB,IAAIC,OAAO,yKAIpCC,EAAiB,CACjB,CAAC,oCAAqC,2BAA2B,GACjE,CAAC,QAAS,OAAO,GACjB,CAAC,OAAQ,OAAO,GAChB,CAAC,WAAY,KAAK,GAClB,CAAC,eAAgB,SAAS,GAC1B,CACI,IAAID,OAAO,QApFF,CACb,UACA,UACA,QACA,OACA,WACA,aACA,OACA,UACA,SACA,MACA,WACA,KACA,UACA,SACA,MACA,MACA,KACA,KACA,WACA,aACA,SACA,SACA,OACA,QACA,WACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,KACA,OACA,SACA,SACA,KACA,OACA,OACA,OACA,WACA,OACA,MACA,WACA,KACA,WACA,SACA,IACA,QACA,UACA,SACA,UACA,QACA,QACA,KACA,QACA,KACA,QACA,QACA,KACA,QACA,MAqBoChe,KAAK,KAAO,mBAAoB,KAChE,MACA,GAEJ,CAAC,IAAIge,OAAOD,EAAuBzhB,OAAS,SAAU,MAAM,IAEzD,SAAS4hB,EAAWp1B,EAAOq1B,EAAWC,EAASC,GAClD,IAAIt5B,EACAu5B,EACAC,EACAC,EACA9I,EAAM5sB,EAAM21B,OAAON,GAAar1B,EAAM41B,OAAOP,GAC7ChW,EAAMrf,EAAM61B,OAAOR,GAEvB,GAAIr1B,EAAM81B,OAAOT,GAAar1B,EAAM+1B,WAAa,EAC7C,OAAO,EAEX,IAAK/1B,EAAMg2B,GAAGpyB,QAAQqyB,KAClB,OAAO,EAEX,GAAkC,KAA9Bj2B,EAAMwC,IAAI0zB,WAAWtJ,GACrB,OAAO,EAGX,IADA8I,EAAW11B,EAAMwC,IAAI+O,MAAMqb,EAAKvN,GAC3BpjB,EAAI,EAAGA,EAAIk5B,EAAe/4B,SACvB+4B,EAAel5B,GAAG,GAAG0R,KAAK+nB,GADKz5B,KAKvC,GAAIA,IAAMk5B,EAAe/4B,OACrB,OAAO,EAEX,GAAIm5B,EAEA,OAAOJ,EAAel5B,GAAG,GAK7B,GAHAu5B,EAAWH,EAAY,GAGlBF,EAAel5B,GAAG,GAAG0R,KAAK+nB,GAC3B,KAAOF,EAAWF,KACVt1B,EAAM81B,OAAON,GAAYx1B,EAAM+1B,WADZP,IAOvB,GAHA5I,EAAM5sB,EAAM21B,OAAOH,GAAYx1B,EAAM41B,OAAOJ,GAC5CnW,EAAMrf,EAAM61B,OAAOL,GACnBE,EAAW11B,EAAMwC,IAAI+O,MAAMqb,EAAKvN,GAC5B8V,EAAel5B,GAAG,GAAG0R,KAAK+nB,GAAW,CACb,IAApBA,EAASt5B,QACTo5B,IAEJ,MAIZ,IAAI1a,EAAU9a,EAAMm2B,SAASd,EAAWG,EAAUx1B,EAAM+1B,WAAW,GAE/DhI,GADM,IAAIqI,WAAYC,gBAAgBvb,EAAS,aACrCjd,KAAKy4B,WACfC,EAAsB,MAAPxI,EAAc,GAAKA,EAAIyI,UAW1C,OAVAx2B,EAAMy2B,KAAOjB,GACbC,EAAQz1B,EAAMnB,KAAK,kBAAmB,GAAI,IACpC63B,KAAO,CAAE3I,IAAKA,EAAI4I,QAASp2B,MAAOuwB,MAAMrvB,KAAKssB,EAAI8F,aACvD4B,EAAMjoB,IAAM,CAAC6nB,EAAWr1B,EAAMy2B,OAC9BhB,EAAQz1B,EAAMnB,KAAK,SAAU,GAAI,IAC3B2O,IAAM,CAAC6nB,EAAWG,GACxBC,EAAM3a,QAAUyb,EAChBd,EAAMlnB,SAAW,IACjBknB,EAAQz1B,EAAMnB,KAAK,mBAAoB,IAAK,IACtC63B,KAAO,CAAE3I,IAAKA,EAAI4I,UACjB,EC1JJ,SAASC,EAAiB52B,EAAOu1B,GACpC,IAAI3I,EAAM5sB,EAAM4sB,IAChB,GAAsC,UAAlC5sB,EAAMwC,IAAI+O,MAAMqb,EAAKA,EAAM,GAC3B,OAAO,EAEX,IAAK2I,EAAQ,CACT,IAAIza,EAAU9a,EAAMwC,IAAI+O,MAAMqb,EAAKA,EAAM,GACrC6I,EAAQz1B,EAAMnB,KAAK,cAAe,MAAO,GAC7C42B,EAAMl1B,MAAQ,GACdk1B,EAAM3a,QAAUA,EAGpB,OADA9a,EAAM4sB,IAAMA,EAAM,GACX,ECZJ,IAAIiK,EAAc,CACrB/lB,MAAO,SACPoiB,QAAQ,EACRpF,SAAU,CACN,CACIC,IAAK,iBACLC,SAAU,SAAUC,GAChB,MAAO,MAInBE,MAAO,SAAUvrB,GACb,MAAO,CAAC,OAAQ,CAAE,YAAY,GAAQ,O,SCbvC,IAAIk0B,EAAuB,CAC9BD,YAAa,SAAU72B,EAAO4C,GAC1B5C,EAAMyzB,MAAM,WCFhB73B,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAM5BgqB,EAAWpnB,EAAQ,IAEnBg4B,EAAah4B,EAAQ,KAErBi4B,EAAkBj4B,EAAQ,KAAqBi4B,gBAC5C,SAASC,EAAqBh0B,EAAQW,GACzC,IAAIoyB,EAAKe,EAAW,aAAc,CAC9Bd,MAAM,EACNiB,SAAS,IAEblB,EAAGmB,IAAIH,GACPhB,EAAG9C,OAAOkE,MAAMC,OAAO,OAAQ,cAAeT,GAC9CZ,EAAGsB,MAAMF,MAAMC,OAAO,aAAc,aAAcjC,GAGlD,IAAImC,EAAS,IAAIpR,EAASqR,eAAev0B,EAAQ+yB,EAAIp6B,EAASA,EAAS,GAAIuqB,EAASsR,sBAAsBC,QAAS,CAAEnzB,KAAM,CACnHxD,KAAM,OACNitB,SAAU,SAAU2J,GAAO,MAAQ,CAC/B32B,KAAM22B,EAAIC,QAAQ,QAClB32B,MAAO02B,EAAIC,QAAQ,UAAY,KAC/Bz2B,OAAQw2B,EAAIC,QAAQ,WAAa,KACjCp2B,IAAKm2B,EAAIC,QAAQ,QAAU,QAEhCxuB,OAAQ,CACPxG,KAAM,SACNorB,SAAU,SAAU2J,GAAO,MAAQ,CAC/Bv6B,MAAOu6B,EAAIC,QAAQ,YAExBC,MAAO,CACNP,MAAO,aACPtJ,SAAU,SAAU2J,GAAO,MAAQ,CAAE51B,OAAQ41B,EAAI/U,MAAQ,KACzDkV,cAAc,GACfjB,YAAa,CAAEj0B,KAAM,eAAiByF,MAAO,CAAEivB,MAAO,SAAWS,GAAI,CACpET,MAAO,eACPtJ,SAAU,SAAU2J,GAAO,MAAQ,CAC/Br0B,MAAOq0B,EAAIC,QAAQ,YAExBj3B,GAAI,CAAE22B,MAAO,aAAeU,GAAI,CAC/BV,MAAO,aACPtJ,SAAU,SAAU2J,GAAO,MAAQ,CAC/Br0B,MAAOq0B,EAAIC,QAAQ,eAG3BK,EAAoBV,EAAOW,cAAc9yB,UAC7CmyB,EAAOW,cAAc9yB,UAAY,SAAUpF,EAAOy1B,EAAOiC,EAAQz7B,GACzDw5B,EAAM3a,SAAW,aAAanN,KAAK8nB,EAAM3a,WACzC2a,EAAM3a,QAAU2a,EAAM3a,QAAQqd,QAAQ,cAAe,SAEzDF,EAAkBj4B,EAAOy1B,EAAOiC,EAAQz7B,IAE5Cs7B,EAAOW,cAAcE,YAAc,SAAUp4B,EAAOy1B,GAChD,GAAKA,GAAUA,EAAM3a,QAArB,CAGA,IAAIA,GAAW2a,EAAM3a,SAAW,IAAI9C,OACpC,GAAI8C,EAAQyC,WAAW,UAAYzC,EAAQud,SAAS,KAAM,CAGtD,KADItK,GADM,IAAIqI,WAAYC,gBAAgBZ,EAAM3a,QAAS,aAC3Cjd,KAAKy4B,YAEf,OAEJ,GAAmC,SAA/BvI,EAAIuK,SAASC,cAA0B,CACvC,IAAInxB,EAAY2mB,EAAIG,aAAa,SACjCluB,EAAMw4B,SAASv1B,EAAO3C,MAAMozB,cAAc9xB,OAAO,CAC7C+xB,MAAOvsB,WAId,GAAgB,YAAZ0T,EACL9a,EAAMy4B,UAAUx1B,EAAO3C,MAAMozB,oBAE5B,GAAI5Y,EAAQyC,WAAW,OAASzC,EAAQud,SAAS,KAAM,CACxD,IACItK,EACJ,KADIA,GADM,IAAIqI,WAAYC,gBAAgBZ,EAAM3a,QAAS,aAC3Cjd,KAAKy4B,YAEf,OAEJ,GAAmC,MAA/BvI,EAAIuK,SAASC,cAAuB,CACpC,IAAIzoB,EAAKie,EAAIG,aAAa,MACtBltB,EAAO+sB,EAAIG,aAAa,QACxBjtB,EAAQ8sB,EAAIG,aAAa,SACzB/sB,EAAS4sB,EAAIG,aAAa,UAC1B1sB,EAAMusB,EAAIG,aAAa,OACjB,MAANpe,EACA9P,EAAM04B,QAAQz1B,EAAOO,MAAM4F,OAAQ,CAC/BhM,MAAO0S,IAGN9O,GACLhB,EAAMw4B,SAASv1B,EAAO3C,MAAMiE,KAAK3C,OAAO,CACpCZ,KAAMA,EACNC,MAAOA,GAAS,KAChBE,OAAQA,GAAU,KAClBK,IAAKA,GAAO,cAKvB,GAAgB,SAAZsZ,EACL9a,EAAMy4B,UAAUx1B,EAAO3C,MAAMiE,WAE5B,GAAgB,SAAZuW,EACL9a,EAAM04B,QAAQz1B,EAAOO,MAAMm1B,gBAE1B,CACD,IACIC,EADOnD,EAAM3a,QACI+d,MAAM,uCAC3B,GAAID,EAAW,CACX,IAAIr4B,EAAQq4B,EAAU,GAClBE,EAAYF,EAAU,GACtBG,EAAYx4B,EAAMs4B,MAAM,kBACxBG,EAAaz4B,EAAMs4B,MAAM,mBACzBI,EAAc14B,EAAMs4B,MAAM,oBAC1BK,EAAW34B,EAAMs4B,MAAM,iBAC3B,GAAIE,EAAW,CACX,IAAIh4B,EAAOkC,EAAO3C,MAAMiE,KAAK3C,OAAO,CAChCZ,KAAM+3B,EAAU,GAChB93B,MAAO+3B,EAAaA,EAAW,GAAK,KACpC73B,OAAQ83B,EAAcA,EAAY,GAAK,KACvCz3B,IAAK03B,EAAWA,EAAS,GAAK,OAElCl5B,EAAMw4B,SAASz3B,GACff,EAAMm5B,QAAQL,GACd94B,EAAMy4B,UAAU13B,QAKhC,IAAIq4B,EAAwB,IAAIC,IAAI,CAChC,CAAC,IAAK,aACN,CAAC,KAAM,WACP,CAAC,KAAM,WACP,CAAC,KAAM,WACP,CAAC,KAAM,WACP,CAAC,KAAM,WACP,CAAC,KAAM,aAEPC,EAAmB,IAAID,IAAI,CAC3B,CAAC,iBAAkB,QACnB,CAAC,mBAAoB,UACrB,CAAC,kBAAmB,SACpB,CAAC,oBAAqB,aAkC1B,OA/BA9B,EAAOW,cAAcqB,gBAAkB,SAAUv5B,EAAOy1B,GACpD,GAAK2D,EAAsB5Y,IAAIiV,EAAMiB,KAAK3I,KAA1C,CAGA,IAAIyL,EAAY/D,EAAMiB,KAAKn2B,MAAMmN,MAAK,SAAU+rB,GAAQ,MAAqB,UAAdA,EAAK95B,QAChE+5B,EAAY,OACZF,IACAE,EACIF,EAAUG,aAAar2B,MAAM2N,WAAayoB,GAElD,IAAIE,EAAYnE,EAAMiB,KAAKn2B,MAAMmN,MAAK,SAAU+rB,GAAQ,MAAqB,UAAdA,EAAK95B,QAChEi6B,GAEAA,EAAUD,aAAaE,UAAUjR,SAAQ,SAAUxrB,GAC/C,IAAI08B,EAAY9N,0BAAgB5uB,EAAOwG,GACvC81B,EAAYJ,EAAiB/iB,IAAIujB,IAAc,UAGvD,IAAIC,EAAWX,EAAsB7iB,IAAIkf,EAAMiB,KAAK3I,KAChD7qB,EAAqB,YAAb62B,EAAyBrL,OAAO+G,EAAMiB,KAAK3I,IAAI,SAAMxsB,EACjEvB,EAAMg6B,SAAS/2B,EAAOO,MAAMu2B,GAAW,CACnCj3B,MAAO42B,GAAwB,OAC/Bx2B,MAAOA,MAIfq0B,EAAOW,cAAc+B,iBAAmB,SAAUj6B,EAAOy1B,GACjD2D,EAAsB5Y,IAAIiV,EAAMiB,KAAK3I,MACrC/tB,EAAMk6B,aAGP3C,EC5LJ,IAAI4C,EAAkB,CACzBrf,QAAS,UACTva,MAAO,CACHuC,MAAO,CAAE8wB,QAAS,SAEtB9iB,MAAO,QACPgd,SAAU,CACN,CACIC,IAAK,IACLC,SAAU,SAAUC,GAChB,MAAO,CAAEnrB,MAAOmrB,EAAI3qB,MAAM2N,cAItCkd,MAAO,SAAUvrB,GACb,MAAO,CAAC,IAAK,CAAEU,MAAO,gBAAkBV,EAAKrC,MAAMuC,OAAS,SAAW,KAG/E,SAASs3B,EAAgBl3B,GACrB,OAAO,SAAkB+qB,GACrB,MAAO,CAAEnrB,MAAOmrB,EAAI3qB,MAAM2N,UAAW/N,MAAOA,IAI7C,IAAIm3B,EAAgB,CACvB95B,MAAO,CACH2C,MAAO,CAAE0wB,QAAS,GAClB9wB,MAAO,CAAE8wB,QAAS,SAEtB9Y,QAAS,UACThK,MAAO,QACP6c,UAAU,EACVG,SAAU,CACN,CAAEC,IAAK,KAAMC,SAAUoM,EAAgB,IACvC,CAAErM,IAAK,KAAMC,SAAUoM,EAAgB,IACvC,CAAErM,IAAK,KAAMC,SAAUoM,EAAgB,IACvC,CAAErM,IAAK,KAAMC,SAAUoM,EAAgB,IACvC,CAAErM,IAAK,KAAMC,SAAUoM,EAAgB,IACvC,CAAErM,IAAK,KAAMC,SAAUoM,EAAgB,KAE3CjM,MAAO,SAAUvrB,GACb,MAAO,CACH,IAAMA,EAAKrC,MAAM2C,MACjB,CAAEI,MAAO,gBAAkBV,EAAKrC,MAAMuC,OAAS,SAC/C,KChCL,IAAIw3B,EAAkB,CACzBjyB,MAAO,SAAUrI,EAAO4C,GAEpB,IADA,IAAI23B,EAAO,GACFt+B,EAAI,EAAGA,EAAI2G,EAAK43B,WAAYv+B,IAAK,CACtC,IAAIgW,EAAQrP,EAAK63B,WAAWx+B,GACf,MAATgW,GAAqC,cAApBA,EAAMpS,KAAKF,MAC5B46B,EAAK17B,KAAKoT,GAGlB,GAAoB,IAAhBsoB,EAAKn+B,OAAT,CAIA4D,EAAMgrB,OAAOuP,EAAK,IAClB,IAAIG,EAAcH,EAAK,GAAGC,WAE1Bx6B,EAAMyzB,MAAM,MACZ,IAASx3B,EAAI,EAAGA,EAAIy+B,EAAaz+B,IAC7B+D,EAAMyzB,MAAM,eAEhBzzB,EAAMyzB,MAAM,KAEZ,IAASx3B,EAAI,EAAGA,EAAIs+B,EAAKn+B,OAAQH,IAC7B+D,EAAMyzB,MAAM,MACZzzB,EAAMgrB,OAAOuP,EAAKt+B,IAEtB+D,EAAM26B,WAAW/3B,KAErBg4B,UAAW,SAAU56B,EAAO4C,GACxB5C,EAAMyzB,MAAM,MAYZ,IAXA,IAAIoH,EAAU,SAAU5+B,GACpB,IAAIgW,EAAQrP,EAAK63B,WAAWx+B,GACf,MAATgW,IACIhW,EAAI,GACJ+D,EAAMyzB,MAAM,OAzChC,SAA0BzzB,EAAOkjB,GAC7B,IAAI2J,EAAQ7sB,EAAM86B,IAAI1+B,OACtB8mB,IACAljB,EAAM86B,IACF96B,EAAM86B,IAAIC,OAAO,EAAGlO,GAA6B7sB,EAAM86B,IAAIC,OAAOlO,GARjEmO,UACA7C,QAAQ,SAAU,QAClB8C,OALa,EAKW,KAO7Bj7B,EAAMk7B,QAAS,EAsCHC,CAAiBn7B,GAAO,WACpBA,EAAMo7B,aAAanpB,QAItBhW,EAAI,EAAGA,EAAI2G,EAAK43B,WAAYv+B,IACjC4+B,EAAQ5+B,GAEZ+D,EAAMyzB,MAAM,OAEhB4H,WAAY,SAAUr7B,EAAO4C,GACzB5C,EAAMo7B,aAAax4B,IAEvB04B,aAAc,SAAUt7B,EAAO4C,GAC3B5C,EAAMo7B,aAAax4B,KChEvBhH,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAQ5BgqB,EAAWpnB,EAAQ,IAWvB,IAAIw8B,EAAiB,CACjBC,KAAM,SAAUx7B,EAAO4C,GACnB5C,EAAMw7B,KAZd,SAAgBA,GACZ,OAAOA,EACFrD,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QAQJsD,CAAO74B,EAAK44B,SAGxB,SAASE,EAAyB93B,EAAS+3B,QAC1B,IAAhBA,IAA0BA,EAAc,IAC5C,IAAIC,EAA4B,IAAIzV,EAAS0V,mBAAmBjgC,EAASA,EAASA,EAASA,EAASA,EAASA,EAASA,EAASA,EAAS,GAAIuqB,EAASyV,0BAA0Bp4B,OAAQszB,GAAuBvD,GAAmB+G,GFe7L,SAAU12B,GAAW,MAAQ,CACjEwB,UAAW,SAAUpF,EAAO4C,GACpBA,EAAKrC,MAAMuC,OACU,SAArBF,EAAKrC,MAAMuC,OACU,UAArBF,EAAKrC,MAAMuC,OAGPc,EAAQikB,WACR7nB,EAAMyzB,MAAM,aAAgB5H,yBAAe,aAAejpB,EAAKrC,MAAMuC,MAAOc,GAAW,MAGvF5D,EAAMyzB,MAAM,yBAA4B7wB,EAAKrC,MAAMuC,MAAQ,MAE/D9C,EAAMo7B,aAAax4B,GACnB5C,EAAMyzB,MAAM,QACZzzB,EAAM26B,WAAW/3B,KAGjB5C,EAAMo7B,aAAax4B,GACnB5C,EAAM26B,WAAW/3B,MElC0Nk5B,CAA2Bl4B,IFsC7O,SAAUA,GAAW,MAAQ,CAC9DZ,QAAS,SAAUhD,EAAO4C,GAClBA,EAAKrC,MAAMuC,OACU,SAArBF,EAAKrC,MAAMuC,OACU,UAArBF,EAAKrC,MAAMuC,OAGPc,EAAQikB,WACR7nB,EAAMyzB,MAAM,KAAO7wB,EAAKrC,MAAM2C,MAAQ,WAAc2oB,yBAAe,aAAejpB,EAAKrC,MAAMuC,MAAOc,GAAW,MAG/G5D,EAAMyzB,MAAM,KAAO7wB,EAAKrC,MAAM2C,MAAQ,uBAA0BN,EAAKrC,MAAMuC,MAAQ,MAEvF9C,EAAMo7B,aAAax4B,GACnB5C,EAAMyzB,MAAM,MAAQ7wB,EAAKrC,MAAM2C,MAAQ,KACvClD,EAAM26B,WAAW/3B,KAGjB5C,EAAMyzB,MAAMzzB,EAAM+7B,OAAO,IAAKn5B,EAAKrC,MAAM2C,OAAS,KAClDlD,EAAMo7B,aAAax4B,GACnB5C,EAAM26B,WAAW/3B,ME1DgQo5B,CAAwBp4B,IAAW23B,GAAiBI,GAAc//B,EAASA,EAAS,GAAIuqB,EAASyV,0BAA0Bt7B,OAAQy0B,IAC5Z6G,EAA0Bt7B,MAAMiE,KAAO,CACnC4U,KAAM,SAAUnZ,GAGZ,OAFAA,EAAMyzB,MAAM,KACZzzB,EAAMi8B,UAAYj8B,EAAM86B,IAAI1+B,OAAS,EAC9B,IAEX44B,MAAO,SAAUh1B,EAAOe,GACpB,IAAIjC,EAAKiC,EAAKR,MAAOS,EAAOlC,EAAGkC,KAAMC,EAAQnC,EAAGmC,MAAOE,EAASrC,EAAGqC,OAAQK,EAAM1C,EAAG0C,IAChF06B,EAAuC,kBAApBl8B,EAAMi8B,UACvBj8B,EAAMi8B,UACNj8B,EAAM86B,IAAIqB,YAAY,KACxBC,EAAWp8B,EAAM86B,IAAIvpB,MAAM2qB,EAAY,GAE3C,OADAl8B,EAAM86B,IAAM96B,EAAM86B,IAAIvpB,MAAM,EAAG2qB,GAC3B/6B,GAAUK,EAEH,YAAeR,EAAO,KAAQC,EAAQ,WAAcA,EAAQ,IAAO,KAAOE,EAAS,YAAeA,EAAS,IAAO,KAD3GK,EAAM,SAAYA,EAAM,IAAO,IAC4F,IAAM46B,EAAW,OAEvJ,IAAMA,EAAW,KAAOp7B,GAAQC,EAAQ,KAAQA,EAAQ,IAAO,IAAM,MAGpF,IAAIo7B,EAAoBT,EAA0BzU,UAKlD,OAJAyU,EAA0BzU,UAAY,SAAUhf,GAC5C,IAAIm0B,EAASD,EAAkB7/B,KAAKE,KAAMyL,GAC1C,OAA4Bm0B,EAlCVnE,QAAQ,WAAY,SACxBA,QAAQ,sDAAsD,SAAUoE,EAAIC,GAAM,MAAe,QAAPA,EAAe,MAAQ,WAmC5HZ,ECtDX,IAAIa,EAAa19B,EAAQ,IAAsB09B,WAE3CC,EAAS39B,EAAQ,GAAqB29B,O,qECJtC/N,GAAW5vB,EAAQ,GAAqB4vB,SAC5C,SAASgO,GAAQ38B,GAEb,IADA,IAAI48B,EAAO58B,EAAMY,UAAUi8B,MAAMD,KACxB3gC,EAAI,EAAGA,EAAI2gC,EAAKxgC,OAAQH,GAAK,EAClC,GAA0B,UAAtB2gC,EAAK3gC,GAAG4D,KAAKF,KACb,OAAO,EAGf,OAAO,EAEX,SAASm9B,GAAkB98B,EAAOH,GAC9B,OAAOA,EAAK+B,YAAOL,EAAWotB,GAASoO,UAAU,CAC7C/8B,EAAMiD,OAAOO,MAAM4B,UAAUxD,YAGrC,SAASo7B,GAAYh9B,EAAOI,GACxB,IAAIO,EAAKX,EAAMW,GAAG2B,qBAAqBtC,EAAMiD,OAAOO,MAAM6E,MAAMzG,YAAOL,EAAWotB,GAASoO,UAAU,CACjG/8B,EAAMiD,OAAOO,MAAMo3B,UAAUh5B,YAAOL,EAAWotB,GAASoO,UAAU,CAC9DD,GAAkB98B,EAAOA,EAAMiD,OAAOO,MAAM83B,cAC5CwB,GAAkB98B,EAAOA,EAAMiD,OAAOO,MAAM83B,iBAEhDt7B,EAAMiD,OAAOO,MAAMo3B,UAAUh5B,YAAOL,EAAWotB,GAASoO,UAAU,CAC9DD,GAAkB98B,EAAOA,EAAMiD,OAAOO,MAAM63B,YAC5CyB,GAAkB98B,EAAOA,EAAMiD,OAAOO,MAAM63B,mBAMpD,OAHIj7B,GACAA,EAASO,IAEN,EClCX,IAAIs8B,GAAkD,WAClD,IAAK,IAAIjhC,EAAI,EAAGC,EAAI,EAAGihC,EAAK/gC,UAAUC,OAAQH,EAAIihC,EAAIjhC,IAAKD,GAAKG,UAAUF,GAAGG,OACxE,IAAI8T,EAAI4gB,MAAM90B,GAAImhC,EAAI,EAA3B,IAA8BlhC,EAAI,EAAGA,EAAIihC,EAAIjhC,IACzC,IAAK,IAAIoW,EAAIlW,UAAUF,GAAImhC,EAAI,EAAGC,EAAKhrB,EAAEjW,OAAQghC,EAAIC,EAAID,IAAKD,IAC1DjtB,EAAEitB,GAAK9qB,EAAE+qB,GACjB,OAAOltB,GAWJ,SAASotB,GAAoBr6B,EAAQW,GACxC,IAAIC,EAAQ,GA2CZ,OA1CIC,wBAAc,gBAAiBF,KAC/BC,EAAQA,EAAM05B,OAAO15B,EZLtB,SAAiCZ,EAAQW,GAC5C,IAAIC,EAAQ,GACZ,GAAIZ,EAAO3C,MAAMozB,eAAiB5vB,wBAAc,gBAAiBF,IAAYA,EAAQC,OAASD,EAAQC,MAAM6vB,cAAe,CACvH,IAAI8J,EAAsB55B,EAAQC,MAAM6vB,cACxC,GAAI8J,EAAoBC,WACpB,IAAK,IAAItQ,EAAK,EAAGruB,EAAK0+B,EAAoBC,WAAYtQ,EAAKruB,EAAG1C,OAAQ+wB,IAAM,CACxE,IAAI/lB,EAAYtI,EAAGquB,GACnBtpB,EAAMhF,KAAKq1B,EAAyBjxB,EAAQmE,EAAUA,UAAWA,EAAUlJ,SAIvF,OAAO2F,EYNyB65B,CAAwBz6B,EAAQW,KAE5DE,wBAAc,SAAUF,IAAYX,EAAOO,MAAM4F,QACjDvF,EAAMhF,KhBiBP,SAAoBoE,GACvB,MAAO,CACHtD,KAAM,SACNzB,MAAO,gBACP4B,YAAasD,IAAMC,cAAcs6B,IAAY,MAC7ClhC,MAAO02B,EAAalwB,EAAOO,MAAM4F,QACjC3F,UAAW,SAAUzD,GAAS,OAAO0F,oBAAU1F,EAAOiD,EAAOO,MAAM4F,UgBvBxDw0B,CAAW36B,IAEtBa,wBAAc,cAAeF,IAAYX,EAAOO,MAAMqzB,aACtDhzB,EAAMhF,KCtBP,SAAwBoE,GAC3B,MAAO,CACHtD,KAAM,cACNzB,MAAO,qBACP4B,YAAasD,IAAMC,cAAcw6B,IAAQ,MACzCphC,MAAO,SAAUuD,EAAOI,GACpBA,EAASJ,EAAMW,GAAG2B,qBAAqBW,EAAOO,MAAMqzB,YAAYj1B,YAEpE6B,UAAW,SAAUzD,GAAS,OAAO0F,oBAAU1F,EAAOiD,EAAOO,MAAMqzB,eDcxDiH,CAAe76B,IAG1Ba,wBAAc,aAAcF,IAC5BC,EAAMhF,KlB2BH,CACHc,KAAM,aACNzB,MAAO,aACP4B,YAAasD,IAAMC,cAAc06B,IAAiB,MAClDthC,MAAO,SAAUuD,EAAOI,GAAY,OAAO0C,EAAM9C,EAAOI,EAAU,SAClEL,SAAU,SAAUC,EAAO0D,GAAQ,OAAOqvB,EAAY/yB,EAAO0D,EAAM,SACnEiB,UAAWsuB,IkB/BXnvB,wBAAc,eAAgBF,IAC9BC,EAAMhF,KlBkCH,CACHc,KAAM,eACNzB,MAAO,eACP4B,YAAasD,IAAMC,cAAc26B,IAAmB,MACpDvhC,MAAO,SAAUuD,EAAOI,GAAY,OAAO0C,EAAM9C,EAAOI,EAAU,WAClEL,SAAU,SAAUC,EAAO0D,GAAQ,OAAOqvB,EAAY/yB,EAAO0D,EAAM,WACnEiB,UAAWsuB,IkBtCXnvB,wBAAc,cAAeF,IAC7BC,EAAMhF,KlByCH,CACHc,KAAM,cACNzB,MAAO,cACP4B,YAAasD,IAAMC,cAAc46B,IAAkB,MACnDxhC,MAAO,SAAUuD,EAAOI,GAAY,OAAO0C,EAAM9C,EAAOI,EAAU,UAClEL,SAAU,SAAUC,EAAO0D,GAAQ,OAAOqvB,EAAY/yB,EAAO0D,EAAM,UACnEiB,UAAWsuB,IkB7CXnvB,wBAAc,gBAAiBF,IAC/BC,EAAMhF,KlBgDH,CACHc,KAAM,gBACNzB,MAAO,gBACP4B,YAAasD,IAAMC,cAAc66B,IAAoB,MACrDzhC,MAAO,SAAUuD,EAAOI,GAAY,OAAO0C,EAAM9C,EAAOI,EAAU,YAClEL,SAAU,SAAUC,EAAO0D,GAAQ,OAAOqvB,EAAY/yB,EAAO0D,EAAM,YACnEiB,UAAWsuB,IkBpDXhwB,EAAOO,MAAM6E,QACTvE,wBAAc,eAAgBF,IAC9BC,EAAMhF,KDNX,SAAyBoE,GAC5B,MAAO,CACHtD,KAAM,eACNzB,MAAO,eACP4B,YAAasD,IAAMC,cAAc86B,IAAY,MAC7C1hC,MAAOugC,GACPv5B,UAAW,SAAUzD,GAAS,OAAO0F,oBAAU1F,EAAOiD,EAAOO,MAAM6E,QACnE1D,UAAW,SAAU3E,GAAS,OAAQ28B,GAAQ38B,KCD/Bo+B,CAAgBn7B,IAE3Ba,wBAAc,eAAgBF,IAC9BC,EAAMhF,KDsCP,CACHc,KAAM,eACNzB,MAAO,eACP4B,YAAasD,IAAMC,cAAcg7B,KAAa,MAC9C5hC,MAAO6hC,eACP35B,UAAW,SAAU3E,GAAS,OAAO28B,GAAQ38B,MCzCzC8D,wBAAc,gBAAiBF,IAC/BC,EAAMhF,KDDP,CACHc,KAAM,gBACNzB,MAAO,UACP4B,YAAasD,IAAMC,cAAck7B,IAAqB,MACtD9hC,MAAO+hC,eACP75B,UAAW,SAAU3E,GAAS,OAAO28B,GAAQ38B,MCFzC8D,wBAAc,gBAAiBF,IAC/BC,EAAMhF,KDKP,CACHc,KAAM,gBACNzB,MAAO,aACP4B,YAAasD,IAAMC,cAAco7B,IAAU,MAC3ChiC,MAAOiiC,kBACP/5B,UAAW,SAAU3E,GAAS,OAAO28B,GAAQ38B,MCRzC8D,wBAAc,mBAAoBF,IAClCC,EAAMhF,KDWP,CACHc,KAAM,mBACNzB,MAAO,aACP4B,YAAasD,IAAMC,cAAcs7B,IAAkB,MACnDliC,MAAOmiC,aACPj6B,UAAW,SAAU3E,GAAS,OAAO28B,GAAQ38B,MCdzC8D,wBAAc,mBAAoBF,IAClCC,EAAMhF,KDiBP,CACHc,KAAM,mBACNzB,MAAO,gBACP4B,YAAasD,IAAMC,cAAcw7B,KAAW,MAC5CpiC,MAAOqiC,gBACPn6B,UAAW,SAAU3E,GAAS,OAAO28B,GAAQ38B,OCnB1C6D,EAEX,IA+CeuiB,GA/CuB,WAClC,SAASA,EAAiBxiB,QACN,IAAZA,IAAsBA,EAAU,IACpClH,KAAKiD,KAAO,WACZjD,KAAKwB,MAAQ,WACb,IAAI+E,EAASvG,KAAKqiC,aAAan7B,GAC3BC,EAAQo5B,GAAet5B,8BAAoBV,EAAQW,GAAU05B,GAAoBr6B,EAAQW,IACzFo7B,EAAatD,EAAyB93B,EAASlH,KAAKuiC,sBACpD1H,EAASN,EAAqBh0B,EAAQW,GAC1ClH,KAAKuG,OAASA,EACdvG,KAAKmH,MAAQA,EACbnH,KAAKsiC,WAAaA,EAClBtiC,KAAK66B,OAASA,EAiClB,OA/BAnR,EAAiB9pB,UAAU6qB,UAAY,SAAUhf,GAC7C,OAAOzL,KAAKshB,kBAAkB7V,IAElCie,EAAiB9pB,UAAUqe,MAAQ,SAAUH,GACzC,OAAO9d,KAAKuiB,cAAczE,IAE9B4L,EAAiB9pB,UAAU0hB,kBAAoB,SAAU7V,GACrD,OAAOzL,KAAKsiC,WAAW7X,UAAUhf,IAErCie,EAAiB9pB,UAAU4iC,2BAA6B,SAAUj8B,EAAQL,GACtE,QAAKA,EAAK/C,MAIqC,MAApCnD,KAAKsiC,WAAWx7B,MAAMZ,EAAK/C,OAG1CumB,EAAiB9pB,UAAU2iB,cAAgB,SAAUzE,GAIjD,OAHKA,IACDA,EAAO,IAEJ9d,KAAK66B,OAAO5c,MAAMH,IAE7B4L,EAAiB9pB,UAAU2iC,mBAAqB,WAC5C,MAAO,IAEX7Y,EAAiB9pB,UAAUyiC,aAAe,SAAUn7B,GAGhD,YAFgB,IAAZA,IAAsBA,EAAU,IF7FrC,SAAsBA,EAASu7B,QACJ,IAA1BA,IAAoCA,GAAwB,GAChE,IAAIl8B,EAASlE,EAAQ,IAAwBkE,OAEzC3C,EAAQ2C,EAAOm8B,KAAK9+B,MAAM++B,OAAO,OAAQ,CACzC9+B,MAAO,CACHS,KAAM,GACNC,MAAO,CAAE2yB,QAAS,MAClBzyB,OAAQ,CAAEyyB,QAAS,MACnBpyB,IAAK,CAAEoyB,QAAS,OAEpB0L,WAAW,EACXxR,SAAU,CACN,CACIC,IAAK,UACLC,SAAU,SAAUC,GAChB,MAAO,CACHjtB,KAAMitB,EAAIC,aAAa,QACvBjtB,MAAOgtB,EAAIC,aAAa,SACxB/sB,OAAQ8sB,EAAIC,aAAa,UACzB1sB,IAAKysB,EAAIC,aAAa,WAKtCC,MAAO,SAAUvrB,GACb,IAAI9D,EAAK8D,EAAKrC,MACd,MAAO,CAAC,IAAK,CAAES,KADalC,EAAGkC,KACJC,MADkBnC,EAAGmC,MACPE,OADuBrC,EAAGqC,OACVK,IADwB1C,EAAG0C,KACf,MAGzE29B,IACA7+B,EAAQA,EAAMi/B,SAAS,gBAAiB7L,IAE5C,IAAIlwB,EAAQP,EAAOm8B,KAAK57B,MACnBg8B,OAAO/C,EAAW,CACnBgD,WAAY,QACZC,YAAa,QACbC,eAAgB,CACZh1B,WAAY,CACRipB,QAAS,KAETgM,WAAY,SAAU3R,GAClB,OAAOA,EAAI3qB,MAAMmD,iBAAmB,MAGxCo5B,WAAY,SAAUziC,EAAOmD,GACrBnD,IACAmD,EAAM+C,OACD/C,EAAM+C,OAAS,IAAO,qBAAuBlG,EAAQ,WAMzEmiC,SAAS,cAAe1I,GACxB0I,SAAS,SAAUn2B,GACnBi2B,OAAO,YAAalF,GACpBkF,OAAO,UAAWhF,GACvB,OAAO,IAAIqC,EAAO,CACdl5B,MAAOA,EACPlD,MAAOA,IEmCAy+B,CAAan7B,EADQE,wBAAc,gBAAiBF,KAGxDwiB,EA7C2B,GE1DvBrgB,GAHJ,CACP2gB,OAAQ/qB,qBAAmBmkC,MCAhB,aAAUl8B,GACrB,MAAO,CACHiC,SAAU,IAAIugB,GAAiBxiB,GAC/BmC,KAAMg6B,M,gCCJChhC,EAAQ,IAEZA,EAAQ,GAAqBihC,KAFxC,IAGIC,EAAkC,WAClC,SAASA,KA4BT,OA1BAA,EAAiB3jC,UAAU4jC,aAAe,SAAUj9B,EAAQL,GACxD,MAAqB,kBAAdA,EAAK/C,MAEhBogC,EAAiB3jC,UAAU6qB,UAAY,SAAUlkB,EAAQO,GACrD,OAAOA,EAAMgK,KAAI,SAAU5K,GACvB,MAAO,CACH/C,KAAM,gBACN2a,KAAM5X,EAAKrC,MAAMnD,WAI7B6iC,EAAiB3jC,UAAU6jC,SAAW,SAAUl9B,EAAQq0B,GACpD,MAAsB,kBAAfA,EAAMz3B,MAEjBogC,EAAiB3jC,UAAUqe,MAAQ,SAAU1X,EAAQm9B,GACjD,IAAI3iC,EAAS,GASb,OARA2iC,EAAOxX,SAAQ,SAAU0O,GACrB75B,EAAOoB,KAAK,CACRgB,KAAM,gBACNU,MAAO,CACHnD,MAAOk6B,EAAM9c,WAIlB/c,GAEJwiC,EA7B2B,GA+BvBA,O,gCClCf,IAAID,EAAOjhC,EAAQ,GAAqBihC,KACpCK,EAA+B,WAC/B,SAASA,EAAcz8B,EAAS08B,GAC5B5jC,KAAKkH,QAAUA,EACflH,KAAK4jC,iBAAmBA,EA+B5B,OA7BAD,EAAc/jC,UAAU4jC,aAAe,SAAUj9B,EAAQL,GACrD,OAAOlG,KAAK4jC,iBAAiBpB,2BAA2Bj8B,EAAQL,IAEpEy9B,EAAc/jC,UAAU6qB,UAAY,SAAUlkB,EAAQO,GAClD,IAAI+8B,EAAcP,EAAKQ,SAASv9B,EAAQ,CACpCpD,KAAM,MACNib,QAAStX,IAEb,MAAO,CACH,CACI3D,KAAM,WACN2a,KAAM9d,KAAK4jC,iBAAiBtiB,kBAAkBuiB,MAI1DF,EAAc/jC,UAAU6jC,SAAW,SAAUl9B,EAAQq0B,GACjD,MAAsB,aAAfA,EAAMz3B,MAEjBwgC,EAAc/jC,UAAUqe,MAAQ,SAAU1X,EAAQm9B,GAC9C,IAAIjgC,EAAQzD,KACRe,EAAS,GAOb,OANA2iC,EAAOxX,SAAQ,SAAU0O,GACrB,IAAInvB,EAAMhI,EAAMmgC,iBACXrhB,cAAcqY,EAAM9c,MAAQ,IAC5BimB,SACLhjC,EAASA,EAAO8/B,OAAO9gC,MAAMgB,EAAQ0K,EAAI2S,SAAW,OAEjDrd,GAEJ4iC,EAlCwB,GAoCpBA,O,gCCtCf,IACIt6B,EAAO,CACP2gB,OAFJ,MAEY/qB,mBAAmB+e,MAEhB3U,O,oDC+BA26B,GAlCA3hC,EAAQ,IAEZA,EAAQ,GAAqBihC,KACA,WACpC,SAASU,KA4BT,OA1BAA,EAAmBpkC,UAAU4jC,aAAe,SAAUj9B,EAAQL,GAC1D,MAAqB,oBAAdA,EAAK/C,MAEhB6gC,EAAmBpkC,UAAU6qB,UAAY,SAAUlkB,EAAQO,GACvD,OAAOA,EAAMgK,KAAI,SAAU5K,GACvB,MAAO,CACH/C,KAAM,kBACN2a,KAAM5X,EAAKrC,MAAMnD,WAI7BsjC,EAAmBpkC,UAAU6jC,SAAW,SAAUl9B,EAAQq0B,GACtD,MAAsB,oBAAfA,EAAMz3B,MAEjB6gC,EAAmBpkC,UAAUqe,MAAQ,SAAU1X,EAAQm9B,GACnD,IAAI3iC,EAAS,GASb,OARA2iC,EAAOxX,SAAQ,SAAU0O,GACrB75B,EAAOoB,KAAK,CACRgB,KAAM,kBACNU,MAAO,CACHnD,MAAOk6B,EAAM9c,WAIlB/c,GAEJijC,EA7B6B,I,gBCJpCC,EAAyC,WACzC,IAAIC,EAAgB,SAAU/wB,EAAGgxB,GAI7B,OAHAD,EAAgB/kC,OAAOilC,gBAClB,CAAEC,UAAW,cAAgBjQ,OAAS,SAAUjhB,EAAGgxB,GAAKhxB,EAAEkxB,UAAYF,IACvE,SAAUhxB,EAAGgxB,GAAK,IAAK,IAAIxkC,KAAKwkC,EAAOA,EAAEtkC,eAAeF,KAAIwT,EAAExT,GAAKwkC,EAAExkC,MACpDwT,EAAGgxB,IAE5B,OAAO,SAAUhxB,EAAGgxB,GAEhB,SAASG,IAAOtkC,KAAKukC,YAAcpxB,EADnC+wB,EAAc/wB,EAAGgxB,GAEjBhxB,EAAEvT,UAAkB,OAANukC,EAAahlC,OAAO+F,OAAOi/B,IAAMG,EAAG1kC,UAAYukC,EAAEvkC,UAAW,IAAI0kC,IAV1C,GAazC/D,EAAkD,WAClD,IAAK,IAAIjhC,EAAI,EAAGC,EAAI,EAAGihC,EAAK/gC,UAAUC,OAAQH,EAAIihC,EAAIjhC,IAAKD,GAAKG,UAAUF,GAAGG,OACxE,IAAI8T,EAAI4gB,MAAM90B,GAAImhC,EAAI,EAA3B,IAA8BlhC,EAAI,EAAGA,EAAIihC,EAAIjhC,IACzC,IAAK,IAAIoW,EAAIlW,UAAUF,GAAImhC,EAAI,EAAGC,EAAKhrB,EAAEjW,OAAQghC,EAAIC,EAAID,IAAKD,IAC1DjtB,EAAEitB,GAAK9qB,EAAE+qB,GACjB,OAAOltB,GAQPwsB,EAAS39B,EAAQ,GAAqB29B,OAEtCsD,EAAOjhC,EAAQ,GAAqBihC,KACpCl6B,EAA8B,SAAUo7B,GAExC,SAASp7B,EAAalC,EAASu9B,QACX,IAAZv9B,IAAsBA,EAAU,IACpC,IAAIzD,EAAQ+gC,EAAO1kC,KAAKE,KAAMkH,IAAYlH,KAU1C,OATAyD,EAAMR,KAAO,OACbQ,EAAMjC,MAAQ,OACdiC,EAAMihC,cAAgB,IAAIf,IAAcz8B,EAASzD,GACjDA,EAAMghC,WAAaA,GAAc,CAC7B,IAAIlB,IACJ,IAAIS,EACJvgC,EAAMihC,eAEVjhC,EAAM0D,MAAQo5B,EAAe98B,EAAM0D,MAAOsuB,YAA0BhyB,EAAM8C,OAAQW,IAC3EzD,EA0EX,OAvFAwgC,EAAU76B,EAAco7B,GAexBp7B,EAAaxJ,UAAU6qB,UAAY,SAAUhf,GACzC,IAAIhI,EAAQzD,KACZ,IAAKyL,EACD,MAAO,GAIX,KAFAA,EAAMA,EAAIs4B,UAED3lB,SAAkC,IAAvB3S,EAAI2S,QAAQ1e,OAC5B,MAFY,GAahB,IATA,IAAIilC,EAAmBC,EAAQn5B,EAAI2S,SAAS,SAAUlY,GAClD,IAAK,IAAIuqB,EAAK,EAAGruB,EAAKqB,EAAMghC,WAAYhU,EAAKruB,EAAG1C,OAAQ+wB,IAAM,CAC1D,IAAIoU,EAAYziC,EAAGquB,GACnB,GAAIoU,EAAUrB,aAAa//B,EAAM8C,OAAQL,GACrC,OAAO2+B,MAIfnB,EAAS,GACJjT,EAAK,EAAGqU,EAAqBH,EAAkBlU,EAAKqU,EAAmBplC,OAAQ+wB,IAAM,CAC1F,IAAIrc,EAAQ0wB,EAAmBrU,GAC3BsU,EAAc3wB,EAAMA,MAAMqW,UAAUzqB,KAAKuG,OAAQ6N,EAAM4wB,OAC3DtB,EAASA,EAAO7C,OAAO9gC,MAAM2jC,EAAQqB,GAEzC,OAAOrB,GAEXt6B,EAAaxJ,UAAUqe,MAAQ,SAAUylB,GACrC,IAAIjgC,EAAQzD,KACZ,IAAK0jC,GAA4B,IAAlBA,EAAOhkC,OAClB,OAAO4jC,EAAKQ,SAAS9jC,KAAKuG,OAAQ,CAC9BpD,KAAM,MACNib,QAAS,CACL,CACIjb,KAAM,gBAiBtB,IAZA,IAAIpC,EAAS,CACToC,KAAM,MACNib,QAAS,IAET6mB,EAA2BL,EAAQlB,GAAQ,SAAU9I,GACrD,IAAK,IAAInK,EAAK,EAAGruB,EAAKqB,EAAMghC,WAAYhU,EAAKruB,EAAG1C,OAAQ+wB,IAAM,CAC1D,IAAIoU,EAAYziC,EAAGquB,GACnB,GAAIoU,EAAUpB,SAAShgC,EAAM8C,OAAQq0B,GACjC,OAAOiK,MAIVpU,EAAK,EAAGyU,EAA6BD,EAA0BxU,EAAKyU,EAA2BxlC,OAAQ+wB,IAAM,CAClH,IAAIrc,EAAQ8wB,EAA2BzU,GACnCoT,EAAczvB,EAAMA,MAAM6J,MAAMje,KAAKuG,OAAQ6N,EAAM4wB,OACvDjkC,EAAOqd,QAAUrd,EAAOqd,QAAQyiB,OAAO9gC,MAAMgB,EAAOqd,QAASylB,GAEjE,OAAOP,EAAKQ,SAAS9jC,KAAKuG,OAAQxF,IAEtCqI,EAAaxJ,UAAUyiC,aAAe,SAAUn7B,GAC5C,IAAIX,EAASi+B,EAAO5kC,UAAUyiC,aAAaviC,KAAKE,KAAMkH,GACtD,OAAO,IAAI84B,EAAO,CACdl5B,MAAOP,EAAOm8B,KAAK57B,MACdq+B,UAAU,QAAS,gBAAiBnU,eACpCmU,UAAU,QAAS,kBAAmBrR,eAC3ClwB,MAAO2C,EAAOm8B,KAAK9+B,SAG3BwF,EAAaxJ,UAAU2iC,mBAAqB,WACxC,MAAO,CACH,gBAAiB,WAAc,MAAO,IACtC,kBAAmB,WAAc,MAAO,MAGzCn5B,EAxFuB,CAyFhCsgB,KACatgB,MACf,SAASw7B,EAAQI,EAAOI,GAIpB,IAHA,IAAIrkC,EAAS,GACTskC,EAAe,KACfC,EAAoB,GACf7U,EAAK,EAAG8U,EAAUP,EAAOvU,EAAK8U,EAAQ7lC,OAAQ+wB,IAAM,CACzD,IAAIpW,EAAOkrB,EAAQ9U,GACf+U,EAAYJ,EAAQ/qB,QACNxV,IAAd2gC,IAGiB,OAAjBH,GACAA,EAAeG,EACfF,EAAoB,CAACjrB,IAEhBgrB,IAAiBG,EACtBF,EAAkBnjC,KAAKkY,IAGnBirB,EAAkB5lC,OAAS,GAC3BqB,EAAOoB,KAAK,CACRiS,MAAOixB,EACPL,MAAOM,IAGfD,EAAeG,EACfF,EAAoB,CAACjrB,KAS7B,OANIirB,EAAkB5lC,OAAS,GAAsB,OAAjB2lC,GAChCtkC,EAAOoB,KAAK,CACRiS,MAAOixB,EACPL,MAAOM,IAGRvkC,K","file":"static/js/main.ea9897a9.chunk.js","sourcesContent":["export * from \"./languages\";\nexport * from \"./dialogs\";\nexport * from \"./tools\";\nexport * from \"./utils\";\nexport * from \"./actions\";\nexport * from \"./editor\";\n","export * from \"./RichLanguage\";\nexport * from \"./RichLanguageConfiguration\";\nexport * from \"./RichLanguageFormat\";\nexport * from \"./RichTextLanguageMap\";\n","export var RichLanguageFormat;\n(function (RichLanguageFormat) {\n    RichLanguageFormat[\"TEXT\"] = \"text\";\n    RichLanguageFormat[\"JSON\"] = \"json\";\n})(RichLanguageFormat || (RichLanguageFormat = {}));\n","export * from \"./RichTextDialogs\";\n","export * from \"./ProseMirrorTool\";\nexport * from \"./ProseMirrorToolState\";\nexport * from \"./StandardTools\";\nexport * from \"./StandardToolOptions\";\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React from \"react\";\nimport { canInsert, clearAllMarks, getSelectionMarks, isMarkActive, } from \"../utils\";\nimport CalendarViewDay from \"@material-ui/icons/CalendarViewDay\";\nimport Code from \"@material-ui/icons/Code\";\nimport FormatBold from \"@material-ui/icons/FormatBold\";\nimport FormatClearIcon from \"@material-ui/icons/FormatClear\";\nimport FormatIndentDecrease from \"@material-ui/icons/FormatIndentDecrease\";\nimport FormatItalic from \"@material-ui/icons/FormatItalic\";\nimport FormatListBulleted from \"@material-ui/icons/FormatListBulleted\";\nimport FormatListNumbered from \"@material-ui/icons/FormatListNumbered\";\nimport FormatQuote from \"@material-ui/icons/FormatQuote\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport Link from \"@material-ui/icons/Link\";\nimport Redo from \"@material-ui/icons/Redo\";\nimport Undo from \"@material-ui/icons/Undo\";\nimport { isToolEnabled } from \"./StandardToolOptions\";\n// tslint:disable-next-line\nvar _a = require(\"prosemirror-history\"), undoFn = _a.undo, redoFn = _a.redo;\n// tslint:disable-next-line\nvar _b = require(\"prosemirror-commands\"), toggleMark = _b.toggleMark, setBlockType = _b.setBlockType, lift = _b.lift;\n// tslint:disable-next-line\nvar wrapInList = require(\"prosemirror-schema-list\").wrapInList;\n// tslint:disable-next-line\nvar findParentNode = require(\"prosemirror-utils\").findParentNode;\nexport function createMarkToggleTool(name, label, icon, type) {\n    return {\n        name: name,\n        label: label,\n        displayIcon: icon,\n        isActive: function (state) { return isMarkActive(state, type); },\n        apply: toggleMark(type),\n    };\n}\nexport function undo() {\n    return {\n        name: \"undo\",\n        label: \"Undo\",\n        displayIcon: React.createElement(Undo, null),\n        isEnabled: function (state) { return undoFn(state); },\n        apply: undoFn,\n    };\n}\nexport function redo() {\n    return {\n        name: \"redo\",\n        label: \"Redo\",\n        displayIcon: React.createElement(Redo, null),\n        isEnabled: function (state) { return redoFn(state); },\n        apply: redoFn,\n    };\n}\nexport function strong(schema) {\n    return createMarkToggleTool(\"strong\", \"Bold\", React.createElement(FormatBold, null), schema.marks.strong);\n}\nexport function em(schema) {\n    return createMarkToggleTool(\"em\", \"Italic\", React.createElement(FormatItalic, null), schema.marks.em);\n}\nexport function code(schema) {\n    return createMarkToggleTool(\"code\", \"Code\", React.createElement(Code, null), schema.marks.code);\n}\nexport function editLink(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var marks, attrs, markAttrs, linkValue, newAttrs, tr, selection, err_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    marks = getSelectionMarks(state).filter(function (mark) { return mark.mark.type === type; });\n                    if (marks.length === 1) {\n                        markAttrs = marks[0].mark.attrs;\n                        attrs = {\n                            href: markAttrs.href || \"\",\n                            title: markAttrs.title || \"\",\n                            // Add openInNewTab based on target attribute\n                            openInNewTab: markAttrs.target === \"_blank\",\n                        };\n                    }\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getHyperlink(attrs)];\n                case 2:\n                    linkValue = _a.sent();\n                    if (linkValue.cancel) {\n                        return [2 /*return*/];\n                    }\n                    newAttrs = {\n                        href: linkValue.href,\n                        title: linkValue.title === \"\" ? undefined : linkValue.title,\n                        target: linkValue.openInNewTab ? \"_blank\" : undefined,\n                        rel: linkValue.openInNewTab ? \"noopener noreferrer\" : undefined,\n                    };\n                    if (marks.length > 0) {\n                        tr = state.tr, selection = state.selection;\n                        if (newAttrs.href !== \"\") {\n                            if (marks.length < 2 &&\n                                !(selection.from < marks[0].from || selection.to > marks[0].to)) {\n                                dispatch(tr.addMark(marks[0].from, marks[0].to, type.create(newAttrs)));\n                            }\n                            else {\n                                dispatch(tr.addMark(selection.from, selection.to, type.create(newAttrs)));\n                            }\n                        }\n                    }\n                    else {\n                        toggleMark(type, newAttrs)(state, dispatch);\n                    }\n                    return [2 /*return*/];\n                case 3:\n                    err_1 = _a.sent();\n                    return [3 /*break*/, 4];\n                case 4:\n                    if (isMarkActive(state, type)) {\n                        dispatch(state.tr.removeMark(marks[0].from, marks[0].to, type));\n                    }\n                    return [2 /*return*/];\n            }\n        });\n    }); };\n}\nexport function editCode(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var params, val, err_2;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    params = getCurrentParams(state, type);\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getCode(params.params || \"\")];\n                case 2:\n                    val = _a.sent();\n                    return [2 /*return*/, setBlockType(type, { params: val })(state, dispatch)];\n                case 3:\n                    err_2 = _a.sent();\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n            }\n        });\n    }); };\n}\nexport function link(schema) {\n    return {\n        name: \"link\",\n        label: \"Add or remove Link\",\n        displayIcon: React.createElement(Link, null),\n        isActive: function (state) { return isMarkActive(state, schema.marks.link); },\n        isEnabled: function (state) {\n            return (!state.selection.empty ||\n                getSelectionMarks(state).filter(function (mark) { return mark.mark.type === schema.marks.link; }).length > 0);\n        },\n        apply: editLink(schema.marks.link),\n    };\n}\nexport function insertImage(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var imageValue, err_3;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getImage()];\n                case 1:\n                    imageValue = _a.sent();\n                    dispatch(state.tr.replaceSelectionWith(type.createAndFill({\n                        src: imageValue.src,\n                        title: imageValue.title === \"\" ? undefined : imageValue.title,\n                        alt: imageValue.alt === \"\" ? undefined : imageValue.alt,\n                    })));\n                    return [3 /*break*/, 3];\n                case 2:\n                    err_3 = _a.sent();\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    }); };\n}\nexport function image(schema) {\n    return {\n        name: \"image\",\n        label: \"Insert Image from URL\",\n        displayIcon: React.createElement(ImageIcon, null),\n        apply: insertImage(schema.nodes.image),\n    };\n}\nexport function lift_tool(schema) {\n    return {\n        name: \"lift\",\n        label: \"Decrease Indentation\",\n        displayIcon: React.createElement(FormatIndentDecrease, null),\n        isVisible: function (state) { return lift(state); },\n        apply: lift,\n    };\n}\nexport function bullet_list(schema) {\n    return {\n        name: \"bullet_list\",\n        label: \"Bullet List\",\n        displayIcon: React.createElement(FormatListBulleted, null),\n        isEnabled: function (state) { return wrapInList(schema.nodes.bullet_list, {})(state); },\n        apply: wrapInList(schema.nodes.bullet_list, {}),\n    };\n}\nexport function ordered_list(schema) {\n    return {\n        name: \"ordered_list\",\n        label: \"Ordered List\",\n        displayIcon: React.createElement(FormatListNumbered, null),\n        isEnabled: function (state) { return wrapInList(schema.nodes.ordered_list, {})(state); },\n        apply: wrapInList(schema.nodes.ordered_list, {}),\n    };\n}\nexport function blockquote(schema) {\n    return {\n        name: \"blockquote\",\n        label: \"Quote\",\n        displayIcon: React.createElement(FormatQuote, null),\n        isEnabled: function (state) { return wrapInList(schema.nodes.blockquote, {})(state); },\n        apply: wrapInList(schema.nodes.blockquote, {}),\n    };\n}\nfunction getCurrentAlignment(state) {\n    if (state == null) {\n        return {};\n    }\n    // Locate the block we're contained in.\n    var parent = findParentNode(function (x) { return x.attrs.align; })(state.selection);\n    if (parent != null) {\n        return { align: parent.node.attrs.align };\n    }\n    else {\n        return {};\n    }\n}\nfunction getCurrentParams(state, type) {\n    if (state == null || type.name !== \"code_block\") {\n        return {};\n    }\n    // Locate the block we're contained in.\n    var parent = findParentNode(function (x) { return x.attrs.params; })(state.selection);\n    if (parent != null) {\n        return { params: parent.node.attrs.params || \"\" };\n    }\n    else {\n        return { params: \"\" };\n    }\n}\nfunction blockTypeCommand(state, type, attrs) {\n    return setBlockType(type, __assign(__assign({}, attrs), getCurrentAlignment(state)));\n}\nexport function heading(schema, level) {\n    return {\n        name: \"heading_\" + level,\n        label: \"Heading \" + level,\n        displayLabel: React.createElement(\"h\" + level, { style: { margin: 0 } }, \"Heading \" + level),\n        apply: function (state, dispatch) {\n            return blockTypeCommand(state, schema.nodes.heading, { level: level })(state, dispatch);\n        },\n        isEnabled: function (state) {\n            return blockTypeCommand(state, schema.nodes.heading, { level: level })(state);\n        },\n        isActive: function (state, view) {\n            return !blockTypeCommand(state, schema.nodes.heading, { level: level })(state, null);\n        },\n    };\n}\nexport function paragraph(schema) {\n    var command = setBlockType(schema.nodes.paragraph);\n    return {\n        name: \"paragraph\",\n        label: \"Normal text\",\n        displayLabel: (React.createElement(\"p\", { style: { margin: 0, padding: 0, display: \"inline\" } }, \"Normal text\")),\n        apply: function (state, dispatch) {\n            return blockTypeCommand(state, schema.nodes.paragraph)(state, dispatch);\n        },\n        isEnabled: function (state) {\n            return blockTypeCommand(state, schema.nodes.paragraph)(state);\n        },\n        isActive: function (state) {\n            return !blockTypeCommand(state, schema.nodes.paragraph)(state, null);\n        },\n    };\n}\nexport function code_block(schema) {\n    return {\n        name: \"code_block\",\n        label: \"Code Block\",\n        displayLabel: React.createElement(\"code\", null, \"Code Block\"),\n        displayIcon: React.createElement(Code, null),\n        apply: editCode(schema.nodes.code_block),\n        isActive: function (state, richTextEditorContext) {\n            var params = getCurrentParams(state, schema.nodes.code_block);\n            return !setBlockType(schema.nodes.code_block, __assign({}, params))(state, null);\n        },\n    };\n}\nexport function horizontal_rule(schema) {\n    return {\n        name: \"horizontal_rule\",\n        label: \"Insert Horizontal Rule\",\n        displayIcon: React.createElement(CalendarViewDay, null),\n        apply: function (state, dispatch) {\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.horizontal_rule.create()));\n        },\n        isEnabled: function (state) { return canInsert(state, schema.nodes.horizontal_rule); },\n    };\n}\nexport function clear_formatting() {\n    return {\n        name: \"clear_formatting\",\n        label: \"Clear Formatting\",\n        displayIcon: React.createElement(FormatClearIcon, null),\n        apply: clearAllMarks(),\n        isEnabled: function (state) {\n            // are there any marks?\n            return true;\n        },\n    };\n}\nexport function createStandardTools(schema, options) {\n    var tools = [];\n    if (isToolEnabled(\"undo\", options)) {\n        tools.push(undo());\n    }\n    if (isToolEnabled(\"redo\", options)) {\n        tools.push(redo());\n    }\n    if (isToolEnabled(\"strong\", options) && schema.marks.strong) {\n        tools.push(strong(schema));\n    }\n    if (isToolEnabled(\"em\", options) && schema.marks.em) {\n        tools.push(em(schema));\n    }\n    if (isToolEnabled(\"code\", options) && schema.marks.code) {\n        tools.push(code(schema));\n    }\n    if (isToolEnabled(\"link\", options) && schema.marks.link) {\n        tools.push(link(schema));\n    }\n    if (isToolEnabled(\"lift\", options)) {\n        tools.push(lift_tool(schema));\n    }\n    if (isToolEnabled(\"bullet_list\", options) && schema.nodes.bullet_list) {\n        tools.push(bullet_list(schema));\n    }\n    if (isToolEnabled(\"ordered_list\", options) && schema.nodes.ordered_list) {\n        tools.push(ordered_list(schema));\n    }\n    if (isToolEnabled(\"image\", options) && schema.nodes.image) {\n        tools.push(image(schema));\n    }\n    if (isToolEnabled(\"blockquote\", options) && schema.nodes.blockquote) {\n        tools.push(blockquote(schema));\n    }\n    if (isToolEnabled(\"heading\", options) && schema.nodes.heading) {\n        for (var i = 1; i < 7; i++) {\n            tools.push(heading(schema, i));\n        }\n    }\n    if (isToolEnabled(\"paragraph\", options) && schema.nodes.paragraph) {\n        tools.push(paragraph(schema));\n    }\n    if (isToolEnabled(\"code_block\", options) && schema.nodes.code_block) {\n        tools.push(code_block(schema));\n    }\n    if (isToolEnabled(\"horizontal_rule\", options) &&\n        schema.nodes.horizontal_rule) {\n        tools.push(horizontal_rule(schema));\n    }\n    if (isToolEnabled(\"clear_formatting\", options)) {\n        tools.push(clear_formatting());\n    }\n    return tools;\n}\n","export * from \"./RichTextActions\";\n","export * from \"./RichTextEditorContextProps\";\n","import JSONLanguage from \"./JSONLanguage\";\nimport JSONLanguageConfiguration from \"./JSONLanguageConfiguration\";\nexport default function (options) {\n    return {\n        language: new JSONLanguage(options),\n        conf: JSONLanguageConfiguration\n    };\n}\nexport * from \"./JSONLanguage\";\nexport * from \"./JSONLanguageConfiguration\";\nexport * from \"./blocks/Block\";\nexport * from \"./blocks/DcImageLinkBlock\";\nexport * from \"./blocks/MarkdownBlock\";\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\n\nconst styles = {\n  root: {\n    flex: 1,\n    display: \"flex\",\n    minHeight: 286,\n    maxHeight: 500,\n  },\n  textarea: {\n    flex: 1,\n    outline: \"none\" as \"none\",\n    resize: \"none\" as \"none\",\n    backgroundColor: \"#f0f0f0\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    padding: \"10px 8px 0\",\n    fontFamily: \"'IBM Plex Sans',monospace!important\",\n    fontSize: 13,\n  },\n};\n\nexport interface CodeTextAreaProps extends WithStyles<typeof styles> {\n  readOnly?: boolean;\n  value: string;\n  onChange?: (value: string) => void;\n}\n\nconst CodeTextArea: React.SFC<CodeTextAreaProps> = (\n  props: CodeTextAreaProps\n) => {\n  const { classes, value, onChange, readOnly = false } = props;\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      if (onChange) {\n        onChange(event.target.value);\n      }\n    },\n    [onChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      <textarea\n        readOnly={readOnly}\n        className={classes.textarea}\n        value={value}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(CodeTextArea);\n","import React, { RefObject } from \"react\";\n\nimport \"./ProseMirror.scss\";\n\nimport { WithStyles, withStyles } from \"@material-ui/core\";\n\n// tslint:disable-next-line\nconst EditorState = require(\"prosemirror-state\").EditorState;\n// tslint:disable-next-line\nconst EditorView = require(\"prosemirror-view\").EditorView;\n// tslint:disable-next-line\nconst exampleSetup = require(\"prosemirror-example-setup\").exampleSetup;\n// tslint:disable-next-line\nconst { tableEditing, columnResizing } = require(\"prosemirror-tables\");\n// tslint:disable-next-line\nconst keymap = require(\"prosemirror-keymap\").keymap;\n// tslint:disable-next-line\nconst { sinkListItem } = require(\"prosemirror-schema-list\");\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    minHeight: 250,\n    maxHeight: 600,\n    overflowY: \"scroll\" as \"scroll\",\n  },\n};\n\nexport interface ProseMirrorProps extends WithStyles<typeof styles> {\n  schema: any;\n  doc?: any;\n  editorViewOptions?: any;\n  onUpdateState?: (state: any, editorView: any) => void;\n  onChange?: (doc: any) => void;\n  isLocked?: boolean;\n}\n\ninterface ProseMirrorState {\n  ref: RefObject<any>;\n  editorView?: any;\n  isLocked?: boolean;\n}\n\nfunction getKeys(schema: any): any {\n  return {\n    Tab: sinkListItem(schema.nodes.list_item),\n  };\n}\n\nclass ProseMirror extends React.Component<ProseMirrorProps, ProseMirrorState> {\n  constructor(props: ProseMirrorProps) {\n    super(props);\n    const ref = React.createRef();\n    this.state = { ref, isLocked: props.isLocked };\n  }\n\n  public createEditorState(): any {\n    const { schema, doc } = this.props;\n\n    const withTablePlugins = schema.nodes.table != null;\n    const tablePlugins = withTablePlugins\n      ? [columnResizing(), tableEditing()]\n      : [];\n\n    return EditorState.create({\n      schema,\n      doc,\n      plugins: [\n        ...tablePlugins,\n        keymap(getKeys(schema)),\n        ...exampleSetup({ schema, menuBar: false }), // can pass mapkeys to suppress some bindings\n      ],\n    });\n  }\n\n  public createEditorView(parent: any): any {\n    const { onUpdateState, onChange } = this.props;\n\n    const editorState = this.createEditorState();\n    // tslint:disable-next-line: no-this-assignment\n    const self = this;\n\n    const view = new EditorView(parent, {\n      ...this.props.editorViewOptions,\n      state: editorState,\n      dispatchTransaction: (transaction: any) => {\n        const { state, transactions } = view.state.applyTransaction(\n          transaction\n        );\n\n        view.updateState(state);\n\n        if (onUpdateState) {\n          onUpdateState(state, view);\n        }\n        view.scrollToSelection = () => {\n          const { node } = view.domAtPos(state.selection.anchor);\n          if (node) {\n            (node as any).scrollIntoView?.(false);\n          }\n        };\n\n        if (transactions.some((tr: any) => tr.docChanged)) {\n          if (onChange) {\n            onChange(state.doc);\n            if (this.state.isLocked) {\n              view.scrollToSelection();\n            }\n          }\n        }\n\n        this.forceUpdate();\n        return state;\n      },\n      editable(): boolean {\n        return !self.state.isLocked;\n      },\n    });\n\n    if (onUpdateState) {\n      onUpdateState(view.state, view);\n    }\n\n    // TODO: Is there a cleaner way than this monkey patch for getting the updated state after a dispatch?\n    view.dispatch = function(this: any, tr: any): any {\n      const dispatchTransaction = this._props.dispatchTransaction;\n      if (dispatchTransaction) {\n        return dispatchTransaction.call(this, tr);\n      } else {\n        return this.updateState(this.state.apply(tr));\n      }\n    }.bind(view);\n\n    return view;\n  }\n\n  public componentDidMount(): void {\n    if (this.state.ref && !this.state.editorView) {\n      const editorView = this.createEditorView(this.state.ref.current);\n      this.setState({ editorView });\n    }\n  }\n\n  public componentDidUpdate(\n    prevProps: Readonly<ProseMirrorProps>,\n    prevState: Readonly<ProseMirrorState>,\n    snapshot?: any\n  ): void {\n    if (this.props.isLocked !== prevProps.isLocked) {\n      this.setState({ ...this.state, isLocked: this.props.isLocked });\n    }\n  }\n\n  public render(): React.ReactElement {\n    const { classes } = this.props;\n    return <div className={classes.root} ref={this.state.ref} />;\n  }\n}\n\nexport default withStyles(styles)(ProseMirror);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\n\nconst styles = {\n  root: {\n    display: \"flex\",\n    marginBottom: 5,\n  },\n  button: {\n    outline: \"none\" as \"none\",\n    transition: \"color 0.2s linear,border-bottom-color 0.2s linear\",\n    height: 42,\n    cursor: \"pointer\" as \"pointer\",\n    background: \"transparent\" as \"transparent\",\n    border: \"0 solid transparent\",\n    borderTop: \"3px solid transparent\",\n    borderBottom: \"3px solid transparent\",\n    fontSize: 13,\n    padding: \"0 15px\",\n    color: \"#333\",\n    fontWeight: 500,\n    fontFamily: \"'IBM Plex Sans', sans-serif\",\n  },\n  selected: {\n    color: \"#1EA7FD\",\n    borderBottomColor: \"#1EA7FD\",\n  },\n};\n\nexport interface ViewSwitcherProps extends WithStyles<typeof styles> {\n  disableCodeView?: boolean;\n  disableEditView?: boolean;\n\n  language?: string;\n  onChange?: (view: EditorView) => void;\n}\n\nexport enum EditorView {\n  EDIT = \"edit\",\n  CODE = \"code\",\n}\n\nconst ViewSwitcher = (props: ViewSwitcherProps) => {\n  const {\n    classes,\n    onChange,\n    language,\n    disableCodeView,\n    disableEditView,\n  } = props;\n\n  const [selectedView, setSelectedView] = React.useState(\n    !disableEditView ? EditorView.EDIT : EditorView.CODE\n  );\n\n  const handleChange = React.useCallback(\n    (view: EditorView) => {\n      setSelectedView(view);\n      if (onChange) {\n        onChange(view);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [setSelectedView]\n  );\n\n  const renderButton = React.useCallback(\n    (label: string, view: EditorView) => {\n      return (\n        <button\n          onClick={() => handleChange(view)}\n          className={clsx(classes.button, {\n            [classes.selected]: selectedView === view,\n          })}\n          type=\"button\"\n          role=\"tab\"\n        >\n          {label}\n        </button>\n      );\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [selectedView, handleChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      {disableEditView ? false : renderButton(\"Editor\", EditorView.EDIT)}\n      {disableCodeView\n        ? false\n        : renderButton(language || \"Code\", EditorView.CODE)}\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ViewSwitcher);\n","import React from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarContextInterface {\n  getToolState?(toolName: string): ProseMirrorToolState | undefined;\n  applyTool?(toolName: string): void;\n}\n\nconst ProseMirrorToolbarContext = React.createContext<\n  ProseMirrorToolbarContextInterface\n>({});\nexport default ProseMirrorToolbarContext;\n","import { IconButton, Tooltip, withStyles, WithStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nimport clsx from \"clsx\";\n\nexport interface ProseMirrorToolbarButtonProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {\n  toolName: string;\n  isLocked?: boolean;\n}\n\nconst styles = {\n  root: {\n    margin: \"1px\"\n  },\n  tooltip: {\n    fontSize: 12,\n    backgroundColor: \"#1A222D\",\n    maxWidth: 240\n  },\n  arrow: {\n    color: \"#1A222D\",\n  },\n};\n\nconst ProseMirrorToolbarIconButton: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolName, classes } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolState = getToolState ? getToolState(toolName) : null;\n  const handleClick = React.useCallback(\n    event => {\n      const focus = document.activeElement;\n      if (applyTool) {\n        applyTool(toolName);\n      }\n\n      // Focus will switch to the button, which is required to play the ripple effect.\n      // If we return it to the original element as soon as possible, the cursor will be in the same spot.\n      if (focus != null) {\n        setTimeout(() => (focus as HTMLElement).focus(), 0);\n      }\n    },\n    [toolName, applyTool]\n  );\n\n  if (!toolState || !toolState.visible) {\n    return null;\n  }\n\n  return (\n    <Tooltip \n      title={toolState.label} \n      arrow \n      classes={{\n        arrow: clsx(classes.arrow),\n        tooltip: clsx(classes.tooltip),\n      }}\n    >\n      <IconButton\n        className={clsx(classes.root)}\n        onMouseDown={handleClick}\n        size=\"small\"\n        disabled={!toolState.enabled || props.isLocked}\n        color={toolState.active ? \"primary\" : \"default\"}\n        title={toolState.label}\n      >\n        {toolState.displayIcon ? toolState.displayIcon : toolState.label}\n      </IconButton>\n    </Tooltip>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarIconButton);\n","import React, { ChangeEvent } from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\nimport { MenuItem, Select, WithStyles, withStyles } from \"@material-ui/core\";\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nconst styles = {\n  value: {\n    fontSize: 13,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"unset\" as \"unset\",\n  },\n};\n\nexport interface ProseMirrorToolbarButtonProps\n  extends WithStyles<typeof styles> {\n  toolNames: string[];\n  label?: string;\n  isLocked?: boolean;\n}\n\nconst ProseMirrorToolbarDropdown: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolNames, classes, label } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolStates = toolNames\n    .map((toolName) => {\n      const toolState = getToolState ? getToolState(toolName) : null;\n      return toolState;\n    })\n    .filter((x) => x != null) as ProseMirrorToolState[];\n\n  const selectedItems: ProseMirrorToolState[] = toolStates.filter(\n    (x) => x.active\n  );\n\n  const selected =\n    selectedItems && selectedItems.length > 1\n      ? selectedItems.find((x) => /inline_styles/.test(x.name)) ||\n        selectedItems[0]\n      : selectedItems.find((x) => x.active);\n\n  const value = selected ? selected.name : \"\";\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<{ value: unknown }>) => {\n      if (applyTool) {\n        applyTool(event.target.value as string);\n      }\n    },\n    [applyTool]\n  );\n\n  // override renderValue so menu items can be styled\n  const renderValue = React.useCallback(\n    (toolName?: any) => {\n      if (!toolName) {\n        return label || \"\";\n      }\n\n      let toolState:\n        | { label: string; displayLabel?: React.ReactElement }\n        | undefined = getToolState ? getToolState(toolName) : undefined;\n\n      if (!toolState) {\n        toolState = { label: toolName };\n      }\n\n      if (toolState.displayLabel) {\n        return React.cloneElement(toolState.displayLabel, {\n          className: classes.value,\n        });\n      }\n      return toolState.label;\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [getToolState]\n  );\n\n  if (toolStates.length === 0) {\n    return null;\n  }\n\n  return (\n    <Select\n      value={value}\n      onChange={handleChange}\n      renderValue={renderValue}\n      displayEmpty={true}\n      onMouseDown={(e) => e.preventDefault()}\n      disabled={props.isLocked}\n    >\n      {toolStates.map((toolState) => {\n        return (\n          <MenuItem\n            value={toolState.name}\n            key={toolState.name}\n            onMouseDown={(e) => e.preventDefault()}\n          >\n            {toolState.displayLabel ? (\n              toolState.displayLabel\n            ) : (\n              <span>{toolState.label}</span>\n            )}\n          </MenuItem>\n        );\n      })}\n    </Select>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarDropdown);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport clsx from \"clsx\";\n\nconst styles = {\n  root: {\n    display: \"flex\",\n    alignItems: \"center\",\n    \"& .divider\": {\n      verticalAlign: \"top\",\n      display: \"inline-flex\",\n      height: 13,\n      lineHeight: 13,\n      borderRight: \"1px solid rgb(218, 220, 224)\",\n      margin: \"9px 4px\",\n    },\n    \"&:last-of-type .divider\": {\n      display: \"none\",\n    },\n  },\n  empty: {\n    display: \"none\",\n  },\n};\n\nexport interface ProseMirrorToolbarGroupProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {}\n\nconst ProseMirrorToolbarGroup: React.SFC<ProseMirrorToolbarGroupProps> = (\n  props: ProseMirrorToolbarGroupProps\n) => {\n  const { children, classes } = props;\n\n  return (\n    <div\n      className={clsx(classes.root, {\n        [classes.empty]: !children,\n      })}\n    >\n      {children}\n      <div className=\"divider\" />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarGroup);\n","import { RichTextEditorContextProps } from \"@dc-extension-rich-text/common\";\nimport React, { SetStateAction, useContext } from \"react\";\n\nconst context = React.createContext<RichTextEditorContextProps>({\n  params: {},\n  isLocked: false,\n  proseMirrorEditorView: undefined,\n  dialogs: {} as any,\n  actions: {} as any,\n  languages: {},\n  language: {} as any,\n  sdk: {} as any,\n  hub: {} as any,\n  setIsLocked: (locked: boolean) => {},\n  setShowCreditsError: (show: boolean) => {},\n});\nexport default context;\n\nexport function useRichTextEditorContext(): RichTextEditorContextProps {\n  return useContext(context);\n}\n","import React from \"react\";\n\nexport const SparklesIcon = (props: any) => {\n  const { readOnly, style, variant } = props;\n  return variant === \"content-studio\" ? (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"22\"\n      height=\"22\"\n      fill=\"none\"\n      viewBox=\"0 0 26 26\"\n    >\n      <g\n        stroke={readOnly ? \"#D9D9D9\" : \"#F88B8B\"}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth=\"1.5\"\n        clipPath=\"url(#clip0_2281_13381)\"\n      >\n        <path d=\"M12.417 9.834h-11M1.417 4.5H17.5M7.417 15.166h-6M1.417 20.5h6M21.333 22.25a1.917 1.917 0 011.917 1.917 1.917 1.917 0 011.917-1.916 1.917 1.917 0 01-1.917-1.917 1.917 1.917 0 01-1.917 1.917zm0-11.5a1.917 1.917 0 011.917 1.917 1.917 1.917 0 011.917-1.916 1.917 1.917 0 01-1.917-1.917 1.917 1.917 0 01-1.917 1.917zm-5.708 11.5a5.75 5.75 0 015.75-5.75 5.75 5.75 0 01-5.75-5.75 5.75 5.75 0 01-5.75 5.75 5.75 5.75 0 015.75 5.75z\"></path>\n      </g>\n      <defs>\n        <clipPath id=\"clip0_2281_13381\">\n          <path fill=\"#fff\" d=\"M0 0H26V26H0z\"></path>\n        </clipPath>\n      </defs>\n    </svg>\n  ) : (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"32\"\n      height=\"32\"\n      style={{ flex: \"0 0 auto\", ...style }}\n      fill={readOnly ? \"#D9D9D9\" : \"#F88B8B\"}\n      viewBox=\"5.34 5.34 21.33 21.33\"\n    >\n      <path d=\"M19.022 7.887a.578.578 0 0 1 1.098 0l.97 2.644c.479 1.303 1.455 2.333 2.69 2.837l2.51 1.024c.5.205.5.952 0 1.157l-2.51 1.024c-1.235.504-2.212 1.534-2.69 2.836l-.97 2.645a.578.578 0 0 1-1.098 0l-.97-2.645c-.479-1.302-1.455-2.332-2.69-2.836l-2.509-1.024c-.501-.205-.501-.952 0-1.157l2.508-1.024c1.236-.504 2.212-1.534 2.69-2.837l.971-2.644ZM11.252 18.767a.289.289 0 0 1 .549 0l.567 1.544a2.42 2.42 0 0 0 1.345 1.419l1.465.597c.25.103.25.477 0 .579l-1.465.598a2.42 2.42 0 0 0-1.345 1.418l-.567 1.545a.289.289 0 0 1-.549 0l-.567-1.545a2.42 2.42 0 0 0-1.345-1.418l-1.465-.598c-.25-.102-.25-.476 0-.579l1.465-.597a2.42 2.42 0 0 0 1.345-1.419l.567-1.544ZM8.9 5.533a.289.289 0 0 1 .548 0l.567 1.545a2.42 2.42 0 0 0 1.345 1.418l1.465.598c.251.102.251.476 0 .579l-1.464.597a2.42 2.42 0 0 0-1.346 1.419l-.567 1.544a.289.289 0 0 1-.548 0l-.567-1.544a2.42 2.42 0 0 0-1.345-1.419l-1.465-.597c-.25-.103-.25-.477 0-.579l1.465-.598a2.42 2.42 0 0 0 1.345-1.418L8.9 5.533Z\" />\n    </svg>\n  );\n};\n","import React from \"react\";\n\nexport const Loader = () => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"26\"\n      height=\"8\"\n      viewBox=\"0 0 26 8\"\n      fill=\"#808080\"\n    >\n      <circle cx=\"4\" cy=\"4\" r=\"0\">\n        <animate\n          attributeName=\"r\"\n          from=\"4\"\n          to=\"4\"\n          begin=\"0s\"\n          dur=\"1.4s\"\n          values=\"0;4;0;0\"\n          calcMode=\"spline\"\n          keySplines=\"0.5 0 0.5 1; 0 0 1 1; 0.5 0 0.5 1\"\n          repeatCount=\"indefinite\"\n          keyTimes=\"0;0.4;0.8;1\"\n        />\n      </circle>\n      <circle cx=\"13\" cy=\"4\" r=\"0\">\n        <animate\n          attributeName=\"r\"\n          from=\"4\"\n          to=\"4\"\n          begin=\"0.16s\"\n          dur=\"1.4s\"\n          values=\"0;4;0;0\"\n          calcMode=\"spline\"\n          keySplines=\"0.5 0 0.5 1; 0 0 1 1; 0.5 0 0.5 1\"\n          repeatCount=\"indefinite\"\n          keyTimes=\"0;0.4;0.8;1\"\n        />\n      </circle>\n      <circle cx=\"22\" cy=\"4\" r=\"0\">\n        <animate\n          attributeName=\"r\"\n          from=\"4\"\n          to=\"4\"\n          begin=\"0.32s\"\n          dur=\"1.4s\"\n          values=\"0;4;0;0\"\n          calcMode=\"spline\"\n          keySplines=\"0.5 0 0.5 1; 0 0 1 1; 0.5 0 0.5 1\"\n          repeatCount=\"indefinite\"\n          keyTimes=\"0;0.4;0.8;1\"\n        />\n      </circle>\n    </svg>\n  );\n};\n","import React from \"react\";\n\nimport {\n  Button,\n  Toolbar as MaterialToolbar,\n  Tooltip,\n  WithStyles,\n  createStyles,\n  withStyles,\n} from \"@material-ui/core\";\n\nimport { ProseMirrorToolbarContext } from \".\";\nimport { ProseMirrorToolbarIconButton } from \"../ProseMirrorToolbarIconButton\";\n\nimport ProseMirrorToolbarDropdown from \"../ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown\";\nimport { ProseMirrorToolbarGroup } from \"../ProseMirrorToolbarGroup\";\nimport { useRichTextEditorContext } from \"../RichTextEditor/RichTextEditorContext\";\nimport { ProseMirrorToolbarState } from \"./ProseMirrorToolbarState\";\nimport { SparklesIcon } from \"../SparklesIcon/SparklesIcon\";\nimport { Loader } from \"../Loader/Loader\";\n\nconst styles = createStyles({\n  root: {\n    minHeight: 35,\n    borderBottom: \"1px solid rgb(218, 220, 224)\",\n    flexWrap: \"wrap\",\n  },\n  group: {\n    display: \"flex\",\n  },\n  button: {\n    color: \"#333\",\n    height: 26,\n    alignSelf: \"center\",\n    textTransform: \"none\",\n    fontSize: 13,\n    textAlign: \"center\",\n  },\n  divider: {\n    borderRight: \"1px solid rgb(218, 220, 224)\",\n    height: 13,\n    margin: \"9px 4px\",\n  },\n  tooltip: {\n    fontSize: 12,\n    backgroundColor: \"#1A222D\",\n    maxWidth: 340\n  },\n  arrow: {\n    color: \"#1A222D\",\n  },\n});\n\nconst tooltips = {\n  ai: {\n    title: \"Use ChatGPT to improve your copy\"\n  },\n  contentStudio: {\n    title: \"Generate on-brand content at scale with Content Studio\"\n  }\n}\n\nexport interface ToolbarButton {\n  type: \"button\";\n  toolName: string;\n}\n\nexport interface ToolbarDropDown {\n  type: \"dropdown\";\n  label?: string;\n  toolNames: string[];\n}\n\nexport interface ToolbarGroup {\n  type: \"group\";\n  children: ToolbarElement[];\n}\n\nexport type ToolbarElement = ToolbarButton | ToolbarGroup | ToolbarDropDown;\n\nexport interface ProseMirrorToolbarProps extends WithStyles<typeof styles> {\n  toolbarState: ProseMirrorToolbarState | undefined;\n  layout: ToolbarElement[];\n  isLocked?: boolean;\n  params: Record<string, unknown>;\n}\n\nconst ProseMirrorToolbar: React.SFC<ProseMirrorToolbarProps> = (\n  props: ProseMirrorToolbarProps\n) => {\n  const { classes, layout, toolbarState, params } = props;\n  const richTextEditorContext = useRichTextEditorContext();\n  const group1 = layout.slice(0, 3);\n  const group2 = layout.slice(3);\n  const isAiToolEnabled =\n    (params?.tools as { ai: { disabled: boolean } })?.ai?.disabled !== true;\n  const isContentStudioEnabled = (params?.tools as { contentStudio: { disabled: boolean } })?.contentStudio?.disabled !== true;\n\n  const renderToolbarElement = (idx: number, element: ToolbarElement) => {\n    switch (element.type) {\n      case \"button\":\n        return (\n          <ProseMirrorToolbarIconButton\n            toolName={element.toolName}\n            isLocked={props.isLocked}\n            key={idx}\n          />\n        );\n      case \"dropdown\":\n        return (\n          <ProseMirrorToolbarDropdown\n            toolNames={element.toolNames}\n            label={element.label}\n            isLocked={props.isLocked}\n            key={idx}\n          />\n        );\n      case \"group\":\n        const toolVisible = (tool: ToolbarButton): boolean => {\n          const state =\n            toolbarState == null\n              ? null\n              : toolbarState.toolStates[tool.toolName];\n          return state == null ? true : state.visible;\n        };\n\n        const anyVisible =\n          element.children.findIndex(\n            (child) => child.type !== \"button\" || toolVisible(child)\n          ) !== -1;\n        return anyVisible ? (\n          <ProseMirrorToolbarGroup key={idx}>\n            {element.children.map((child, idx) =>\n              renderToolbarElement(idx, child)\n            )}\n          </ProseMirrorToolbarGroup>\n        ) : null;\n      default:\n        return null;\n    }\n  };\n\n  const showAIGenerateDialog = async () => {\n    try {\n      const {\n        prompt,\n        keywords,\n      } = await richTextEditorContext.dialogs.getAIPrompt({\n        variant: \"generate\",\n      });\n      await richTextEditorContext.actions.insertAIContent(prompt, keywords);\n    } catch {}\n  };\n\n  const launchContentStudio = async () => {\n    await richTextEditorContext.actions.insertContentStudioContent();\n  };\n\n  return (\n    <ProseMirrorToolbarContext.Provider\n      value={{\n        applyTool: (toolName: string) => {\n          if (!toolbarState) {\n            return;\n          }\n\n          const tool = toolbarState.tools.find((x) => x.name === toolName);\n          const areInlineStyles = Object.keys(toolbarState.toolStates).filter(\n            (x: any) =>\n              /inline_styles/.test(x) && toolbarState.toolStates[x].active\n          );\n          if (!tool) {\n            return;\n          }\n\n          if (areInlineStyles && areInlineStyles.length) {\n            const clearFormatting = toolbarState.tools.find(\n              (x) => x.name === \"clear_formatting\"\n            );\n\n            if (clearFormatting) {\n              clearFormatting.apply(\n                richTextEditorContext.proseMirrorEditorView.state,\n                richTextEditorContext.proseMirrorEditorView.dispatch,\n                richTextEditorContext\n              );\n            }\n          }\n\n          tool.apply(\n            richTextEditorContext.proseMirrorEditorView.state,\n            richTextEditorContext.proseMirrorEditorView.dispatch,\n            richTextEditorContext\n          );\n        },\n        getToolState: (toolName: string) => {\n          if (!toolbarState) {\n            return undefined;\n          }\n\n          return toolbarState.toolStates[toolName];\n        },\n      }}\n    >\n      <MaterialToolbar className={classes.root} disableGutters={true}>\n        <div className={classes.group}>\n          {isContentStudioEnabled ? (\n            <>\n            <Tooltip \n              title={tooltips.contentStudio.title} \n              arrow \n              classes={{\n                arrow: props.classes.arrow,\n                tooltip: props.classes.tooltip,\n              }}\n            >\n              <Button\n                disabled={richTextEditorContext.isLocked}\n                onClick={launchContentStudio}\n                className={classes.button}\n                size=\"small\"\n                startIcon={\n                  !richTextEditorContext.isLocked && (\n                    <SparklesIcon\n                      style={{ width: 15, height: 15 }}\n                      variant=\"content-studio\"\n                    ></SparklesIcon>\n                  )\n                }\n              >\n                {richTextEditorContext.isLocked ? (\n                  <Loader></Loader>\n                ) : (\n                  \"Content Studio\"\n                )}\n              </Button>\n            </Tooltip>\n            <div className={classes.divider}></div>\n          </>\n          ) : (\n            \"\"\n          )}\n          {isAiToolEnabled ? (\n            <>\n              <Tooltip \n                title={tooltips.ai.title} \n                arrow \n                classes={{\n                  arrow: props.classes.arrow,\n                  tooltip: props.classes.tooltip,\n                }}\n              >\n                <Button\n                  disabled={richTextEditorContext.isLocked}\n                  onClick={showAIGenerateDialog}\n                  className={classes.button}\n                  size=\"small\"\n                  startIcon={\n                    !richTextEditorContext.isLocked && (\n                      <SparklesIcon\n                        style={{ width: 15, height: 15 }}\n                      ></SparklesIcon>\n                    )\n                  }\n                >\n                  {richTextEditorContext.isLocked ? (\n                    <Loader></Loader>\n                  ) : (\n                    \"AI Assistant\"\n                  )}\n                </Button>\n              </Tooltip>\n              <div className={classes.divider}></div>\n            </>\n          ) : (\n            \"\"\n          )}\n          {group1.map((value, idx) => renderToolbarElement(idx, value))}\n        </div>\n        <div className={classes.group}>\n          {group2.map((value, idx) => renderToolbarElement(idx, value))}\n        </div>\n      </MaterialToolbar>\n    </ProseMirrorToolbarContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbar);\n","import { ToolbarElement } from \"../ProseMirrorToolbar\";\n\nexport default [\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"undo\" },\n      { type: \"button\", toolName: \"redo\" }\n    ]\n  },\n\n  {\n    type: \"dropdown\",\n    label: \"Styles\",\n    toolNames: [\n      \"paragraph\",\n      \"heading_1\",\n      \"heading_2\",\n      \"heading_3\",\n      \"heading_4\",\n      \"heading_5\",\n      \"heading_6\",\n      \"code_block\"\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"strong\" },\n      { type: \"button\", toolName: \"em\" },\n      { type: \"button\", toolName: \"soft_hyphen\" },\n      { type: \"button\", toolName: \"link\" },\n      { type: \"button\", toolName: \"anchor\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"align_left\" },\n      { type: \"button\", toolName: \"align_center\" },\n      { type: \"button\", toolName: \"align_right\" },\n      { type: \"button\", toolName: \"align_justify\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"lift\" },\n      { type: \"button\", toolName: \"bullet_list\" },\n      { type: \"button\", toolName: \"ordered_list\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"dc-image-link\" },\n      { type: \"button\", toolName: \"image\" },\n      { type: \"button\", toolName: \"dc-content-link\" },\n      { type: \"button\", toolName: \"blockquote\" },\n      { type: \"button\", toolName: \"code_block\" },\n      { type: \"button\", toolName: \"horizontal_rule\" },\n      { type: \"button\", toolName: \"table_create\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"table_row_add\" },\n      { type: \"button\", toolName: \"table_row_delete\" },\n      { type: \"button\", toolName: \"table_col_add\" },\n      { type: \"button\", toolName: \"table_col_delete\" },\n      { type: \"button\", toolName: \"table_delete\" },\n      { type: \"button\", toolName: \"clear_formatting\" }\n    ]\n  },\n\n  { type: \"button\", toolName: \"ai\" }\n] as ToolbarElement[];\n","const OPENAI_CHATGPT_DEFAULT_MODEL = \"gpt-3.5-turbo\";\n\nconst DEFAULT_EDIT_PROMPTS = [\n  {\n    label: \"Improve text\",\n    prompt: \"Improve this\",\n  },\n  {\n    label: \"Shorten\",\n    prompt: \"Shorten this\",\n  },\n  {\n    label: \"Make longer\",\n    prompt: \"Expand this\",\n  },\n];\n\nexport interface AIEditPrompt {\n  label: string;\n  prompt: string;\n}\n\nexport class AIConfiguration {\n  private params: any;\n\n  constructor(params: any) {\n    this.params = params;\n  }\n\n  public getKey(): string | undefined {\n    return this.params?.tools?.ai?.key;\n  }\n\n  public getModel(): string {\n    return this.params?.tools?.ai?.model || OPENAI_CHATGPT_DEFAULT_MODEL;\n  }\n\n  public getEditPrompts(): AIEditPrompt[] {\n    return this.params?.tools?.ai?.editPrompts || DEFAULT_EDIT_PROMPTS;\n  }\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M7.22967 1.19148C10.5588 1.19148 13.2688 3.89982 13.2688 7.22898C13.2688 10.5582 10.5588 13.2682 7.22967 13.2682C3.90051 13.2682 1.19217 10.5582 1.19217 7.22898C1.19217 3.89982 3.90051 1.19148 7.22967 1.19148ZM8.11384 5.44648L6.93301 9.62732C6.85301 9.91148 6.81384 10.079 6.81384 10.1323C6.81384 10.1957 6.83217 10.249 6.87051 10.289C6.90801 10.329 6.95384 10.3465 7.00467 10.3465C7.06467 10.3465 7.13551 10.3165 7.21967 10.2515C7.44551 10.074 7.67467 9.81732 7.90551 9.48815L8.11551 9.62565C7.84384 10.039 7.52551 10.3873 7.16051 10.6707C6.88967 10.8807 6.63134 10.9857 6.38467 10.9857C6.22134 10.9857 6.08884 10.9365 5.98551 10.839C5.88134 10.7423 5.82967 10.6198 5.82967 10.474C5.82967 10.3248 5.87967 10.0815 5.97884 9.73982L6.75467 7.06732C6.88134 6.62982 6.94551 6.35565 6.94551 6.24398C6.94551 6.15648 6.91467 6.08482 6.85384 6.02898C6.79134 5.97315 6.70717 5.94565 6.59967 5.94565C6.51217 5.94565 6.33134 5.96732 6.05717 6.01148V5.77898L8.11384 5.44648ZM8.03634 3.31398C8.20301 3.31398 8.34384 3.37148 8.45884 3.48732C8.57634 3.60315 8.63301 3.74398 8.63301 3.91148C8.63301 4.07398 8.57467 4.21398 8.45717 4.33148C8.33884 4.44898 8.19884 4.50732 8.03634 4.50732C7.87301 4.50732 7.73301 4.44898 7.61551 4.33148C7.49717 4.21398 7.43967 4.07398 7.43967 3.91148C7.43967 3.74398 7.49717 3.60315 7.61217 3.48732C7.72801 3.37148 7.86967 3.31398 8.03634 3.31398ZM7.22967 0.333984C3.42051 0.333984 0.333008 3.42065 0.333008 7.22982C0.333008 11.0382 3.42051 14.1257 7.22967 14.1257C11.0388 14.1257 14.1263 11.0373 14.1263 7.22898C14.1263 3.41982 11.0388 0.333984 7.22967 0.333984Z\",\n  fill: \"white\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"g\", {\n  mask: \"url(#mask0_11569_199)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M17 -3H-3V17H17V-3Z\",\n  fill: \"#333333\"\n}));\n\nvar SvgInfoIcon = function SvgInfoIcon(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 15,\n    height: 15,\n    viewBox: \"0 0 15 15\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, /*#__PURE__*/React.createElement(\"mask\", {\n    id: \"mask0_11569_199\",\n    style: {\n      maskType: \"alpha\"\n    },\n    maskUnits: \"userSpaceOnUse\",\n    x: 0,\n    y: 0,\n    width: 15,\n    height: 15\n  }, _ref2), _ref3);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgInfoIcon, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/info-icon.e895996c.svg\";\nexport { ForwardRef as ReactComponent };","import { AIPromptDialogOptions } from \"@dc-extension-rich-text/common\";\nimport {\n  Button,\n  Chip,\n  createStyles,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Grid,\n  IconButton,\n  InputAdornment,\n  Link,\n  SvgIcon,\n  TextField,\n  Tooltip,\n  Typography,\n  withStyles,\n  WithStyles,\n} from \"@material-ui/core\";\nimport { Close, Check, Info } from \"@material-ui/icons\";\nimport pointer from \"json-pointer\";\nimport clsx from \"clsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { AIConfiguration } from \"./AIConfiguration\";\nimport { SparklesIcon } from \"../SparklesIcon/SparklesIcon\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\nimport { SDK } from \"dc-extensions-sdk\";\nimport { ReactComponent as InfoIcon } from \"./info-icon.svg\";\n\nconst styles = createStyles({\n  root: {\n    minWidth: 440,\n  },\n  configureContent: {\n    maxWidth: \"50%\",\n  },\n  configureGraphic: {\n    width: 550,\n    position: \"absolute\" as \"absolute\",\n    right: 0,\n    top: -60,\n  },\n  getStartedAction: {\n    backgroundColor: \"rgba(255,255,255,0.9)\",\n    borderRadius: 20,\n    padding: \"5px 15px\",\n  },\n  cancelAction: {\n    color: \"white\",\n  },\n  button: {\n    marginLeft: \"auto\",\n    textTransform: \"none\",\n    \"&:hover\": {\n      backgroundColor: \"#1ab0f9\",\n      color: \"#fff\",\n    },\n  },\n  keywordsContainer: {\n    marginBottom: \"12px\",\n  },\n  chip: {\n    color: \"#fff\",\n    fontSize: 13,\n    height: \"24px\",\n  },\n  keywordCheckIcon: {\n    color: \"#fff\",\n  },\n  infoIcon: {\n    height: \"15px\",\n    width: \"15px\",\n    transform: \"translateY(25%)\",\n    marginLeft: \"5px\",\n  },\n  tooltip: {\n    fontSize: 12,\n    backgroundColor: \"#1A222D\",\n  },\n  arrow: {\n    color: \"#1A222D\",\n  },\n});\n\ninterface AIPromptDialogProps\n  extends AIPromptDialogOptions,\n    WithStyles<typeof styles> {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: { prompt: string; keywords: string[] }) => void;\n  params: any;\n}\n\nfunction CloseButton(props: any) {\n  return (\n    <IconButton\n      aria-label=\"Close\"\n      {...props}\n      style={{ marginLeft: \"auto\" }}\n      disableFocusRipple={true}\n      disableRipple={true}\n    >\n      <Close style={{ width: 24, height: 24 }}></Close>\n    </IconButton>\n  );\n}\n\nfunction DialogHeader(props: any) {\n  const { onClose, title } = props;\n  return (\n    <DialogTitle style={{ paddingBottom: 0 }}>\n      <div style={{ display: \"flex\", alignItems: \"center\", gap: \"10px\" }}>\n        <SparklesIcon></SparklesIcon>\n        <span style={{ fontSize: \"16px\", fontWeight: 500, color: \"#333\" }}>\n          {title}\n        </span>\n        <CloseButton onClick={onClose}></CloseButton>\n      </div>\n    </DialogTitle>\n  );\n}\n\nasync function getKeywords(sdk: SDK) {\n  type Params = {\n    language: string;\n    keywordSource: string;\n  };\n  const params = {\n    ...sdk.params.installation,\n    ...sdk.params.instance,\n  } as Params;\n  const form = await sdk.form.getValue().catch(() => ({}));\n\n  try {\n    return pointer.get(form, params.keywordSource);\n  } catch (e) {\n    return \"\";\n  }\n}\n\nfunction SeoKeywords(props: any) {\n  const infoTooltipString =\n    \"Optimize your AI prompt by importing data from other fields such as SEO keywords, titles, and descriptions.\";\n\n  const chipStyles = props.useKeywords\n    ? {}\n    : {\n        backgroundColor: \"#F7F9F9\",\n        color: \"#002C42\",\n      };\n\n  return (\n    <Grid\n      container\n      className={props.classes.keywordsContainer}\n      spacing={1}\n      alignItems=\"center\"\n    >\n      <Grid item>\n        <Typography variant=\"caption\">Optimize for SEO using:</Typography>\n        <Tooltip\n          title={infoTooltipString}\n          arrow\n          classes={{\n            arrow: props.classes.arrow,\n            tooltip: props.classes.tooltip,\n          }}\n        >\n          <SvgIcon viewBox=\"0 0 15 15\" className={props.classes.infoIcon}>\n            <InfoIcon />\n          </SvgIcon>\n        </Tooltip>\n      </Grid>\n\n      <Grid item>\n        <Tooltip\n          title={props.keywords.join(\", \")}\n          arrow\n          classes={{\n            arrow: props.classes.arrow,\n            tooltip: props.classes.tooltip,\n          }}\n        >\n          <Chip\n            icon={\n              props.useKeywords ? (\n                <Check\n                  fontSize=\"small\"\n                  className={props.classes.keywordCheckIcon}\n                />\n              ) : (\n                undefined\n              )\n            }\n            label=\"SEO Keywords\"\n            color=\"primary\"\n            className={props.classes.chip}\n            style={chipStyles}\n            onClick={() => props.handleKeywordClick()}\n          />\n        </Tooltip>\n      </Grid>\n    </Grid>\n  );\n}\n\nconst AIPromptDialogContent: React.SFC<any> = (props: AIPromptDialogProps) => {\n  const { sdk } = React.useContext(SdkContext);\n  const { variant = \"generate\", onSubmit, classes, onClose } = props;\n  const [prompt, setPrompt] = useState(\"\");\n  const [keywords, setKeywords] = useState<string[]>([]);\n  const [useKeywords, setUseKeywords] = useState<boolean>(true);\n\n  useEffect(() => {\n    getKeywords(sdk as SDK).then((keywords) => {\n      if (keywords) {\n        setKeywords(\n          keywords.split(\",\").map((keyword: string) => keyword.trim())\n        );\n      }\n    });\n  }, []);\n\n  const strings = {\n    generate: {\n      title: \"What do you want to write about?\",\n      placeholder:\n        \"For the best results, be as specific and detailed as possible\",\n      button: \"Generate\",\n    },\n    rewrite: {\n      title: \"Tell us how to rewrite the text\",\n      placeholder:\n        \"For the best results, be as specific and detailed as possible\",\n      button: \"Rewrite\",\n    },\n  }[variant];\n\n  const handlePromptChange = (event: any) => {\n    setPrompt(event.target.value);\n  };\n\n  const handleSubmit = async () => {\n    const submitPayload = { prompt, keywords: useKeywords ? keywords : [] };\n    onSubmit(submitPayload);\n  };\n\n  const handleKeyUp = (event: any) => {\n    if (event.key === \"Enter\" || event.keyCode === 13) {\n      handleSubmit();\n    }\n  };\n\n  const handleKeywordClick = () => {\n    setUseKeywords(!useKeywords);\n  };\n\n  return (\n    <>\n      <DialogHeader\n        classes={classes}\n        onClose={onClose}\n        title={strings.title}\n      ></DialogHeader>\n      <DialogContent>\n        {keywords.length ? (\n          <SeoKeywords\n            classes={classes}\n            useKeywords={useKeywords}\n            keywords={keywords}\n            handleKeywordClick={handleKeywordClick}\n          />\n        ) : (\n          undefined\n        )}\n        <TextField\n          value={prompt}\n          placeholder={strings.placeholder}\n          onChange={handlePromptChange}\n          onKeyUp={handleKeyUp}\n          multiline\n          rowsMax={9}\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <Button\n                  onClick={handleSubmit}\n                  variant=\"outlined\"\n                  color=\"primary\"\n                  className={classes.button}\n                  disableElevation={true}\n                  disabled={!prompt.length}\n                >\n                  {strings.button}\n                </Button>\n              </InputAdornment>\n            ),\n          }}\n          fullWidth={true}\n          variant=\"outlined\"\n        />\n        <Typography variant=\"caption\">\n          Powered by ChatGPT API.{\" \"}\n          <Link\n            underline=\"none\"\n            href=\"https://amplience.com/developers/docs/ai-services/generative-rich-text-editor\"\n            target=\"_blank\"\n          >\n            Learn more\n          </Link>\n        </Typography>\n      </DialogContent>\n      <DialogActions />\n    </>\n  );\n};\n\nconst AIPromptDialog: React.SFC<AIPromptDialogProps> = (\n  props: AIPromptDialogProps\n) => {\n  const { open, onClose, classes } = props;\n  const configuration = new AIConfiguration(props.params);\n\n  return (\n    <Dialog\n      maxWidth=\"sm\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n      className={clsx(classes.root)}\n    >\n      <AIPromptDialogContent {...props} configuration={configuration} />\n    </Dialog>\n  );\n};\n\nexport default withStyles(styles)(AIPromptDialog);\n","const aptrinsicId = process.env.REACT_APP_APTRINSIC_ID;\n\nexport function initGainsight() {\n  if (!aptrinsicId) {\n    return;\n  }\n  window.aptrinsic = function() {\n    (window.aptrinsic.q = window.aptrinsic.q || []).push(arguments);\n  };\n\n  window.aptrinsic.p = aptrinsicId;\n  window.aptrinsic.c = { allowCrossDomain: true };\n\n  const script = window.document.createElement(\"script\");\n  script.async = true;\n  script.src = `https://web-sdk.aptrinsic.com/api/aptrinsic.js?a=${aptrinsicId}`;\n  const s = window.document.getElementsByTagName(\"script\")[0];\n  s.parentNode?.insertBefore(script, s);\n}\n\nexport function track(\n  win: Window & typeof globalThis,\n  eventName: string,\n  value: any\n) {\n  if (win.aptrinsic) {\n    win.aptrinsic(\"track\", eventName, value);\n  }\n}\n","import { datadogRum } from \"@datadog/browser-rum\";\nimport {\n  Alert,\n  RichTextActions,\n  RichTextEditorContextProps,\n} from \"@dc-extension-rich-text/common\";\nimport { MarkdownLanguage } from \"@dc-extension-rich-text/language-markdown\";\nimport { Assistant as AssistantIcon } from \"@material-ui/icons\";\nimport { fetchEventSource } from \"@microsoft/fetch-event-source\";\nimport React from \"react\";\nimport { AIConfiguration } from \"../AIPromptDialog\";\nimport { track } from \"../gainsight\";\nimport { AmplienceContentStudio } from '@amplience/content-studio-sdk';\n\ninterface ChatModel {\n  name: string;\n  version: string;\n  maxTokens: number;\n}\n\nconst CHAT_COMPLETIONS_URL = \"https://api.openai.com/v1/chat/completions\";\nconst CHAT_ESTIMATED_CHARS_PER_TOKEN = 4;\nconst CHAT_MODELS: ChatModel[] = [\n  {\n    name: \"gpt-3.5-turbo\",\n    version: \"gpt-3.5\",\n    maxTokens: 4096,\n  },\n  {\n    name: \"gpt-3.5-turbo-16k\",\n    version: \"gpt-3.5\",\n    maxTokens: 16384,\n  },\n  {\n    name: \"gpt-4\",\n    version: \"gpt-4\",\n    maxTokens: 8192,\n  },\n  {\n    name: \"gpt-4-32k\",\n    version: \"gpt-4\",\n    maxTokens: 32768,\n  },\n];\nconst DIALOG_PREFIX = \"[DIALOG]\";\n\nfunction getSuitableModel(\n  desiredModelName: string,\n  estimatedConsumedTokens: number\n): string {\n  const desiredModel = CHAT_MODELS.find((x) => x.name === desiredModelName);\n\n  if (desiredModel && estimatedConsumedTokens > desiredModel.maxTokens) {\n    const rightSizeModel = CHAT_MODELS.find(\n      (x) =>\n        x.version === desiredModel.version &&\n        x.maxTokens > estimatedConsumedTokens\n    );\n    return rightSizeModel?.name || desiredModelName;\n  } else {\n    return desiredModelName;\n  }\n}\n\nfunction getDelta(usesKey: any, data: string) {\n  const payload = JSON.parse(data);\n  if (usesKey) {\n    return payload?.choices?.[0]?.delta?.content;\n  }\n  return payload?.content;\n}\n\nasync function getCompletionUrl(\n  sdk: any,\n  hub: any,\n  configuration: AIConfiguration,\n  prompts: any\n): Promise<string> {\n  const hasKey = configuration.getKey();\n  const convertRolesToUppercase = ({ role, content }: any) => ({\n    role: role.toUpperCase(),\n    content,\n  });\n\n  if (hasKey) {\n    return CHAT_COMPLETIONS_URL;\n  }\n\n  const { data } = await sdk.connection.request(\n    \"dc-management-sdk-js:graphql-mutation\",\n    {\n      mutation: `mutation generateRichText($orgId: ID!, $prompts:[RichTextGenerationPrompt!]!) {\n        generateRichText(\n          input: {\n           organizationId: $orgId,\n           prompts: $prompts\n         }\n        ) {\n          url\n        }\n      }`,\n      vars: {\n        orgId: btoa(`Organization:${hub.organizationId}`),\n        prompts: prompts.map(convertRolesToUppercase),\n      },\n    }\n  );\n\n  return data.generateRichText.url;\n}\n\nasync function invokeChatCompletions(\n  sdk: any,\n  hub: any,\n  configuration: AIConfiguration,\n  body: any,\n  onMessage: (buffer: string, complete: boolean) => void,\n  onError: (error: any) => void\n): Promise<void> {\n  const maxOutputTokens = 2048;\n  const estimatedInputTokens =\n    body.messages\n      .map((x: any) => x.content.length)\n      .reduce((partialSum: number, a: number) => partialSum + a, 0) /\n    CHAT_ESTIMATED_CHARS_PER_TOKEN;\n  const estimatedConsumedTokens = maxOutputTokens + estimatedInputTokens;\n  let markdownBuffer = \"\";\n  try {\n    const completionUrl = await getCompletionUrl(\n      sdk,\n      hub,\n      configuration,\n      body.messages\n    );\n    const key = configuration.getKey();\n    const headers = {\n      \"Content-Type\": \"application/json\",\n      ...(key ? { Authorization: `Bearer ${key}` } : {}),\n    };\n\n    await fetchEventSource(completionUrl, {\n      headers,\n      method: key ? \"POST\" : \"GET\",\n      ...(key\n        ? {\n            body: JSON.stringify({\n              model: getSuitableModel(\n                configuration.getModel(),\n                estimatedConsumedTokens\n              ),\n              max_tokens: maxOutputTokens,\n              stream: true,\n              ...body,\n            }),\n          }\n        : {}),\n      onmessage: (e) => {\n        try {\n          if (e.data === \"[DONE]\" || e?.event === \"end\") {\n            onMessage(markdownBuffer, true);\n            return;\n          }\n\n          const delta = getDelta(key, e.data);\n          if (delta !== undefined) {\n            markdownBuffer += delta;\n            onMessage(markdownBuffer, false);\n          }\n        } catch (err) {}\n      },\n      async onopen(response): Promise<void> {\n        if (key) {\n          track(window, \"AI Own OpenAI used\", {\n            name: \"dc-extension-rich-text\",\n            category: \"Extension\",\n          });\n        } else {\n          track(window, \"AI Credits used\", {\n            name: \"dc-extension-rich-text\",\n            category: \"Extension\",\n          });\n        }\n        const contentType = response.headers.get(\"content-type\");\n        if (contentType?.startsWith(\"application/json\")) {\n          onError(await response.json());\n          return;\n        }\n        if (\n          !(contentType === null || contentType.startsWith(\"text/event-stream\"))\n        ) {\n          throw new Error(\n            `Expected content-type to be 'text/event-stream', Actual: ${contentType}`\n          );\n        }\n      },\n      onerror(err): void {\n        throw err;\n      },\n    });\n  } catch (e) {\n    return onError(e);\n  }\n}\n\nexport class RichTextActionsImpl implements RichTextActions {\n  private context: RichTextEditorContextProps | undefined;\n\n  public setRichTextEditorContext(context: RichTextEditorContextProps): void {\n    this.context = context;\n  }\n\n  public formatRewritePrompt(\n    body: string,\n    selection: string,\n    prompt: string\n  ): string {\n    return `This is the original content I am starting with: \n---\n${body}\n---\nThis is the selection I want to update:\n---\n${selection}\n---\nThis is the description of the change I want to make:\n---\n${prompt}`;\n  }\n\n  public async rewriteSelectedContentUsingAI(\n    prompt: string,\n    keywords: string[]\n  ): Promise<void> {\n    try {\n      datadogRum.addAction(\"rewriteSelectedContentUsingAI\", { prompt });\n    } catch (err) {}\n\n    const { proseMirrorEditorView, language } = this.context || {};\n\n    const { state } = proseMirrorEditorView;\n\n    const from = state.selection.from;\n    const to = state.selection.to;\n\n    const content = state.doc.cut(from, to);\n\n    const bodyMarkdown = (language as MarkdownLanguage).serializeMarkdown(\n      state.doc\n    );\n    const selectionMarkdown = (language as MarkdownLanguage).serializeMarkdown(\n      content\n    );\n\n    const sampleDocument = `# Say Cheese: The Ultimate Guide to Cheese\n\nCheese, the dairy product that has a special place in everyone's hearts, is a versatile ingredient that has been enjoyed for thousands of years across the globe. You can melt it, slice it, crumble it, or grate it - whatever way you choose, cheese always adds an extra dimension to any dish. In this ultimate guide to cheese, you'll learn everything you need to know about the world's favorite dairy product.\n\n## History of Cheese\n\nThe origin of cheese can be traced back to ancient times. Even before recorded history, it is believed that the process of cheesemaking was discovered accidentally by storing milk in animal bladders or stomachs, causing it to curdle and form cheese. Cheese quickly became a staple in the diets of people around the world and is now enjoyed in cultures all across the globe.\n\n## Types of Cheese\n\nThere are thousands of different types of cheese, each with its own flavor, texture, and aroma. From mild and creamy Brie to sharp and nutty Cheddar, there is a cheese for every taste preference. Some popular varieties of cheese include:\n\n* Cheddar\n\n* Brie\n\n* Mozzarella\n\n* Parmesan\n\n* Feta\n\n* Blue Cheese\n\n* Gouda\n\n## Conclusion\n\nCheese is a delicious and versatile ingredient that can be enjoyed in a variety of ways. From its humble beginnings thousands of years ago to its place as one of the world's most popular dairy products, cheese has a special place in the hearts of people around the world. So, let's raise a glass of wine and say cheese!`;\n\n    const sampleSelection = `You can melt it, slice it, crumble it, or grate it - whatever way you choose, cheese always adds an extra dimension to any dish.`;\n    const sampleResponse = `You can melt, slice, crumble, or grate it - cheese enhances any dish.`;\n\n    return this.handleInsertAIContent({\n      messages: [\n        {\n          role: \"system\",\n          content: `I want you to act as an editor for marketing copy.\n  - You will receive the original markdown document, followed by a selection from the document that the user wants to change, followed by a description of the change you should make.\n  - You should reply with a markdown formatted string that can replace the provided selection.\n\nDo not produce more content than you were originally provided unless specifically requested. \n  - If the selection includes only a header, reply with only a header. \n  - If the selection includes only a bullet point, reply with only a bullet point. \n  - If the selection includes only one line, reply with only one line. \n  - If the user asks you to make the selection longer, you can expand on the provided selection, but do not produce any additional elements.\n  - For example, if given a header, and asked to make it longer, you can add more text to the header, but you should not add any more lines.\n\nIf the user requests a change that you cannot produce a reasonable replacement for, you should respond with an error. \n  - Return errors sparingly, try to make a best effort attempt at handling the user's request whenever possible.\n  - If you return an error, prefix it with \\`[DIALOG]\\`. \n  - For example, if the user provides the selection \\`Banana\\` and asks you to shorten it, you might reply: \\`[DIALOG] I can't shorten \"Banana\" any further.\\`.\n\nDo not converse with the user. \n  - Do not ask clarifying questions. \n  - Do not add conversational preamble such as \\`Sure, I can do that\\`, or \\`Ok, here's the change\\`.\n  \n  ${\n    keywords.length\n      ? `Optimize the text for SEO following SEO best practices.\n   - Include the following keywords: ${keywords.join(\", \")}\n   `\n      : \"\"\n  }`,\n        },\n        {\n          role: \"user\",\n          content: this.formatRewritePrompt(\n            sampleDocument,\n            sampleSelection,\n            `Shorten this`\n          ),\n        },\n        {\n          role: \"assistant\",\n          content: sampleResponse,\n        },\n        {\n          role: \"user\",\n          content: this.formatRewritePrompt(\n            bodyMarkdown,\n            selectionMarkdown,\n            prompt\n          ),\n        },\n      ],\n    });\n  }\n\n  public async insertAIContent(\n    prompt: string,\n    keywords: string[]\n  ): Promise<void> {\n    try {\n      datadogRum.addAction(\"insertAIContent\", { prompt });\n    } catch (err) {}\n\n    return this.handleInsertAIContent({\n      messages: [\n        {\n          role: \"system\",\n          content: `I want you to act as a copywriter that produces markdown formatted content for marketing.\n  - You will receive a prompt from the user.\n  - You should reply with a markdown document that can be used in marketing materials.\n  - Do not include hyperlinks in your response.\n  - Do not include images in your response.\n\nIf the user's prompt asks for only a portion of a document, you should return only that portion.\n  - If the user asks for only a title, produce only a title.\n  - If the user asks for only a paragraph, produce only a paragraph.\n  - If the user asks for only a bullet list, produce only a bullet list.\n\nIf the user provides a prompt that you cannot produce a document for, you should return an error.\n  - Prefix any errors with [DIALOG].\n  - For example, if the user's prompt is \\`Hello?\\`, then you might respond with \\`[DIALOG] Please describe the content you want to generate.\\`\n\nDo not converse with the user.\n  - Do not ask clarifying questions.\n  - Do not add conversational preamble such as \\`Sure, I can do that\\`, or \\`Ok, here's the change\\`.\n  - Do not include [DIALOG] if you've successfully produced a document.\n  \n  ${\n    keywords.length\n      ? `Optimize the text for SEO following SEO best practices.\n   - Include the following keywords: ${keywords.join(\", \")}\n   `\n      : \"\"\n  }`,\n        },\n        {\n          role: \"user\",\n          content: prompt,\n        },\n      ],\n    });\n  }\n\n  public async handleInsertAIContent(payload: any): Promise<void> {\n    const {\n      proseMirrorEditorView,\n      setIsLocked,\n      params,\n      language,\n    } = this.context!;\n    const configuration = new AIConfiguration(params);\n\n    const { dispatch } = proseMirrorEditorView;\n    let { state } = proseMirrorEditorView;\n\n    setIsLocked(true);\n\n    let startPosition = state.selection?.from ?? state.doc.content.size;\n    let endPosition = state.selection?.to || startPosition;\n\n    const resolved = state.doc.resolve(startPosition, endPosition);\n    const isEmptyParagraph =\n      resolved?.parent?.type?.name === \"paragraph\" &&\n      resolved?.parent?.content?.size === 0;\n\n    if (isEmptyParagraph) {\n      startPosition--;\n    }\n\n    let alert: Alert | undefined;\n\n    this.context!.setShowCreditsError(false);\n\n    try {\n      await invokeChatCompletions(\n        this.context?.sdk as any,\n        this.context?.hub as any,\n        configuration,\n        payload,\n        (buffer, complete) => {\n          const isEmpty = buffer.length === 0;\n          const isDialog = buffer.startsWith(DIALOG_PREFIX);\n          const couldBeDialog =\n            !complete &&\n            buffer.length < DIALOG_PREFIX.length &&\n            buffer === DIALOG_PREFIX.slice(0, buffer.length);\n\n          if (isDialog) {\n            const content = buffer.slice(DIALOG_PREFIX.length);\n            if (!alert) {\n              alert = this.context!.dialogs.alert({\n                title: \"AI Assistant\",\n                icon: <AssistantIcon />,\n                severity: \"info\",\n                content,\n              });\n            } else {\n              alert.updateContent(content);\n            }\n            setIsLocked(false);\n            return;\n          }\n\n          if (isEmpty || couldBeDialog) {\n            return;\n          }\n\n          let fragment = (language as MarkdownLanguage).parseMarkdown(\n            buffer.trim()\n          ).content;\n\n          if (fragment.content.length === 1) {\n            fragment = fragment.content[0].content;\n          }\n\n          const transaction = state.tr.replaceWith(\n            startPosition,\n            endPosition,\n            fragment\n          );\n          const newState = dispatch(transaction);\n          state = newState;\n          endPosition = Math.max(\n            state.selection?.to,\n            startPosition + fragment.size\n          );\n        },\n        (err) => {\n          if (\n            err?.data?.errors?.[0]?.extensions?.code === \"INSUFFICIENT_CREDITS\"\n          ) {\n            track(window, \"AI Credits Limit reached\", {\n              name: \"dc-extension-rich-text\",\n              category: \"Extension\",\n            });\n            this.context!.setShowCreditsError(true);\n          }\n          if (err?.error?.message) {\n            this.context!.dialogs.alert({\n              title: \"AI Assistant\",\n              icon: <AssistantIcon />,\n              severity: \"error\",\n              content: err?.error?.message,\n            });\n          }\n        }\n      );\n    } catch {}\n\n    this.context?.setIsLocked(false);\n  }\n\n  public async insertContentStudioContent(): Promise<void> {\n    try {\n      const { proseMirrorEditorView, params, language } = this.context!;\n      const { dispatch } = proseMirrorEditorView;\n      let { state } = proseMirrorEditorView;\n\n      const studio = new AmplienceContentStudio({\n        baseUrl:\n          params?.tools?.contentStudio?.baseUrl ||\n          \"https://app.amplience.net/content-studio\",\n      });\n\n      const { content } = await studio.getContent();\n      const textFields = Object.values(content)\n        .filter((x) => typeof x === \"string\") as string[];\n\n      if (textFields.length > 0) {\n        let fragment = (language as MarkdownLanguage).parseMarkdown(\n          textFields[0].trim()\n        ).content;\n\n        if (fragment.content.length === 1) {\n          fragment = fragment.content[0].content;\n        }\n\n        let startPosition = state.selection?.from ?? state.doc.content.size;\n        let endPosition = state.selection?.to || startPosition;\n\n        const transaction = state.tr.replaceWith(\n          startPosition,\n          endPosition,\n          fragment\n        );\n\n        dispatch(transaction);\n      }\n    } catch (err) {}\n  }\n}\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField,\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Anchor } from \"@dc-extension-rich-text/common\";\n\ninterface AnchorDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Anchor) => void;\n  value: {\n    existing: Set<string>;\n    value: any;\n  };\n}\n\nconst htmlIdRegex = /^[a-zA-Z][\\w:.-]*$/;\n\nfunction validateId(value: string, existing: Set<string>): string | undefined {\n  if (value == null || value.length === 0) {\n    return \"ID cannot be empty.\";\n  }\n\n  if (!htmlIdRegex.test(value)) {\n    return \"Invalid ID.\";\n  }\n\n  if (existing.has(value)) {\n    return \"ID is already in use.\";\n  }\n\n  return undefined;\n}\n\nconst AnchorDialog: React.SFC<AnchorDialogProps> = (\n  props: AnchorDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n  const existing = props.value ? props.value.existing : new Set<string>();\n\n  const [value, setValue] = React.useState<Anchor>({\n    value: \"\",\n  });\n\n  const [lastValue, setLastValue] = React.useState<Anchor>();\n\n  if (\n    props.value != null &&\n    props.value.value != null &&\n    lastValue !== props.value.value\n  ) {\n    setValue(props.value.value);\n    setLastValue(props.value.value);\n  }\n\n  const validate = (checkValue: string) => validateId(checkValue, existing);\n\n  const valid = validate(value.value);\n  const [validError, setValidError] = React.useState<string | undefined>(valid);\n  if (valid !== validError) {\n    setValidError(valid);\n  }\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue,\n      };\n\n      setValue(newValue);\n      const error = validate(newValue.value);\n      setValidError(error);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [value, setValue, setValidError]\n  );\n\n  const reset = () => {\n    setValue({\n      value: \"\",\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Anchor</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            error={validError !== undefined}\n            autoFocus={true}\n            id=\"value\"\n            label=\"Anchor ID\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.value}\n            onChange={(event) =>\n              handleInputChanged(\"value\", event.target.value)\n            }\n            helperText={validError}\n          />\n          <FormHelperText>Example: paragraph-4</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button\n          disabled={validError !== undefined}\n          onClick={handleSubmit}\n          color=\"primary\"\n        >\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default AnchorDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField,\n} from \"@material-ui/core\";\nimport React from \"react\";\n\ninterface CodeDialogProps {\n  value?: string;\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: string) => void;\n}\n\nconst htmlIdRegex = /^[a-zA-Z]?[\\w:.\\-/]*$/;\n\nconst validate = (checkValue: string) =>\n  !htmlIdRegex.test(checkValue) ? \"Value contains invalid characters\" : \"\";\n\nconst CodeDialog: React.SFC<CodeDialogProps> = (props: CodeDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<string>(\"\");\n\n  const [validError, setValidError] = React.useState<string>(\"\");\n\n  const [lastValue, setLastValue] = React.useState<string>();\n\n  if (lastValue !== props.value) {\n    setValue(props.value || \"\");\n    setLastValue(props.value);\n  }\n\n  const handleInputChanged = React.useCallback(\n    (val) => {\n      setValue(val || \"\");\n\n      const error = validate(val);\n      setValidError(error);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [value, setValue, setValidError]\n  );\n\n  const reset = () => {\n    setValue(\"\");\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Code block</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            error={!!validError}\n            helperText={validError}\n            autoFocus={true}\n            id=\"href\"\n            label=\"Language\"\n            type=\"input\"\n            fullWidth={true}\n            value={value}\n            onChange={(event) => handleInputChanged(event.target.value || \"\")}\n          />\n          <FormHelperText>\n            The language to use for syntax highlighting, e.g. javascript or html\n          </FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!!validError} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default CodeDialog;\n","import {\n  Button,\n  Checkbox,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  FormControlLabel,\n  FormHelperText,\n  TextField,\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Hyperlink } from \"@dc-extension-rich-text/common\";\n\ninterface HyperlinkDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Hyperlink) => void;\n  value: any;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst HyperlinkDialog: React.SFC<HyperlinkDialogProps> = (\n  props: HyperlinkDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Hyperlink>({\n    href: \"\",\n    title: \"\",\n    openInNewTab: false, // Initialize with default value\n  });\n\n  const [lastValue, setLastValue] = React.useState<Hyperlink>();\n\n  if (props.value != null && lastValue !== props.value) {\n    setValue(props.value);\n    setLastValue(props.value);\n  }\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: any) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue,\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.href));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      href: \"\",\n      title: \"\",\n      openInNewTab: false,\n    });\n    setLastValue(undefined);\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    if (lastValue === undefined) {\n      onClose();\n    } else {\n      onSubmit({ ...lastValue, cancel: true });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [lastValue, setLastValue, onSubmit]);\n\n  const handleClear = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={handleCancel}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Hyperlink</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"href\"\n            label=\"Web Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.href}\n            onChange={(event) => handleInputChanged(\"href\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://www.storefront.com/black-friday\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={(event) =>\n              handleInputChanged(\"title\", event.target.value)\n            }\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={!!value.openInNewTab}\n                onChange={(event) =>\n                  handleInputChanged(\"openInNewTab\", event.target.checked)\n                }\n                color=\"primary\"\n              />\n            }\n            label=\"Open in new tab\"\n          />\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClear} color=\"primary\">\n          Clear\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default HyperlinkDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField,\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Image } from \"@dc-extension-rich-text/common\";\n\ninterface ImageDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Image) => void;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst ImageDialog: React.SFC<ImageDialogProps> = (props: ImageDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Image>({\n    src: \"\",\n    alt: \"\",\n    title: \"\",\n  });\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue,\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.src));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      src: \"\",\n      alt: \"\",\n      title: \"\",\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Insert Image from URL</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"src\"\n            label=\"Image Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.src}\n            onChange={(event) => handleInputChanged(\"src\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://cdn.storefront.com/image.jpg\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Image Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={(event) =>\n              handleInputChanged(\"title\", event.target.value)\n            }\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"alt\"\n            label=\"Image Alternative Text\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.alt}\n            onChange={(event) => handleInputChanged(\"alt\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Insert\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ImageDialog;\n","import { RichTextDialogs } from \"@dc-extension-rich-text/common\";\nimport React from \"react\";\n\nexport interface RichTextDialogsContext {\n  dialogs?: RichTextDialogs;\n}\n\nconst context = React.createContext<RichTextDialogsContext>({});\nexport default context;\n","import { AlertSeverity } from \"@dc-extension-rich-text/common\";\nimport {\n  darken,\n  IconButton,\n  lighten,\n  Theme,\n  Typography,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport { Close as CloseIcon } from \"@material-ui/icons\";\nimport clsx from \"clsx\";\nimport React, { PropsWithChildren } from \"react\";\n\nconst styles = (theme: Theme) => ({\n  root: {\n    ...theme.typography.body2,\n    display: \"flex\",\n    flexDirection: \"row\" as \"row\",\n    maxWidth: 300,\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: \"transparent\",\n    padding: \"6px 16px\"\n  },\n\n  success: {\n    color: darken(theme.palette.success.main, 0.6),\n    backgroundColor: lighten(theme.palette.success.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.success.main\n    }\n  },\n\n  info: {\n    color: darken(theme.palette.info.main, 0.6),\n    backgroundColor: lighten(theme.palette.info.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.info.main\n    }\n  },\n\n  warning: {\n    color: darken(theme.palette.warning.main, 0.6),\n    backgroundColor: lighten(theme.palette.warning.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.warning.main\n    }\n  },\n\n  error: {\n    color: darken(theme.palette.error.main, 0.6),\n    backgroundColor: lighten(theme.palette.error.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.error.main\n    }\n  },\n\n  title: {\n    fontWeight: theme.typography.fontWeightMedium\n  },\n\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\" as \"row\"\n  },\n\n  content: {\n    padding: \"8px 0\"\n  },\n\n  icon: {\n    marginRight: 12,\n    padding: \"7px 0\",\n    display: \"flex\",\n    fontSize: 22,\n    opacity: 0.9\n  },\n\n  action: {\n    display: \"flex\",\n    alignItems: \"center\",\n    marginLeft: \"auto\",\n    paddingLeft: 16,\n    marginRight: -8\n  }\n});\n\nexport interface RichTextAlertProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {\n  severity: AlertSeverity;\n  title: string;\n  icon?: React.ReactElement;\n  onClose?: () => void;\n}\n\nconst RichTextAlert = (props: RichTextAlertProps) => {\n  const { classes, children, severity, title, icon, onClose } = props;\n\n  return (\n    <div\n      className={clsx(\n        classes.root,\n        {\n          info: classes.info,\n          success: classes.success,\n          error: classes.error,\n          warning: classes.warning\n        }[severity]\n      )}\n    >\n      <div className={classes.icon}>{icon}</div>\n      <div className={classes.content}>\n        <div className={classes.header}>\n          <Typography variant=\"body1\" className={classes.title}>\n            {title}\n          </Typography>\n        </div>\n        {children}\n      </div>\n      <div className={classes.action}>\n        <IconButton onClick={onClose} size=\"small\" color=\"inherit\">\n          <CloseIcon />\n        </IconButton>\n      </div>\n    </div>\n  );\n};\n\nexport default withStyles(styles)(RichTextAlert);\n","import React, { PropsWithChildren } from \"react\";\n\nimport {\n  AIPromptDialogOptions,\n  Alert,\n  AlertOptions,\n  Anchor,\n  Hyperlink,\n  Image,\n  RichTextDialogs,\n} from \"@dc-extension-rich-text/common\";\n\nimport AnchorDialog from \"../AnchorDialog/AnchorDialog\";\nimport CodeDialog from \"../CodeDialog/CodeDialog\";\nimport HyperlinkDialog from \"../HyperlinkDialog/HyperlinkDialog\";\nimport ImageDialog from \"../ImageDialog/ImageDialog\";\nimport RichTextDialogsContext from \"./RichTextDialogsContext\";\n\nimport { Snackbar } from \"@material-ui/core\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\nimport { AIPromptDialog } from \"../AIPromptDialog\";\nimport RichTextAlert from \"./RichTextAlert\";\n\ninterface EditorDialogsProps extends PropsWithChildren<{}> {\n  params?: any;\n}\n\ninterface OpenDialog {\n  type: string;\n  resolve: (value: any) => void;\n  reject: () => void;\n  value: any;\n  options?: any;\n}\n\nlet alertId = 0;\n\nconst RichTextDialogsContainer: React.SFC<EditorDialogsProps> = (\n  props: EditorDialogsProps\n) => {\n  const { children, params } = props;\n\n  const [openDialog, setOpenDialog] = React.useState<OpenDialog>();\n  const [alerts, dispatchAlertEvent] = React.useReducer(\n    (state: Alert[], action: any) => {\n      switch (action.type) {\n        case \"ADD_ALERT\":\n          return [...state, action.alert];\n        case \"REMOVE_ALERT\":\n          const alertIndex = state.findIndex((x) => x.id === action.id);\n          if (alertIndex !== -1) {\n            state.splice(alertIndex, 1);\n          }\n          return [...state];\n        case \"UPDATE_ALERT_CONTENT\":\n          const alert = state.find((x) => x.id === action.id);\n          if (alert) {\n            alert.content = action.content;\n          }\n          return [...state];\n      }\n      return state;\n    },\n    []\n  );\n\n  const handleCloseDialog = React.useCallback(() => {\n    if (openDialog) {\n      openDialog.reject();\n    }\n    setOpenDialog(undefined);\n  }, [openDialog, setOpenDialog]);\n\n  const handleSubmitDialog = React.useCallback(\n    (value: any) => {\n      if (openDialog) {\n        openDialog.resolve(value);\n      }\n      setOpenDialog(undefined);\n    },\n    [openDialog, setOpenDialog]\n  );\n\n  const handleOpenDialog = React.useCallback(\n    (type: string, value?: any, options?: any) => {\n      return new Promise((resolve, reject) => {\n        setOpenDialog({\n          type,\n          resolve,\n          reject,\n          value,\n          options,\n        });\n      });\n    },\n    [setOpenDialog]\n  );\n\n  const { sdk } = React.useContext(SdkContext);\n\n  const handleUpdateAlertContent = React.useCallback(\n    (id, content) => {\n      dispatchAlertEvent({\n        type: \"UPDATE_ALERT_CONTENT\",\n        id,\n        content,\n      });\n    },\n    [dispatchAlertEvent]\n  );\n\n  const handleCloseAlert = React.useCallback(\n    (id) => {\n      dispatchAlertEvent({\n        type: \"REMOVE_ALERT\",\n        id,\n      });\n    },\n    [dispatchAlertEvent]\n  );\n\n  const dialogs: RichTextDialogs = {\n    getAnchor: (existing: Set<string>, value?: Anchor): Promise<Anchor> => {\n      return handleOpenDialog(\"anchor\", { value, existing }) as Promise<Anchor>;\n    },\n    getCode: (value?: string): Promise<string> => {\n      return handleOpenDialog(\"code\", value) as Promise<string>;\n    },\n    getHyperlink: (value?: Hyperlink): Promise<Hyperlink> => {\n      return handleOpenDialog(\"hyperlink\", value) as Promise<Hyperlink>;\n    },\n    getImage: (value?: Image): Promise<Image> => {\n      return handleOpenDialog(\"image\") as Promise<Image>;\n    },\n    getDcImageLink: (value?: any): Promise<any> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.mediaLink.getImage();\n      }\n    },\n    getDcContentLink: (contentTypeIds: string[], value?: any): Promise<any> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.contentLink.get(contentTypeIds);\n      }\n    },\n    getAIPrompt(\n      dialogProps: AIPromptDialogOptions\n    ): Promise<{ prompt: string; keywords: string[] }> {\n      return handleOpenDialog(\"ai_prompt\", undefined, dialogProps) as Promise<{\n        prompt: string;\n        keywords: string[];\n      }>;\n    },\n    alert(alertProps: AlertOptions): Alert {\n      const alert: any = {\n        id: `${alertId++}`,\n        ...alertProps,\n      };\n      alert.updateContent = (content: string | React.ReactElement) => {\n        handleUpdateAlertContent(alert.id, content);\n      };\n      dispatchAlertEvent({\n        type: \"ADD_ALERT\",\n        alert,\n      });\n      return alert;\n    },\n  };\n\n  return (\n    <RichTextDialogsContext.Provider value={{ dialogs }}>\n      {children}\n\n      <AnchorDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"anchor\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <CodeDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"code\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <HyperlinkDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"hyperlink\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <ImageDialog\n        open={openDialog != null && openDialog.type === \"image\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n\n      <AIPromptDialog\n        open={openDialog != null && openDialog.type === \"ai_prompt\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n        params={params}\n        {...(openDialog?.options || {})}\n      />\n\n      {alerts.map((alert: Alert) => (\n        <Snackbar\n          key={alert.id}\n          onClose={() => handleCloseAlert(alert.id)}\n          open={true}\n          autoHideDuration={6000}\n          anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\n        >\n          <RichTextAlert\n            severity={alert.severity}\n            title={alert.title}\n            icon={alert.icon}\n            onClose={() => handleCloseAlert(alert.id)}\n          >\n            {alert.content}\n          </RichTextAlert>\n        </Snackbar>\n      ))}\n    </RichTextDialogsContext.Provider>\n  );\n};\n\nexport default RichTextDialogsContainer;\n","import React from \"react\";\n\nimport { Chip, Grid, Theme, WithStyles, withStyles } from \"@material-ui/core\";\nimport { AIConfiguration } from \"../AIPromptDialog\";\nimport { useRichTextEditorContext } from \"../RichTextEditor/RichTextEditorContext\";\n\nconst styles = (theme: Theme) => ({\n  root: {\n    borderTop: \"1px solid rgb(218, 220, 224)\",\n    position: \"relative\" as \"relative\",\n    background: \"white\",\n    paddingTop: \"10px\",\n    width: \"100%\",\n    bottom: 0,\n  },\n  chip: {\n    color: \"#039be5\",\n    border: \"1px solid rgba(3, 155, 229, 0.5)\",\n    borderRadius: \"3px\",\n    fontSize: \"13px\",\n    padding: \"0 5px\",\n    height: \"30px\",\n    \"&:hover\": {\n      border: \"1px solid rgba(3, 155, 229, 1)\",\n      backgroundColor: \"#fff !important\",\n    },\n    \"&:focus\": {\n      backgroundColor: \"#fff !important\",\n    },\n  },\n});\n\nexport interface RichTextEditorAIActionsBarProps\n  extends WithStyles<typeof styles> {\n  showCreditsError: any;\n}\n\nconst RichTextEditorAIActionsBar: React.SFC<RichTextEditorAIActionsBarProps> = (\n  props: RichTextEditorAIActionsBarProps\n) => {\n  const { classes, showCreditsError } = props;\n  const {\n    params,\n    actions,\n    dialogs,\n    proseMirrorEditorView,\n  } = useRichTextEditorContext();\n\n  const configuration = new AIConfiguration(params);\n  const isAiToolEnabled =\n    (params?.tools as { ai: { disabled: boolean } })?.ai?.disabled !== true;\n  const editPrompts = configuration.getEditPrompts();\n\n  const handleEditPrompt = async (prompt: any) => {\n    await actions.rewriteSelectedContentUsingAI(prompt.prompt, []);\n  };\n\n  const handleCustomAiRewrite = async () => {\n    const { prompt, keywords } = await dialogs.getAIPrompt({\n      variant: \"rewrite\",\n    });\n    await actions.rewriteSelectedContentUsingAI(prompt, keywords);\n  };\n\n  return isAiToolEnabled ? (\n    <div className={classes.root}>\n      <Grid direction=\"row\" spacing={1} container={true} style={{ gap: 12 }}>\n        {editPrompts.map((prompt: any) => {\n          return (\n            <Grid key={prompt.label} item={true}>\n              <Chip\n                className={classes.chip}\n                label={prompt.label}\n                variant=\"outlined\"\n                onClick={() => handleEditPrompt(prompt)}\n                disabled={showCreditsError}\n                style={{\n                  visibility: proseMirrorEditorView?.state.selection.empty\n                    ? \"hidden\"\n                    : \"visible\",\n                }}\n              />\n            </Grid>\n          );\n        })}\n        <Grid item={true}>\n          <Chip\n            className={classes.chip}\n            label=\"Custom rewrite\"\n            variant=\"outlined\"\n            onClick={() => handleCustomAiRewrite()}\n            disabled={showCreditsError}\n            style={{\n              visibility: proseMirrorEditorView?.state.selection.empty\n                ? \"hidden\"\n                : \"visible\",\n            }}\n          />\n        </Grid>\n      </Grid>\n    </div>\n  ) : (\n    <></>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditorAIActionsBar);\n","import React from \"react\";\n\nexport default function CreditsError(props: any) {\n  const { showCreditsError } = props;\n\n  if (showCreditsError) {\n    return (\n      <p\n        style={{\n          fontSize: \"11px\",\n          color: \"#FF3366\",\n          fontFamily: \"'IBM Plex Sans', sans-serif\",\n        }}\n      >\n        You're out of Amplience credits. You can still use the Editor to compose\n        text yourself.{\" \"}\n        <a\n          href=\"https://amplience.com/developers/docs/ai-services/credits\"\n          style={{ color: \"#039BE5\", textDecoration: \"none\" }}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Top up your credits\n        </a>\n      </p>\n    );\n  }\n\n  return <></>;\n}\n","import { createContext } from \"react\";\nexport interface HubContext {\n  hub?: any;\n}\n\nexport default createContext<HubContext>({});\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { useState } from \"react\";\nimport CodeTextArea from \"../CodeTextArea/CodeTextArea\";\nimport ProseMirror from \"../ProseMirror/ProseMirror\";\nimport { EditorView, ViewSwitcher } from \"../ViewSwitcher\";\n\nimport {\n  RichLanguageFormat,\n  RichTextEditorContextProps,\n  RichTextLanguageMap,\n} from \"@dc-extension-rich-text/common\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport ProseMirrorToolbar, {\n  ToolbarElement,\n} from \"../ProseMirrorToolbar/ProseMirrorToolbar\";\nimport DefaultToolbar from \"./DefaultToolbar\";\n\nimport {\n  computeToolbarState,\n  ProseMirrorToolbarState,\n} from \"../ProseMirrorToolbar/ProseMirrorToolbarState\";\nimport { RichTextActionsImpl } from \"../RichTextActions\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\nimport RichTextEditorAIActionsBar from \"../RichTextEditorAIActionsBar/RichTextEditorAIActionsBar\";\nimport RichtextEditorContext from \"./RichTextEditorContext\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\nimport CreditsError from \"../CreditsError/CreditsError\";\nimport HubContext from \"../HubContext/HubContext\";\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\",\n  },\n  frame: {\n    flex: 1,\n    display: \"flex\",\n    flexDirection: \"column\" as \"column\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    borderRadius: 5,\n    padding: \"12px 20px\",\n  },\n};\n\nexport interface RichTextEditorProps extends WithStyles<typeof styles> {\n  languages?: RichTextLanguageMap;\n  language?: string;\n  disableToolbar?: boolean;\n  toolbarLayout?: ToolbarElement[];\n  disableCodeView?: boolean;\n  readOnlyCodeView?: boolean;\n  editorViewOptions?: any;\n  value?: any;\n  onChange?: (value: any) => void;\n  params?: any;\n}\n\nconst RichTextEditor: React.SFC<RichTextEditorProps> = (\n  props: RichTextEditorProps\n) => {\n  const {\n    classes,\n    languages: languagesProp,\n    language: languageProp = \"markdown\",\n    toolbarLayout: toolbarLayoutProp,\n    disableToolbar = false,\n    disableCodeView = false,\n    readOnlyCodeView = false,\n    editorViewOptions,\n    value: valueProp,\n    onChange,\n    params,\n  } = props;\n\n  const [isLocked, setIsLocked] = useState(false);\n  const [showCreditsError, setShowCreditsError] = useState(false);\n  const [proseMirrorEditorView, setProseMirrorEditorView] = useState<\n    any | undefined\n  >(undefined);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n  const [actions] = useState(new RichTextActionsImpl());\n\n  const languages: RichTextLanguageMap = languagesProp || {\n    markdown: MarkdownLanguage({}),\n  };\n\n  if (!languages[languageProp]) {\n    throw new Error(`Unable to find language ${props.language}`);\n  }\n\n  const { language, conf: languageConfiguration } = languages[languageProp];\n  const { sdk } = React.useContext(SdkContext);\n  const { hub } = React.useContext(HubContext);\n\n  const editorContext: RichTextEditorContextProps = {\n    isLocked,\n    setIsLocked,\n    proseMirrorEditorView,\n    dialogs: dialogs!,\n    actions,\n    params,\n    languages,\n    language,\n    sdk,\n    hub,\n    setShowCreditsError,\n  };\n\n  actions.setRichTextEditorContext(editorContext);\n\n  const [view, setView] = React.useState(EditorView.EDIT);\n  const [rawValue, setRawValue] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    if (languageConfiguration.format === RichLanguageFormat.JSON) {\n      return JSON.stringify(valueProp, null, 3);\n    } else {\n      return valueProp;\n    }\n  });\n  const [proseMirrorDocument, setProseMirrorDocument] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    try {\n      return language.parse(valueProp);\n      // tslint:disable-next-line\n    } catch (err) {}\n  });\n\n  const handleRawValueChange = React.useCallback(\n    (value: any) => {\n      setRawValue(value);\n\n      if (languageConfiguration.format === RichLanguageFormat.JSON) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {\n          return;\n        }\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n\n      try {\n        const newProseMirrorDocument = language.parse(value);\n        setProseMirrorDocument(newProseMirrorDocument);\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setRawValue, setProseMirrorDocument, onChange]\n  );\n\n  const handleEditorChange = React.useCallback(\n    (doc: any) => {\n      setProseMirrorDocument(doc);\n      try {\n        const newRawValue = language.serialize(doc);\n\n        if (languageConfiguration.format === RichLanguageFormat.JSON) {\n          setRawValue(JSON.stringify(newRawValue, null, 3));\n        } else {\n          setRawValue(newRawValue);\n        }\n\n        if (onChange) {\n          onChange(newRawValue);\n        }\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setProseMirrorDocument, setRawValue]\n  );\n\n  const [toolbarState, setToolbarState] = React.useState<\n    ProseMirrorToolbarState\n  >();\n  const toolbarLayout = toolbarLayoutProp || DefaultToolbar;\n\n  const handleEditorUpdateState = React.useCallback(\n    (state: any, editorView: any) => {\n      setProseMirrorEditorView(editorView);\n      setToolbarState(\n        computeToolbarState(language.tools, state, editorContext)\n      );\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [language, setToolbarState]\n  );\n\n  return (\n    <RichtextEditorContext.Provider value={editorContext}>\n      <div className={classes.root}>\n        <div className={classes.frame}>\n          <ViewSwitcher\n            onChange={setView}\n            language={language.label}\n            disableCodeView={disableCodeView}\n          />\n          {view === EditorView.EDIT ? (\n            <div>\n              {disableToolbar ? (\n                false\n              ) : (\n                <>\n                  <CreditsError\n                    showCreditsError={showCreditsError}\n                    loading={isLocked}\n                  ></CreditsError>\n                  <ProseMirrorToolbar\n                    toolbarState={toolbarState}\n                    layout={toolbarLayout}\n                    isLocked={editorContext.isLocked}\n                    params={params}\n                  />\n                </>\n              )}\n              <div style={{ position: \"relative\" }}>\n                <ProseMirror\n                  editorViewOptions={editorViewOptions}\n                  schema={language.schema}\n                  onChange={handleEditorChange}\n                  onUpdateState={handleEditorUpdateState}\n                  doc={proseMirrorDocument}\n                  isLocked={editorContext.isLocked}\n                />\n                <RichTextEditorAIActionsBar\n                  showCreditsError={showCreditsError}\n                />\n              </div>\n            </div>\n          ) : (\n            <CodeTextArea\n              value={rawValue}\n              onChange={handleRawValueChange}\n              readOnly={editorContext.isLocked || readOnlyCodeView}\n            />\n          )}\n        </div>\n      </div>\n    </RichtextEditorContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditor);\n","import {\n  ProseMirrorTool,\n  ProseMirrorToolState,\n  RichTextEditorContextProps,\n} from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarState {\n  tools: ProseMirrorTool[];\n  toolStates: { [toolName: string]: ProseMirrorToolState };\n  params: Record<string, unknown>;\n}\n\nexport function computeToolbarState(\n  tools: ProseMirrorTool[],\n  editorState: any,\n  richTextEditorContext: RichTextEditorContextProps\n): ProseMirrorToolbarState {\n  const toolStates: { [toolName: string]: ProseMirrorToolState } = {};\n\n  for (const tool of tools) {\n    const state = {\n      active: false,\n      enabled: true,\n      visible: true,\n      ...tool,\n    };\n\n    if (tool.isActive) {\n      state.active = tool.isActive(editorState, richTextEditorContext);\n    }\n\n    if (tool.isVisible) {\n      state.visible = tool.isVisible(editorState, richTextEditorContext);\n    }\n\n    if (tool.isEnabled) {\n      state.enabled = tool.isEnabled(editorState, richTextEditorContext);\n    }\n\n    toolStates[tool.name] = state;\n  }\n\n  return {\n    tools,\n    toolStates,\n    params: {},\n  };\n}\n","import React from \"react\";\n\nimport { withStyles, WithStyles } from \"@material-ui/core\";\n\nimport { ToolbarElement } from \"../ProseMirrorToolbar\";\nimport { RichTextEditor } from \"../RichTextEditor\";\n\nimport JSONLanguage from \"@dc-extension-rich-text/language-json\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration,\n} from \"@dc-extension-rich-text/common\";\nimport {\n  ContentTypeExtensionSettings,\n  DcContentLinkView,\n  DcImageLinkView,\n  DynamicContentToolOptions,\n  OldContentTypeExtensionSettings,\n} from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport { RichTextActionsImpl } from \"../RichTextActions\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nexport const styles = {\n  root: {\n    width: \"100%\",\n    minWidth: 440,\n  },\n  title: {\n    padding: \"7px 0\",\n    minHeight: \"20px\",\n    color: \"#666\",\n    fontSize: \"13px\",\n    boxSizing: \"border-box\" as \"border-box\",\n    \"-webkit-font-smoothing\": \"auto\",\n    fontFamily: \"roboto,sans-serif!important\",\n  },\n};\n\nexport interface EditorRichTextFieldProps extends WithStyles<typeof styles> {\n  schema: any;\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nexport interface EditorRichTextFieldParams {\n  title?: string;\n  language?: string;\n\n  styles?: string;\n  stylesheet?: string;\n\n  useClasses?: boolean;\n  classOverride?: { [originalName: string]: string };\n\n  codeView?: {\n    readOnly?: boolean;\n    disabled?: boolean;\n  };\n\n  editView?: {};\n\n  toolbar?: {\n    layout?: ToolbarElement[];\n    disabled?: boolean;\n  };\n\n  tools?: {\n    whitelist?: string[];\n    blacklist?: string[];\n\n    \"dc-content-link\"?: {\n      contentTypes?: string[];\n      contentTypeSettings?:\n        | ContentTypeExtensionSettings[]\n        | OldContentTypeExtensionSettings;\n    };\n  };\n\n  sdk?: any;\n}\n\nconst EditorRichTextField: React.SFC<EditorRichTextFieldProps> = (\n  props: EditorRichTextFieldProps\n) => {\n  const { schema, value: valueProp, onChange, classes } = props;\n\n  let params: EditorRichTextFieldParams =\n    schema?.[\"ui:extension\"]?.params || {};\n\n  const { sdk } = React.useContext(SdkContext);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  params = sdk\n    ? { ...params, ...sdk.params?.installation, ...sdk.params?.instance, sdk }\n    : params;\n\n  const toolOptions = React.useMemo<DynamicContentToolOptions>(() => {\n    const settings = {\n      useClasses: params.useClasses,\n      classOverride: params.classOverride,\n      dialogs,\n      actions: new RichTextActionsImpl(),\n      dynamicContent: {\n        stagingEnvironment: sdk ? sdk.stagingEnvironment : undefined,\n      },\n      tools: params.tools,\n    };\n\n    if (settings.tools && !settings.tools.blacklist) {\n      // disable inline_styles by default\n      settings.tools.blacklist = [\"inline_styles\"];\n    }\n\n    return settings;\n  }, [sdk, dialogs, params]);\n\n  const languages = React.useMemo<{\n    [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n  }>(() => {\n    return {\n      markdown: MarkdownLanguage(toolOptions),\n      json: JSONLanguage(toolOptions),\n    };\n  }, []);\n\n  const editorViewOptions = React.useMemo(() => {\n    return {\n      nodeViews: {\n        \"dc-image-link\": (node: any, view: any, getPos: any) =>\n          new DcImageLinkView(node, view, getPos, toolOptions),\n        \"dc-content-link\": (node: any, view: any, getPos: any) =>\n          new DcContentLinkView(node, view, getPos, toolOptions),\n      },\n    };\n  }, [sdk, toolOptions]);\n\n  return (\n    <div className={classes.root}>\n      {params.styles ? (\n        <style dangerouslySetInnerHTML={{ __html: params.styles }} />\n      ) : (\n        false\n      )}\n      {params.stylesheet ? (\n        <link rel=\"stylesheet\" href={params.stylesheet} />\n      ) : (\n        false\n      )}\n\n      {params.title ? (\n        <div className={classes.title}>{params.title}</div>\n      ) : (\n        false\n      )}\n\n      <RichTextEditor\n        languages={languages}\n        language={params.language}\n        editorViewOptions={editorViewOptions}\n        toolbarLayout={params.toolbar ? params.toolbar.layout : undefined}\n        disableToolbar={params.toolbar ? params.toolbar.disabled : undefined}\n        disableCodeView={params.codeView ? params.codeView.disabled : undefined}\n        readOnlyCodeView={\n          params.codeView ? params.codeView.readOnly : undefined\n        }\n        onChange={onChange}\n        params={params}\n        value={valueProp}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(EditorRichTextField);\n","export default (outerTheme: any) => {\n  const typography = { ...outerTheme.typography };\n  const fontFamily = \"'IBM Plex Sans', sans-serif\";\n  const elements = [\n    \"h1\",\n    \"h2\",\n    \"h3\",\n    \"h4\",\n    \"h5\",\n    \"h6\",\n    \"subtitle1\",\n    \"subtitle2\",\n    \"body1\",\n    \"body2\",\n    \"button\",\n    \"caption\",\n    \"overline\",\n  ];\n  typography.fontFamily = fontFamily;\n  elements.forEach((element) => {\n    typography[element].fontFamily = fontFamily;\n  });\n\n  return { ...outerTheme, typography };\n};\n","import React from \"react\";\n\nimport { datadogRum } from \"@datadog/browser-rum\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport { init, SDK } from \"dc-extensions-sdk\";\nimport { SdkContext, withTheme } from \"unofficial-dynamic-content-ui\";\nimport EditorRichTextField from \"./EditorRichTextField/EditorRichTextField\";\nimport { RichTextDialogsContainer } from \"./RichTextDialogs\";\nimport theme from \"./theme\";\nimport HubContext from \"./HubContext/HubContext\";\n\ninterface AppState {\n  connected: boolean;\n  sdk?: SDK;\n  hub?: any;\n  value?: string;\n  params?: any;\n}\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = { connected: false };\n    this.handleValueChange = this.handleValueChange.bind(this);\n    this.handleChooseLink = this.handleChooseLink.bind(this);\n  }\n\n  public componentDidMount(): void {\n    this.handleConnect();\n    this.handleInitRum();\n  }\n\n  public handleInitRum(): void {\n    const ddToken = process.env.REACT_APP_DATADOG_TOKEN;\n    const ddAppId = process.env.REACT_APP_DATADOG_APP_ID;\n    const ddEnv = process.env.REACT_APP_DATADOG_ENV_ID;\n\n    if (ddToken && ddAppId && ddEnv) {\n      datadogRum.init({\n        applicationId: ddAppId,\n        clientToken: ddToken,\n        env: ddEnv,\n        site: \"datadoghq.com\",\n        service: \"dc-extension-rich-text\",\n        version: \"0.1.0\",\n        trackResources: true,\n        trackLongTasks: true,\n        trackUserInteractions: true,\n        defaultPrivacyLevel: \"allow\",\n        sampleRate: 100,\n        useCrossSiteSessionCookie: true,\n        proxy: \"https://dd-proxy.amplience.net\",\n      });\n\n      datadogRum.startSessionReplayRecording();\n    }\n  }\n\n  public async handleConnect(): Promise<void> {\n    const sdk = await init();\n    sdk.frame.startAutoResizer();\n\n    sdk.contentItem\n      .getCurrent()\n      .then((item) => {\n        datadogRum.setGlobalContext({\n          deliveryId: item.deliveryId,\n        });\n      })\n      .catch(() => {});\n\n    const hub = await sdk.connection\n      .request(\"context-get\")\n      .then(({ hub }) => hub)\n      .catch(() => ({}));\n\n    const params = {\n      ...sdk.field?.schema?.[\"ui:extension\"]?.params,\n      ...sdk.params?.installation,\n      ...sdk.params?.instance,\n    };\n\n    const value: any = await sdk.field.getValue();\n    this.setState({\n      sdk,\n      connected: true,\n      value,\n      params,\n      hub,\n    });\n  }\n\n  public handleValueChange(value: any): void {\n    if (this.state.connected && this.state.sdk) {\n      this.state.sdk.field.setValue(value);\n    }\n  }\n\n  public async handleChooseLink(): Promise<{ href: string; title: string }> {\n    return { href: \"\", title: \"\" };\n  }\n\n  public render(): React.ReactElement {\n    const { connected, value, sdk, hub } = this.state;\n\n    return (\n      <div className=\"App\">\n        {connected && sdk ? (\n          <div>\n            {withTheme(\n              <ThemeProvider theme={theme}>\n                <SdkContext.Provider value={{ sdk }}>\n                  <HubContext.Provider value={{ hub }}>\n                    <RichTextDialogsContainer params={this.state.params}>\n                      <EditorRichTextField\n                        onChange={this.handleValueChange}\n                        value={value}\n                        schema={sdk.field.schema}\n                      />\n                    </RichTextDialogsContainer>\n                  </HubContext.Provider>\n                </SdkContext.Provider>\n              </ThemeProvider>\n            )}\n          </div>\n        ) : (\n          <div>&nbsp;</div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"@fontsource/ibm-plex-sans\";\nimport \"@fontsource/ibm-plex-sans/500.css\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport { initGainsight } from \"./gainsight\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\ninitGainsight();\n","export function isToolEnabled(toolName, options) {\n    if (options.tools &&\n        options.tools.blacklist &&\n        options.tools.blacklist.indexOf(toolName) !== -1) {\n        return false;\n    }\n    if (options.tools &&\n        options.tools.whitelist &&\n        options.tools.whitelist.indexOf(toolName) === -1) {\n        return false;\n    }\n    return true;\n}\nvar classNameRegex = /^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$/;\nexport function getCustomClass(defaultName, options) {\n    if (options && options.classOverride) {\n        var name_1 = options.classOverride[defaultName];\n        return name_1 && classNameRegex.test(name_1) ? name_1 : defaultName;\n    }\n    return defaultName;\n}\nexport function getDefaultClass(customName, options) {\n    if (options && options.classOverride) {\n        var classes_1 = options.classOverride;\n        var keys = Object.keys(classes_1);\n        return keys.find(function (key) { return classes_1[key] === customName; }) || customName;\n    }\n    return customName;\n}\n","export function inBlock(state) {\n    var $from = state.selection.$from;\n    return $from.depth > 1;\n}\nexport function isMarkActive(state, type) {\n    var _a = state.selection, from = _a.from, $from = _a.$from, to = _a.to, empty = _a.empty;\n    if (empty) {\n        return type.isInSet(state.storedMarks || $from.marks());\n    }\n    else {\n        return state.doc.rangeHasMark(from, to, type);\n    }\n}\nexport function getSelectionMarks(state) {\n    var _a = state.selection, $from = _a.$from, $to = _a.$to;\n    var currentMarks = [];\n    state.doc.nodesBetween($from.pos, $to.pos, function (node, start) {\n        node.marks.forEach(function (mark) {\n            return currentMarks.push({ from: start, to: start + node.nodeSize, mark: mark });\n        });\n    });\n    return currentMarks;\n}\nexport function hasMarkup(state, type, atts) {\n    var _a = state.selection, $from = _a.$from, to = _a.to, node = _a.node;\n    if (node) {\n        return node.hasMarkup(type, atts);\n    }\n    return to <= $from.end() && $from.parent.hasMarkup(type, atts);\n}\nexport function canInsert(state, type) {\n    var $from = state.selection.$from;\n    for (var d = $from.depth; d >= 0; d--) {\n        var index = $from.index(d);\n        if ($from.node(d).canReplaceWith(index, index, type)) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function clearAllMarks() {\n    return function (state, dispatch) {\n        var ref = state.selection;\n        var $cursor = ref.$cursor;\n        var ranges = ref.ranges;\n        if (dispatch) {\n            if ($cursor) {\n                var marks = state.storedMarks || $cursor.marks();\n                for (var _i = 0, marks_1 = marks; _i < marks_1.length; _i++) {\n                    var mark = marks_1[_i];\n                    dispatch(state.tr.removeStoredMark(mark.type));\n                }\n            }\n            else {\n                var tr = state.tr;\n                for (var _a = 0, ranges_1 = ranges; _a < ranges_1.length; _a++) {\n                    var range = ranges_1[_a];\n                    for (var _b = 0, _c = Object.keys(state.schema.marks); _b < _c.length; _b++) {\n                        var markName = _c[_b];\n                        tr.removeMark(range.$from.pos, range.$to.pos, state.schema.marks[markName]);\n                    }\n                }\n                dispatch(tr);\n            }\n        }\n        return true;\n    };\n}\n","export function DcImageLinkNode() {\n    return {\n        content: \"block\",\n        group: \"block\",\n        defining: true,\n        attrs: {\n            value: {}\n        },\n        nodeSize: 1,\n        draggable: true,\n        atom: true,\n        parseDOM: [\n            {\n                tag: \"dc-image-link[data-dc-image-link]\",\n                getAttrs: function (dom) {\n                    var value = JSON.parse(dom.getAttribute(\"data-dc-image-link\"));\n                    return {\n                        value: value\n                    };\n                }\n            }\n        ],\n        toDOM: function (node) {\n            var value = node.attrs.value;\n            return [\"dc-image-link\", { \"data-dc-image-link\": JSON.stringify(value) }];\n        }\n    };\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from \"react\";\nimport { withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nvar styles = {\n    root: {\n        display: \"block\",\n        width: \"100%\",\n        minHeight: 150,\n        margin: \"0 10px 10px 0\",\n        position: \"relative\"\n    },\n    content: {},\n    \"empty-slot\": {},\n    \"populated-slot\": {}\n};\nvar InlineChooser = function (props) {\n    var _a;\n    var classes = props.classes, children = props.children, className = props.className, _b = props.variant, variant = _b === void 0 ? \"empty\" : _b, aspectRatio = props.aspectRatio, other = __rest(props, [\"classes\", \"children\", \"className\", \"variant\", \"aspectRatio\"]);\n    var aspectRatioPaddingTop = React.useMemo(function () {\n        if (!aspectRatio) {\n            return undefined;\n        }\n        var components = aspectRatio.split(':');\n        if (components.length !== 2) {\n            return undefined;\n        }\n        return Math.round(Number(components[1]) / Number(components[0]) * 100) + '%';\n    }, [aspectRatio]);\n    return (React.createElement(\"div\", __assign({}, other, { className: clsx(classes.root, (_a = {},\n            _a[classes[\"empty-slot\"]] = variant === \"empty-slot\",\n            _a[classes[\"populated-slot\"]] = variant === \"populated-slot\",\n            _a), className) }), aspectRatio ? (React.createElement(React.Fragment, null,\n        React.createElement(\"div\", { style: { display: 'block', paddingTop: aspectRatioPaddingTop } }, \"\\u00A0\"),\n        React.createElement(\"div\", { className: clsx(classes.content) }, children))) : (React.createElement(\"div\", { className: clsx(classes.content) }, children))));\n};\nexport default withStyles(styles)(InlineChooser);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, DeleteIcon, StyledFab, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { CircularProgress, withStyles } from '@material-ui/core';\n// tslint:disable-next-line\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage';\nimport clsx from 'clsx';\nvar styles = {\n    root: {\n        '&$broken, &$invalid': {\n            background: '#e5e5e5'\n        }\n    },\n    image: {\n        maxWidth: '100%'\n    },\n    loading: {},\n    broken: {},\n    invalid: {},\n    statusIcons: {\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        position: 'absolute',\n        alignItems: 'center',\n        alignContent: 'center',\n        flexDirection: 'row',\n        justifyContent: 'center'\n    }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n    var _a;\n    var node = props.node, onDelete = props.onDelete, classes = props.classes, options = props.options;\n    var value = node.attrs.value;\n    // BrokenImageIcon\n    var _b = React.useState(false), broken = _b[0], setBroken = _b[1];\n    var _c = React.useState(false), loading = _c[0], setLoading = _c[1];\n    var handleLoading = React.useCallback(function () {\n        setLoading(true);\n    }, [setLoading]);\n    var handleError = React.useCallback(function () {\n        setBroken(true);\n        setLoading(false);\n    }, [setBroken, setLoading]);\n    var handleLoaded = React.useCallback(function () {\n        setBroken(false);\n        setLoading(false);\n    }, [setBroken, setLoading]);\n    var hasValidValue = value && value.endpoint && value.name;\n    //Workaround for ts-jest\n    var Fab = StyledFab;\n    return (React.createElement(\"div\", { className: clsx(classes.root, (_a = {},\n            _a[classes.broken] = broken,\n            _a[classes.loading] = loading,\n            _a[classes.invalid] = !hasValidValue,\n            _a)) },\n        React.createElement(InlineChooser, { variant: \"populated-slot\", aspectRatio: broken || loading || !hasValidValue ? '3:1' : undefined },\n            hasValidValue ?\n                (React.createElement(\"img\", { className: classes.image, src: \"//\" + (options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? options.dynamicContent.stagingEnvironment : value.defaultHost) + \"/i/\" + value.endpoint + \"/\" + encodeURIComponent(value.name), onLoadStart: handleLoading, onError: handleError, onLoad: handleLoaded, alt: \"\" })) : false,\n            React.createElement(\"div\", { className: classes.statusIcons }, loading ?\n                React.createElement(CircularProgress, null) :\n                (broken || !hasValidValue ? React.createElement(BrokenImageIcon, { fontSize: \"large\" }) : false)),\n            React.createElement(ChooserActions, { variant: \"populated-slot\" },\n                React.createElement(Fab, { variant: \"dark\", onClick: onDelete }, DeleteIcon)))));\n});\nvar DcImageLinkView = /** @class */ (function () {\n    function DcImageLinkView(node, view, getPos, options) {\n        if (options === void 0) { options = {}; }\n        this.node = node;\n        this.view = view;\n        this.getPos = getPos;\n        this.options = options;\n        this.dom = document.createElement('div');\n        this.handleDelete = this.handleDelete.bind(this);\n        this.render();\n    }\n    DcImageLinkView.prototype.handleDelete = function () {\n        var start = this.getPos();\n        var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n        this.view.dispatch(tr);\n    };\n    DcImageLinkView.prototype.render = function () {\n        ReactDOM.render(withTheme(React.createElement(ViewComponent, { options: this.options, node: this.node, onDelete: this.handleDelete })), this.dom);\n    };\n    return DcImageLinkView;\n}());\nexport { DcImageLinkView };\n","export function DcContentLinkNode() {\n    return {\n        content: \"block\",\n        group: \"block\",\n        defining: true,\n        attrs: {\n            value: {}\n        },\n        nodeSize: 1,\n        draggable: true,\n        atom: true,\n        parseDOM: [\n            {\n                tag: \"dc-content-link[data-dc-content-link]\",\n                getAttrs: function (dom) {\n                    var value = JSON.parse(dom.getAttribute(\"data-dc-content-link\"));\n                    return {\n                        value: value\n                    };\n                }\n            }\n        ],\n        toDOM: function (node) {\n            var value = node.attrs.value;\n            return [\n                \"dc-content-link\",\n                { \"data-dc-content-link\": JSON.stringify(value) }\n            ];\n        }\n    };\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, ContentItem as ContentItemIcon, DeleteIcon, getContentTypeCard, getContentTypeIcon, StyledFab, Visualization, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { withStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nvar styles = {\n    root: {\n        '&$broken, &$invalid': {\n            background: '#e5e5e5'\n        },\n        boxShadow: \"0 1px 5px 0 rgba(23,32,44,.2), 0 2px 2px 0 rgba(23,32,44,.1), 0 3px 1px -2px rgba(23,32,44,.1)\"\n    },\n    invalid: {},\n    content: {\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundSize: \"contain\",\n        backgroundRepeat: \"no-repeat\",\n        backgroundPosition: \"50%\"\n    },\n    statusIcons: {\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        position: 'absolute',\n        alignItems: 'center',\n        alignContent: 'center',\n        flexDirection: 'row',\n        justifyContent: 'center'\n    }\n};\nvar convertSettings = function (settings) {\n    if (settings === undefined) {\n        return undefined;\n    }\n    else if (Array.isArray(settings)) {\n        var result_1 = {\n            cards: {},\n            icons: {},\n            aspectRatios: {}\n        };\n        settings.forEach(function (setting) {\n            if (setting.card) {\n                result_1.cards[setting.id] = setting.card;\n            }\n            if (setting.icon) {\n                result_1.icons[setting.id] = setting.icon;\n            }\n            if (setting.aspectRatio && result_1.aspectRatios) {\n                result_1.aspectRatios[setting.id] = setting.aspectRatio;\n            }\n        });\n        return result_1;\n    }\n    else {\n        return settings;\n    }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n    var _a;\n    var node = props.node, onDelete = props.onDelete, classes = props.classes, options = props.options;\n    var value = node.attrs.value;\n    var hasValidValue = value && value.id && value.contentType;\n    var contentLinkOptions = options.tools && options.tools[\"dc-content-link\"] ? options.tools[\"dc-content-link\"] : undefined;\n    var settings = contentLinkOptions ? convertSettings(contentLinkOptions.contentTypeSettings) : undefined;\n    var customIcon = settings && hasValidValue ? getContentTypeIcon(settings, value.contentType) : undefined;\n    var cardTemplateUrl = settings && hasValidValue ? getContentTypeCard(settings, value.contentType) : undefined;\n    var aspectRatio = settings && settings.aspectRatios && hasValidValue ? getContentTypeAspectRatio(settings.aspectRatios, value.contentType) : undefined;\n    //Workaround for ts-jest\n    var Fab = StyledFab;\n    return (React.createElement(\"div\", { className: clsx(classes.root, (_a = {}, _a[classes.invalid] = !hasValidValue, _a)) },\n        React.createElement(InlineChooser, { variant: \"populated-slot\", aspectRatio: aspectRatio || '3:1' },\n            React.createElement(\"div\", { className: clsx(classes.content), style: {\n                    backgroundImage: \"url(\" + (customIcon || ContentItemIcon) + \")\"\n                } }, cardTemplateUrl && options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? (React.createElement(Visualization, { template: cardTemplateUrl, params: {\n                    contentItemId: value.id,\n                    stagingEnvironment: options.dynamicContent.stagingEnvironment\n                } })) : (false)),\n            React.createElement(ChooserActions, { variant: \"populated-slot\" },\n                React.createElement(Fab, { variant: \"dark\", onClick: onDelete }, DeleteIcon)))));\n});\nexport function getContentTypeAspectRatio(aspectRatios, schemaId) {\n    for (var _i = 0, _a = Object.keys(aspectRatios); _i < _a.length; _i++) {\n        var key = _a[_i];\n        if (key === \"*\" || key === schemaId) {\n            return aspectRatios[key];\n        }\n    }\n}\nvar DcContentLinkView = /** @class */ (function () {\n    function DcContentLinkView(node, view, getPos, options) {\n        if (options === void 0) { options = {}; }\n        this.node = node;\n        this.view = view;\n        this.getPos = getPos;\n        this.options = options;\n        this.dom = document.createElement('div');\n        this.handleDelete = this.handleDelete.bind(this);\n        this.render();\n    }\n    DcContentLinkView.prototype.handleDelete = function () {\n        var start = this.getPos();\n        var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n        this.view.dispatch(tr);\n    };\n    DcContentLinkView.prototype.render = function () {\n        ReactDOM.render(withTheme(React.createElement(ViewComponent, { options: this.options, node: this.node, onDelete: this.handleDelete })), this.dom);\n    };\n    return DcContentLinkView;\n}());\nexport { DcContentLinkView };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React from \"react\";\nimport { isToolEnabled, inBlock, } from \"@dc-extension-rich-text/common\";\n// tslint:disable-next-line\nimport AddCircleIcon from \"@material-ui/icons/AddCircle\";\n// tslint:disable-next-line\nimport ImageSearchIcon from \"@material-ui/icons/ImageSearch\";\nexport function dcImageLink(schema) {\n    var _this = this;\n    var node = schema.nodes[\"dc-image-link\"];\n    return {\n        name: \"dc-image-link\",\n        label: \"Insert Image\",\n        displayIcon: React.createElement(ImageSearchIcon, null),\n        isEnabled: function (state) { return !inBlock(state); },\n        apply: function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n            var value, err_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, richTextEditorContext.dialogs.getDcImageLink()];\n                    case 1:\n                        value = _a.sent();\n                        dispatch(state.tr.replaceSelectionWith(node.createAndFill({\n                            value: value,\n                        })));\n                        return [3 /*break*/, 3];\n                    case 2:\n                        err_1 = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); },\n    };\n}\nexport function dcContentLink(schema, contentTypes) {\n    var _this = this;\n    var node = schema.nodes[\"dc-content-link\"];\n    return {\n        name: \"dc-content-link\",\n        label: \"Insert Content\",\n        displayIcon: React.createElement(AddCircleIcon, null),\n        isEnabled: function (state) { return !inBlock(state); },\n        apply: function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n            var value, err_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, richTextEditorContext.dialogs.getDcContentLink(contentTypes)];\n                    case 1:\n                        value = _a.sent();\n                        dispatch(state.tr.replaceSelectionWith(node.createAndFill({\n                            value: value,\n                        })));\n                        return [3 /*break*/, 3];\n                    case 2:\n                        err_2 = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); },\n    };\n}\nexport function createDynamicContentTools(schema, options) {\n    var tools = [];\n    if (isToolEnabled(\"dc-image-link\", options) &&\n        schema.nodes[\"dc-image-link\"]) {\n        tools.push(dcImageLink(schema));\n    }\n    if (isToolEnabled(\"dc-content-link\", options) &&\n        schema.nodes[\"dc-content-link\"] &&\n        // must provide a list of content types for this tool to be active\n        options.tools &&\n        options.tools[\"dc-content-link\"] &&\n        options.tools[\"dc-content-link\"].contentTypes &&\n        options.tools[\"dc-content-link\"].contentTypes) {\n        tools.push(dcContentLink(schema, options.tools[\"dc-content-link\"].contentTypes));\n    }\n    return tools;\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { FormatAlignCenter, FormatAlignJustify, FormatAlignLeft, FormatAlignRight } from \"@material-ui/icons\";\nimport React from \"react\";\nfunction getContainingTextBlocks(state) {\n    var resultNodes = new Set();\n    var result = [];\n    state.doc.nodesBetween(state.selection.from, state.selection.to, function (node, pos, parent, index) {\n        if (node.isTextblock && !resultNodes.has(node)) {\n            result.push({ node: node, pos: pos, start: 0, depth: 0 });\n            resultNodes.add(node);\n        }\n    });\n    return Array.from(result);\n}\nfunction align(state, dispatch, alignment) {\n    // Apply align attr to the text block.\n    var result = getContainingTextBlocks(state);\n    var tr = state.tr;\n    result.forEach(function (item) {\n        var node = item.node, pos = item.pos;\n        tr = tr.setNodeMarkup(pos, node.type, __assign(__assign({}, node.attrs), { align: alignment }));\n    });\n    if (dispatch) {\n        dispatch(tr);\n    }\n    return true;\n}\nfunction alignActive(state, view, alignment) {\n    // Apply align attr to the text block.\n    var result = getContainingTextBlocks(state);\n    var anyMismatch = false;\n    result.forEach(function (item) {\n        if ((result[0].node.attrs.align || \"left\") !== alignment) {\n            anyMismatch = true;\n        }\n    });\n    if (result.length === 0) {\n        return false;\n    }\n    return !anyMismatch;\n}\nfunction alignable(state, view) {\n    // Any text block is alignable.\n    return getContainingTextBlocks(state).length > 0;\n}\nexport function AlignLeftTool(schema) {\n    return {\n        name: \"align_left\",\n        label: \"Align Left\",\n        displayIcon: React.createElement(FormatAlignLeft, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"left\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"left\"); },\n        isVisible: alignable,\n    };\n}\nexport function AlignCenterTool(schema) {\n    return {\n        name: \"align_center\",\n        label: \"Align center\",\n        displayIcon: React.createElement(FormatAlignCenter, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"center\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"center\"); },\n        isVisible: alignable,\n    };\n}\nexport function AlignRightTool(schema) {\n    return {\n        name: \"align_right\",\n        label: \"Align Right\",\n        displayIcon: React.createElement(FormatAlignRight, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"right\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"right\"); },\n        isVisible: alignable,\n    };\n}\nexport function AlignJustifyTool(schema) {\n    return {\n        name: \"align_justify\",\n        label: \"Align Justify\",\n        displayIcon: React.createElement(FormatAlignJustify, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"justify\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"justify\"); },\n        isVisible: alignable,\n    };\n}\n","// tslint:disable-next-line\nexport var anchor = {\n    group: \"inline\",\n    inline: true,\n    attrs: {\n        value: {}\n    },\n    parseDOM: [\n        {\n            tag: \"a[id]\",\n            getAttrs: function (dom) {\n                var value = JSON.parse(dom.getAttribute(\"id\"));\n                return {\n                    value: value\n                };\n            }\n        }\n    ],\n    toDOM: function (node) {\n        var value = node.attrs.value;\n        return [\"a\", { id: JSON.stringify(value) }, value];\n    }\n};\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { canInsert } from \"@dc-extension-rich-text/common\";\nimport { Directions } from \"@material-ui/icons\";\nimport React from \"react\";\nexport function AnchorTool(schema) {\n    return {\n        name: \"anchor\",\n        label: \"Insert Anchor\",\n        displayIcon: React.createElement(Directions, null),\n        apply: insertAnchor(schema.nodes.anchor),\n        isEnabled: function (state) { return canInsert(state, schema.nodes.anchor); },\n    };\n}\nexport function insertAnchor(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var existingAnchors_1, addAnchor_1, _a, $from, $to, anchorValue, err_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 2, , 3]);\n                    existingAnchors_1 = new Set();\n                    addAnchor_1 = function (node) {\n                        if (node.type.name === 'anchor') {\n                            existingAnchors_1.add(node.attrs.value);\n                        }\n                        else {\n                            node.forEach(addAnchor_1);\n                        }\n                    };\n                    state.doc.forEach(addAnchor_1);\n                    _a = state.selection, $from = _a.$from, $to = _a.$to;\n                    state.doc.nodesBetween($from.pos, $to.pos, function (node, start) {\n                        if (node.type.name === 'anchor') {\n                            existingAnchors_1.delete(node.attrs.value);\n                        }\n                    });\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getAnchor(existingAnchors_1)];\n                case 1:\n                    anchorValue = _b.sent();\n                    dispatch(state.tr.replaceSelectionWith(type.createAndFill({\n                        value: anchorValue.value\n                    })));\n                    return [3 /*break*/, 3];\n                case 2:\n                    err_1 = _b.sent();\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    }); };\n}\n","export var AnchorToMarkdown = {\n    anchor: function (state, node) {\n        var attrs = {};\n        if (node.attrs.value) {\n            attrs.id = node.attrs.value;\n        }\n        var attrsSerialized = Object.keys(attrs)\n            .map(function (key) { return key + \"=\\\"\" + attrs[key] + \"\\\"\"; })\n            .join(\" \");\n        state.write(\"<a \" + attrsSerialized + \"></a>\");\n    }\n};\n","/**\n * Non-standard tool for applying a css class name to a region of the document\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n// tslint:disable-next-line\nexport var inline_styles = {\n    attrs: {\n        class: { default: \"\" },\n        style: { default: \"\" }\n    },\n    group: \"inline\",\n    parseDOM: [\n        {\n            tag: \"span\",\n            getAttrs: function (node) {\n                return {\n                    class: node.getAttribute(\"class\"),\n                    style: node.attributes.style ? node.attributes.style.value : undefined\n                };\n            }\n        }\n    ],\n    toDOM: function (mark) {\n        return [\n            \"span\",\n            __assign(__assign({}, (mark.attrs.style ? { style: mark.attrs.style } : {})), { class: mark && mark.attrs && mark.attrs.class ? mark.attrs.class : \"\" }),\n            0\n        ];\n    }\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nfunction rangeHasFilteredMark(doc, from, to, type, filter) {\n    var found = false;\n    if (to > from) {\n        doc.nodesBetween(from, to, function (node) {\n            if (type.isInSet(node.marks) && node.marks.filter(filter).length > 0) {\n                found = true;\n            }\n            return !found;\n        });\n    }\n    return found;\n}\nexport function isFilteredMarkActive(state, type, filter) {\n    var _a = state.selection, from = _a.from, $from = _a.$from, to = _a.to, empty = _a.empty;\n    if (empty) {\n        if (!type.isInSet(state.storedMarks || $from.marks())) {\n            return false;\n        }\n        var validMarks = (state.storedMarks || $from.marks()).filter(filter);\n        return validMarks.length > 0;\n    }\n    else {\n        return rangeHasFilteredMark(state.doc, from, to, type, filter);\n    }\n}\nfunction getMarkFromRange(state, from, to, markType) {\n    var result;\n    if (to > from) {\n        state.doc.nodesBetween(from, to, function (node) {\n            if (markType.isInSet(node.marks)) {\n                result = node.marks.find(function (x) { return x.type === markType; });\n                return false;\n            }\n            return true;\n        });\n    }\n    return result;\n}\nfunction getStoredMark(state, markType) {\n    var ref = state.selection;\n    var $cursor = ref.$cursor;\n    if ($cursor) {\n        return (state.storedMarks || $cursor.marks()).find(function (x) { return x.type === markType; });\n    }\n}\nfunction mergeAttrs(oldAttrs, newAttrs) {\n    return __assign(__assign({}, oldAttrs), newAttrs);\n}\nexport function setMarkAttributes(markType, attrs) {\n    return function (state, dispatch) {\n        var ref = state.selection;\n        var $cursor = ref.$cursor;\n        var ranges = ref.ranges;\n        if (dispatch) {\n            if ($cursor) {\n                if (markType.isInSet(state.storedMarks || $cursor.marks())) {\n                    var existingMark = getStoredMark(state, markType);\n                    dispatch(state.tr.removeStoredMark(markType));\n                    if (existingMark) {\n                        dispatch(state.tr.addStoredMark(markType.create(mergeAttrs(existingMark.attrs, attrs))));\n                    }\n                }\n                else {\n                    dispatch(state.tr.addStoredMark(markType.create(attrs)));\n                }\n            }\n            else {\n                var has = false;\n                var tr = state.tr;\n                for (var i = 0; !has && i < ranges.length; i++) {\n                    var ref$1 = ranges[i];\n                    var $from = ref$1.$from;\n                    var $to = ref$1.$to;\n                    has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\n                }\n                for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\n                    var ref$2 = ranges_1[_i];\n                    var $from$1 = ref$2.$from;\n                    var $to$1 = ref$2.$to;\n                    if (has) {\n                        var markAttrs = __assign({}, getMarkFromRange(state, $from$1.pos, $to$1.pos, markType).attrs);\n                        tr.removeMark($from$1.pos, $to$1.pos, markType);\n                        tr.addMark($from$1.pos, $to$1.pos, markType.create(mergeAttrs(markAttrs, attrs)));\n                    }\n                    else {\n                        tr.addMark($from$1.pos, $to$1.pos, markType.create(attrs));\n                    }\n                }\n                dispatch(tr.scrollIntoView());\n            }\n        }\n        return true;\n    };\n}\n","import { isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport React from 'react';\nimport { isFilteredMarkActive, setMarkAttributes } from \"../utils/MarkUtils\";\nexport function inlineStyleClassNameTool(schema, className, classLabel) {\n    var mark = schema.marks.inline_styles;\n    return {\n        name: \"inline_styles_className_\" + className,\n        label: classLabel,\n        displayLabel: React.createElement(\"span\", { className: className }, classLabel),\n        apply: setMarkAttributes(mark, { class: className }),\n        isEnabled: function (state) { return true; },\n        isActive: function (state) { return isFilteredMarkActive(state, mark, function (m) { return m.attrs.class === className; }); },\n    };\n}\nexport function createInlineStylesTools(schema, options) {\n    var tools = [];\n    if (schema.marks.inline_styles && isToolEnabled('inline_styles', options) && options.tools && options.tools.inline_styles) {\n        var inlineStylesOptions = options.tools.inline_styles;\n        if (inlineStylesOptions.classNames) {\n            for (var _i = 0, _a = inlineStylesOptions.classNames; _i < _a.length; _i++) {\n                var className = _a[_i];\n                tools.push(inlineStyleClassNameTool(schema, className.className, className.label));\n            }\n        }\n    }\n    return tools;\n}\n","export var InlineStylesToMarkdown = {\n    inline_styles: {\n        open: function (state, mark, parent, index) {\n            var attrs = {};\n            if (mark.attrs.class) {\n                attrs.class = mark.attrs.class;\n            }\n            var attrsSerialized = Object.keys(attrs)\n                .map(function (key) { return key + \"=\\\"\" + attrs[key] + \"\\\"\"; })\n                .join(\" \");\n            if (attrsSerialized.length > 0) {\n                return \"<span \" + attrsSerialized + \">\";\n            }\n            else {\n                return \"<span>\";\n            }\n        },\n        close: \"</span>\"\n    }\n};\n","// HTML block\n\"use strict\";\nvar blockNames = [\n    \"address\",\n    \"article\",\n    \"aside\",\n    \"base\",\n    \"basefont\",\n    \"blockquote\",\n    \"body\",\n    \"caption\",\n    \"center\",\n    \"col\",\n    \"colgroup\",\n    \"dd\",\n    \"details\",\n    \"dialog\",\n    \"dir\",\n    \"div\",\n    \"dl\",\n    \"dt\",\n    \"fieldset\",\n    \"figcaption\",\n    \"figure\",\n    \"footer\",\n    \"form\",\n    \"frame\",\n    \"frameset\",\n    \"h1\",\n    \"h2\",\n    \"h3\",\n    \"h4\",\n    \"h5\",\n    \"h6\",\n    \"head\",\n    \"header\",\n    \"hr\",\n    \"html\",\n    \"iframe\",\n    \"legend\",\n    \"li\",\n    \"link\",\n    \"main\",\n    \"menu\",\n    \"menuitem\",\n    \"meta\",\n    \"nav\",\n    \"noframes\",\n    \"ol\",\n    \"optgroup\",\n    \"option\",\n    \"p\",\n    \"param\",\n    \"section\",\n    \"source\",\n    \"summary\",\n    \"table\",\n    \"tbody\",\n    \"td\",\n    \"tfoot\",\n    \"th\",\n    \"thead\",\n    \"title\",\n    \"tr\",\n    \"track\",\n    \"ul\"\n];\nvar attrName = \"[a-zA-Z_:][a-zA-Z0-9:._-]*\";\nvar unquoted = \"[^\\\"'=<>`\\\\x00-\\\\x20]+\";\nvar singleQuoted = \"'[^']*'\";\nvar doubleQuoted = '\"[^\"]*\"';\nvar attrValue = \"(?:\" + unquoted + \"|\" + singleQuoted + \"|\" + doubleQuoted + \")\";\nvar attribute = \"(?:\\\\s+\" + attrName + \"(?:\\\\s*=\\\\s*\" + attrValue + \")?)\";\nvar openTag = \"<[A-Za-z][A-Za-z0-9\\\\-]*\" + attribute + \"*\\\\s*\\\\/?>\";\nvar closeTag = \"<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>\";\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp(\"^(?:\" + openTag + \"|\" + closeTag + \")\");\n// An array of opening and corresponding closing sequences for html tags,\n// last argument defines whether it can terminate a paragraph or not\n//\nvar HTML_SEQUENCES = [\n    [/^<(script|pre|style)(?=(\\s|>|$))/i, /<\\/(script|pre|style)>/i, true],\n    [/^<!--/, /-->/, true],\n    [/^<\\?/, /\\?>/, true],\n    [/^<![A-Z]/, />/, true],\n    [/^<!\\[CDATA\\[/, /\\]\\]>/, true],\n    [\n        new RegExp(\"^</?(\" + blockNames.join(\"|\") + \")(?=(\\\\s|/?>|$))\", \"i\"),\n        /^$/,\n        true\n    ],\n    [new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + \"\\\\s*$\"), /^$/, false]\n];\nexport function html_block(state, startLine, endLine, silent) {\n    var i;\n    var nextLine;\n    var token;\n    var lineText;\n    var pos = state.bMarks[startLine] + state.tShift[startLine];\n    var max = state.eMarks[startLine];\n    // if it's indented more than 3 spaces, it should be a code block\n    if (state.sCount[startLine] - state.blkIndent >= 4) {\n        return false;\n    }\n    if (!state.md.options.html) {\n        return false;\n    }\n    if (state.src.charCodeAt(pos) !== 0x3c /* < */) {\n        return false;\n    }\n    lineText = state.src.slice(pos, max);\n    for (i = 0; i < HTML_SEQUENCES.length; i++) {\n        if (HTML_SEQUENCES[i][0].test(lineText)) {\n            break;\n        }\n    }\n    if (i === HTML_SEQUENCES.length) {\n        return false;\n    }\n    if (silent) {\n        // true if this sequence can be a terminator, false otherwise\n        return HTML_SEQUENCES[i][2];\n    }\n    nextLine = startLine + 1;\n    // If we are here - we detected HTML block.\n    // Let's roll down till block end.\n    if (!HTML_SEQUENCES[i][1].test(lineText)) {\n        for (; nextLine < endLine; nextLine++) {\n            if (state.sCount[nextLine] < state.blkIndent) {\n                break;\n            }\n            pos = state.bMarks[nextLine] + state.tShift[nextLine];\n            max = state.eMarks[nextLine];\n            lineText = state.src.slice(pos, max);\n            if (HTML_SEQUENCES[i][1].test(lineText)) {\n                if (lineText.length !== 0) {\n                    nextLine++;\n                }\n                break;\n            }\n        }\n    }\n    var content = state.getLines(startLine, nextLine, state.blkIndent, true);\n    var dom = new DOMParser().parseFromString(content, \"text/html\");\n    var tag = dom.body.firstChild;\n    var innerContent = tag == null ? \"\" : tag.innerHTML;\n    state.line = nextLine;\n    token = state.push(\"html_block_open\", \"\", 1);\n    token.meta = { tag: tag.tagName, attrs: Array.from(tag.attributes) };\n    token.map = [startLine, state.line];\n    token = state.push(\"inline\", \"\", 0);\n    token.map = [startLine, nextLine];\n    token.content = innerContent;\n    token.children = [];\n    token = state.push(\"html_block_close\", \"\", -1);\n    token.meta = { tag: tag.tagName };\n    return true;\n}\n","// Process &shy;\nexport function soft_hyphen_from(state, silent) {\n    var pos = state.pos;\n    if (state.src.slice(pos, pos + 5) !== \"&shy;\") {\n        return false;\n    }\n    if (!silent) {\n        var content = state.src.slice(pos, pos + 5);\n        var token = state.push(\"soft_hyphen\", \"shy\", 0);\n        token.attrs = [];\n        token.content = content;\n    }\n    state.pos = pos + 5;\n    return true;\n}\n","// tslint:disable-next-line\nexport var soft_hyphen = {\n    group: \"inline\",\n    inline: true,\n    parseDOM: [\n        {\n            tag: \"span[data-shy]\",\n            getAttrs: function (dom) {\n                return {};\n            }\n        }\n    ],\n    toDOM: function (node) {\n        return [\"span\", { \"data-shy\": true }, \"-\"];\n    }\n};\n","export var SoftHyphenToMarkdown = {\n    soft_hyphen: function (state, node) {\n        state.write(\"&shy;\");\n    }\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { getDefaultClass, } from \"@dc-extension-rich-text/common\";\nimport { html_block } from \"../alignment\";\nimport { soft_hyphen_from } from \"../soft_hyphen\";\n// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\n// tslint:disable-next-line\nvar markdownit = require(\"markdown-it\");\n// tslint:disable-next-line\nvar markdownItTable = require(\"markdown-it-table\").markdownItTable;\nexport function createMarkdownParser(schema, options) {\n    var md = markdownit(\"commonmark\", {\n        html: true,\n        linkify: false,\n    });\n    md.use(markdownItTable);\n    md.inline.ruler.before(\"text\", \"soft_hyphen\", soft_hyphen_from);\n    md.block.ruler.before(\"html_block\", \"html_block\", html_block);\n    // Patch parser to detect <span></span> tags and convert into inline_styles marks\n    // Warning... this might be a little brittle\n    var parser = new markdown.MarkdownParser(schema, md, __assign(__assign({}, markdown.defaultMarkdownParser.tokens), { link: {\n            mark: \"link\",\n            getAttrs: function (tok) { return ({\n                href: tok.attrGet(\"href\"),\n                title: tok.attrGet(\"title\") || null,\n                target: tok.attrGet(\"target\") || null,\n                rel: tok.attrGet(\"rel\") || null,\n            }); },\n        }, anchor: {\n            node: \"anchor\",\n            getAttrs: function (tok) { return ({\n                value: tok.attrGet(\"value\"),\n            }); },\n        }, fence: {\n            block: \"code_block\",\n            getAttrs: function (tok) { return ({ params: tok.info || \"\" }); },\n            noCloseToken: true,\n        }, soft_hyphen: { node: \"soft_hyphen\" }, table: { block: \"table\" }, th: {\n            block: \"table_header\",\n            getAttrs: function (tok) { return ({\n                style: tok.attrGet(\"style\"),\n            }); },\n        }, tr: { block: \"table_row\" }, td: {\n            block: \"table_cell\",\n            getAttrs: function (tok) { return ({\n                style: tok.attrGet(\"style\"),\n            }); },\n        } }));\n    var originalParagraph = parser.tokenHandlers.paragraph;\n    parser.tokenHandlers.paragraph = function (state, token, tokens, i) {\n        if (token.content && /\\n\\d+\\n\\d+/.test(token.content)) {\n            token.content = token.content.replace(/\\n\\d+\\n\\d+/g, \"\\n\\n\");\n        }\n        originalParagraph(state, token, tokens, i);\n    };\n    parser.tokenHandlers.html_inline = function (state, token) {\n        if (!token || !token.content) {\n            return;\n        }\n        var content = (token.content || \"\").trim();\n        if (content.startsWith(\"<span\") && content.endsWith(\">\")) {\n            var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n            var tag = dom.body.firstChild;\n            if (!tag) {\n                return;\n            }\n            if (tag.nodeName.toLowerCase() === \"span\") {\n                var className = tag.getAttribute(\"class\");\n                state.openMark(schema.marks.inline_styles.create({\n                    class: className,\n                }));\n            }\n        }\n        else if (content === \"</span>\") {\n            state.closeMark(schema.marks.inline_styles);\n        }\n        else if (content.startsWith(\"<a\") && content.endsWith(\">\")) {\n            var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n            var tag = dom.body.firstChild;\n            if (!tag) {\n                return;\n            }\n            if (tag.nodeName.toLowerCase() === \"a\") {\n                var id = tag.getAttribute(\"id\");\n                var href = tag.getAttribute(\"href\");\n                var title = tag.getAttribute(\"title\");\n                var target = tag.getAttribute(\"target\");\n                var rel = tag.getAttribute(\"rel\");\n                if (id != null) {\n                    state.addNode(schema.nodes.anchor, {\n                        value: id,\n                    });\n                }\n                else if (href) {\n                    state.openMark(schema.marks.link.create({\n                        href: href,\n                        title: title || null,\n                        target: target || null,\n                        rel: rel || null,\n                    }));\n                }\n            }\n        }\n        else if (content === \"</a>\") {\n            state.closeMark(schema.marks.link);\n        }\n        else if (content === \"<br>\") {\n            state.addNode(schema.nodes.hard_break);\n        }\n        else {\n            var html = token.content;\n            var linkMatch = html.match(/<a\\s+([^>]*)>\\s*([\\s\\S]*?)\\s*<\\/a>/i);\n            if (linkMatch) {\n                var attrs = linkMatch[1];\n                var content_1 = linkMatch[2];\n                var hrefMatch = attrs.match(/href=\"([^\"]*)\"/);\n                var titleMatch = attrs.match(/title=\"([^\"]*)\"/);\n                var targetMatch = attrs.match(/target=\"([^\"]*)\"/);\n                var relMatch = attrs.match(/rel=\"([^\"]*)\"/);\n                if (hrefMatch) {\n                    var mark = schema.marks.link.create({\n                        href: hrefMatch[1],\n                        title: titleMatch ? titleMatch[1] : null,\n                        target: targetMatch ? targetMatch[1] : null,\n                        rel: relMatch ? relMatch[1] : null,\n                    });\n                    state.openMark(mark);\n                    state.addText(content_1);\n                    state.closeMark(mark);\n                }\n            }\n        }\n    };\n    var alignedParagraphTypes = new Map([\n        [\"P\", \"paragraph\"],\n        [\"H1\", \"heading\"],\n        [\"H2\", \"heading\"],\n        [\"H3\", \"heading\"],\n        [\"H4\", \"heading\"],\n        [\"H5\", \"heading\"],\n        [\"H6\", \"heading\"],\n    ]);\n    var alignmentClasses = new Map([\n        [\"amp-align-left\", \"left\"],\n        [\"amp-align-center\", \"center\"],\n        [\"amp-align-right\", \"right\"],\n        [\"amp-align-justify\", \"justify\"],\n    ]);\n    // tslint:disable-next-line\n    parser.tokenHandlers.html_block_open = function (state, token) {\n        if (!alignedParagraphTypes.has(token.meta.tag)) {\n            return;\n        }\n        var styleAttr = token.meta.attrs.find(function (attr) { return attr.name === \"style\"; });\n        var alignAttr = \"left\";\n        if (styleAttr) {\n            alignAttr =\n                styleAttr.ownerElement.style.textAlign || alignAttr;\n        }\n        var classAttr = token.meta.attrs.find(function (attr) { return attr.name === \"class\"; });\n        if (classAttr) {\n            // Styles may be present in classes instead\n            classAttr.ownerElement.classList.forEach(function (value) {\n                var asDefault = getDefaultClass(value, options);\n                alignAttr = alignmentClasses.get(asDefault) || \"left\";\n            });\n        }\n        var nodeType = alignedParagraphTypes.get(token.meta.tag);\n        var level = nodeType === \"heading\" ? Number(token.meta.tag[1]) : undefined;\n        state.openNode(schema.nodes[nodeType], {\n            align: alignAttr ? alignAttr : \"left\",\n            level: level,\n        });\n    };\n    // tslint:disable-next-line\n    parser.tokenHandlers.html_block_close = function (state, token) {\n        if (alignedParagraphTypes.has(token.meta.tag)) {\n            state.closeNode();\n        }\n    };\n    return parser;\n}\n","import { getCustomClass } from \"@dc-extension-rich-text/common\";\n// tslint:disable-next-line\nexport var paragraph_align = {\n    content: \"inline*\",\n    attrs: {\n        align: { default: \"left\" }\n    },\n    group: \"block\",\n    parseDOM: [\n        {\n            tag: \"p\",\n            getAttrs: function (dom) {\n                return { align: dom.style.textAlign };\n            }\n        }\n    ],\n    toDOM: function (node) {\n        return [\"p\", { style: \"text-align: \" + (node.attrs.align || \"left\") }, 0];\n    }\n};\nfunction getHeadingAttrs(level) {\n    return function getAttrs(dom) {\n        return { align: dom.style.textAlign, level: level };\n    };\n}\n// tslint:disable-next-line\nexport var heading_align = {\n    attrs: {\n        level: { default: 1 },\n        align: { default: \"left\" }\n    },\n    content: \"inline*\",\n    group: \"block\",\n    defining: true,\n    parseDOM: [\n        { tag: \"h1\", getAttrs: getHeadingAttrs(1) },\n        { tag: \"h2\", getAttrs: getHeadingAttrs(2) },\n        { tag: \"h3\", getAttrs: getHeadingAttrs(3) },\n        { tag: \"h4\", getAttrs: getHeadingAttrs(4) },\n        { tag: \"h5\", getAttrs: getHeadingAttrs(5) },\n        { tag: \"h6\", getAttrs: getHeadingAttrs(6) }\n    ],\n    toDOM: function (node) {\n        return [\n            \"h\" + node.attrs.level,\n            { style: \"text-align: \" + (node.attrs.align || \"left\") },\n            0\n        ];\n    }\n};\nexport var AlignedParagraphToMarkdown = function (options) { return ({\n    paragraph: function (state, node) {\n        if (node.attrs.align &&\n            node.attrs.align !== \"left\" &&\n            node.attrs.align !== \"start\") {\n            // Aligned paragraph\n            // Emit paragraph as HTML with the align attribute.\n            if (options.useClasses) {\n                state.write(\"<p class=\\\"\" + getCustomClass(\"amp-align-\" + node.attrs.align, options) + \"\\\">\");\n            }\n            else {\n                state.write(\"<p style=\\\"text-align: \" + node.attrs.align + \"\\\">\");\n            }\n            state.renderInline(node);\n            state.write(\"</p>\");\n            state.closeBlock(node);\n        }\n        else {\n            state.renderInline(node);\n            state.closeBlock(node);\n        }\n    }\n}); };\nexport var AlignedHeaderToMarkdown = function (options) { return ({\n    heading: function (state, node) {\n        if (node.attrs.align &&\n            node.attrs.align !== \"left\" &&\n            node.attrs.align !== \"start\") {\n            // Aligned header\n            // Emit header as HTML with the align attribute.\n            if (options.useClasses) {\n                state.write(\"<h\" + node.attrs.level + \" class=\\\"\" + getCustomClass(\"amp-align-\" + node.attrs.align, options) + \"\\\">\");\n            }\n            else {\n                state.write(\"<h\" + node.attrs.level + \" style=\\\"text-align: \" + node.attrs.align + \"\\\">\");\n            }\n            state.renderInline(node);\n            state.write(\"</h\" + node.attrs.level + \">\");\n            state.closeBlock(node);\n        }\n        else {\n            state.write(state.repeat(\"#\", node.attrs.level) + \" \");\n            state.renderInline(node);\n            state.closeBlock(node);\n        }\n    }\n}); };\n","var defaultRowWidth = 8;\nfunction tableRemoveNewlines(input) {\n    return input\n        .trimEnd()\n        .replace(/\\\\?\\n/g, \"<br>\")\n        .padEnd(defaultRowWidth, \" \");\n}\nfunction withTableEscapes(state, action) {\n    var start = state.out.length;\n    action();\n    state.out =\n        state.out.substr(0, start) + tableRemoveNewlines(state.out.substr(start));\n    state.closed = false;\n}\nexport var TableToMarkdown = {\n    table: function (state, node) {\n        var rows = [];\n        for (var i = 0; i < node.childCount; i++) {\n            var child = node.maybeChild(i);\n            if (child != null && child.type.name === \"table_row\") {\n                rows.push(child);\n            }\n        }\n        if (rows.length === 0) {\n            return;\n        }\n        // First row is the header row. Get column count, and draw it.\n        state.render(rows[0]);\n        var columnCount = rows[0].childCount; // Assumes first row is header.\n        // Draw divider using the number of columns.\n        state.write(\"\\n\");\n        for (var i = 0; i < columnCount; i++) {\n            state.write(\"|----------\");\n        }\n        state.write(\"|\");\n        // Second row onwards are regular rows.\n        for (var i = 1; i < rows.length; i++) {\n            state.write(\"\\n\");\n            state.render(rows[i]);\n        }\n        state.closeBlock(node);\n    },\n    table_row: function (state, node) {\n        state.write(\"| \");\n        var _loop_1 = function (i) {\n            var child = node.maybeChild(i);\n            if (child != null) {\n                if (i > 0) {\n                    state.write(\" | \");\n                }\n                withTableEscapes(state, function () {\n                    state.renderInline(child);\n                });\n            }\n        };\n        for (var i = 0; i < node.childCount; i++) {\n            _loop_1(i);\n        }\n        state.write(\" |\");\n    },\n    table_cell: function (state, node) {\n        state.renderInline(node);\n    },\n    table_header: function (state, node) {\n        state.renderInline(node);\n    }\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { AlignedHeaderToMarkdown, AlignedParagraphToMarkdown, } from \"../alignment/AlignmentPlugin\";\nimport { AnchorToMarkdown } from \"../anchor\";\nimport { InlineStylesToMarkdown } from \"../inline_styles\";\nimport { SoftHyphenToMarkdown } from \"../soft_hyphen\";\nimport { TableToMarkdown } from \"../tables/TableToMarkdown\";\n// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\nfunction escape(text) {\n    return text\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\");\n}\nfunction cleanPositionMarkers(text) {\n    var normalized = text.replace(/\\\\\\\\\\\\n/g, \"\\\\\\\\n\");\n    return normalized.replace(/((?:\\\\n)|\\r?\\n)[ \\t]*\\d+[ \\t]*(?=(?:\\\\n)|\\r?\\n|$)/g, function (_m, nl) { return (nl === \"\\\\n\" ? \"\\\\n\" : \"\\n\\n\"); });\n}\nvar TextToMarkdown = {\n    text: function (state, node) {\n        state.text(escape(node.text));\n    },\n};\nexport function createMarkdownSerializer(options, serializers) {\n    if (serializers === void 0) { serializers = {}; }\n    var defaultMarkdownSerializer = new markdown.MarkdownSerializer(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign({}, markdown.defaultMarkdownSerializer.nodes), SoftHyphenToMarkdown), AnchorToMarkdown), TableToMarkdown), AlignedParagraphToMarkdown(options)), AlignedHeaderToMarkdown(options)), TextToMarkdown), serializers), __assign(__assign({}, markdown.defaultMarkdownSerializer.marks), InlineStylesToMarkdown));\n    defaultMarkdownSerializer.marks.link = {\n        open: function (state) {\n            state.write(\"[\");\n            state._linkOpen = state.out.length - 1;\n            return \"\";\n        },\n        close: function (state, mark) {\n            var _a = mark.attrs, href = _a.href, title = _a.title, target = _a.target, rel = _a.rel;\n            var openIndex = typeof state._linkOpen === \"number\"\n                ? state._linkOpen\n                : state.out.lastIndexOf(\"[\");\n            var linkText = state.out.slice(openIndex + 1);\n            state.out = state.out.slice(0, openIndex);\n            if (target || rel) {\n                var relAttr = rel ? \" rel=\\\"\" + rel + \"\\\"\" : \"\";\n                return \"<a href=\\\"\" + href + \"\\\"\" + (title ? \" title=\\\"\" + title + \"\\\"\" : \"\") + (target ? \" target=\\\"\" + target + \"\\\"\" : \"\") + relAttr + \">\" + linkText + \"</a>\";\n            }\n            return \"[\" + linkText + \"](\" + href + (title ? \" \\\"\" + title + \"\\\"\" : \"\") + \")\";\n        },\n    };\n    var originalSerialize = defaultMarkdownSerializer.serialize;\n    defaultMarkdownSerializer.serialize = function (doc) {\n        var output = originalSerialize.call(this, doc);\n        return cleanPositionMarkers(output);\n    };\n    return defaultMarkdownSerializer;\n}\n","import { heading_align, paragraph_align } from \"../alignment/AlignmentPlugin\";\nimport { anchor } from \"../anchor\";\nimport { inline_styles } from \"../inline_styles\";\nimport { createMarkdownParser } from \"../markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"../markdown/MarkdownSerializer\";\nimport { soft_hyphen } from \"../soft_hyphen\";\n// tslint:disable-next-line\nvar tableNodes = require(\"prosemirror-tables\").tableNodes;\n// tslint:disable-next-line\nvar Schema = require(\"prosemirror-model\").Schema;\nexport function createSchema(options, isInlineStylesEnabled) {\n    if (isInlineStylesEnabled === void 0) { isInlineStylesEnabled = false; }\n    var schema = require(\"prosemirror-markdown\").schema;\n    // TODO: don't register nodes and marks that are disabled in the options\n    var marks = schema.spec.marks.update(\"link\", {\n        attrs: {\n            href: {},\n            title: { default: null },\n            target: { default: null },\n            rel: { default: null },\n        },\n        inclusive: false,\n        parseDOM: [\n            {\n                tag: \"a[href]\",\n                getAttrs: function (dom) {\n                    return {\n                        href: dom.getAttribute(\"href\"),\n                        title: dom.getAttribute(\"title\"),\n                        target: dom.getAttribute(\"target\"),\n                        rel: dom.getAttribute(\"rel\"),\n                    };\n                },\n            },\n        ],\n        toDOM: function (node) {\n            var _a = node.attrs, href = _a.href, title = _a.title, target = _a.target, rel = _a.rel;\n            return [\"a\", { href: href, title: title, target: target, rel: rel }, 0];\n        },\n    });\n    if (isInlineStylesEnabled) {\n        marks = marks.addToEnd(\"inline_styles\", inline_styles);\n    }\n    var nodes = schema.spec.nodes\n        .append(tableNodes({\n        tableGroup: \"block\",\n        cellContent: \"block\",\n        cellAttributes: {\n            background: {\n                default: null,\n                // tslint:disable-next-line\n                getFromDOM: function (dom) {\n                    return dom.style.backgroundColor || null;\n                },\n                // tslint:disable-next-line\n                setDOMAttr: function (value, attrs) {\n                    if (value) {\n                        attrs.style =\n                            (attrs.style || \"\") + (\"background-color: \" + value + \";\");\n                    }\n                },\n            },\n        },\n    }))\n        .addToEnd(\"soft_hyphen\", soft_hyphen)\n        .addToEnd(\"anchor\", anchor)\n        .update(\"paragraph\", paragraph_align)\n        .update(\"heading\", heading_align);\n    return new Schema({\n        nodes: nodes,\n        marks: marks,\n    });\n}\nvar serializer;\nvar parser;\nexport function getDefaultSerializerParser(schema, options) {\n    if (serializer == null) {\n        serializer = createMarkdownSerializer(options);\n        parser = createMarkdownParser(schema, options);\n    }\n    return [serializer, parser];\n}\n","import { canInsert } from \"@dc-extension-rich-text/common\";\nimport { BorderClear, FirstPage, LastPage, TableChart, VerticalAlignBottom, VerticalAlignTop } from \"@material-ui/icons\";\nimport { addColumnAfter, addRowAfter, deleteColumn, deleteRow, deleteTable, } from \"prosemirror-tables\";\nimport React from \"react\";\n// tslint:disable-next-line: no-var-requires\nvar Fragment = require('prosemirror-model').Fragment;\nfunction inTable(state) {\n    var path = state.selection.$head.path;\n    for (var i = 0; i < path.length; i += 3) {\n        if (path[i].type.name === 'table') {\n            return true;\n        }\n    }\n    return false;\n}\nfunction generateEmptyCell(state, type) {\n    return type.create(undefined, Fragment.fromArray([\n        state.schema.nodes.paragraph.create()\n    ]));\n}\nfunction insertTable(state, dispatch) {\n    var tr = state.tr.replaceSelectionWith(state.schema.nodes.table.create(undefined, Fragment.fromArray([\n        state.schema.nodes.table_row.create(undefined, Fragment.fromArray([\n            generateEmptyCell(state, state.schema.nodes.table_header),\n            generateEmptyCell(state, state.schema.nodes.table_header),\n        ])),\n        state.schema.nodes.table_row.create(undefined, Fragment.fromArray([\n            generateEmptyCell(state, state.schema.nodes.table_cell),\n            generateEmptyCell(state, state.schema.nodes.table_cell),\n        ])),\n    ])));\n    if (dispatch) {\n        dispatch(tr);\n    }\n    return true;\n}\nexport function CreateTableTool(schema) {\n    return {\n        name: \"table_create\",\n        label: \"Create Table\",\n        displayIcon: React.createElement(TableChart, null),\n        apply: insertTable,\n        isEnabled: function (state) { return canInsert(state, schema.nodes.table); },\n        isVisible: function (state) { return !inTable(state); },\n    };\n}\nexport function AddRowTool(schema) {\n    return {\n        name: \"table_row_add\",\n        label: \"Add Row\",\n        displayIcon: React.createElement(VerticalAlignBottom, null),\n        apply: addRowAfter,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function AddColumnTool(schema) {\n    return {\n        name: \"table_col_add\",\n        label: \"Add Column\",\n        displayIcon: React.createElement(LastPage, null),\n        apply: addColumnAfter,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function DeleteRowTool(schema) {\n    return {\n        name: \"table_row_delete\",\n        label: \"Delete Row\",\n        displayIcon: React.createElement(VerticalAlignTop, null),\n        apply: deleteRow,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function DeleteColumnTool(schema) {\n    return {\n        name: \"table_col_delete\",\n        label: \"Delete Column\",\n        displayIcon: React.createElement(FirstPage, null),\n        apply: deleteColumn,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function DeleteTableTool(schema) {\n    return {\n        name: \"table_delete\",\n        label: \"Delete Table\",\n        displayIcon: React.createElement(BorderClear, null),\n        apply: deleteTable,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { createStandardTools, isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport { AlignCenterTool, AlignJustifyTool, AlignLeftTool, AlignRightTool } from \"./alignment/AlignmentTools\";\nimport { AnchorTool } from \"./anchor\";\nimport { createInlineStylesTools } from \"./inline_styles\";\nimport { createMarkdownParser } from \"./markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"./markdown/MarkdownSerializer\";\nimport { createSchema } from \"./schema/createSchema\";\nimport { SoftHyphenTool } from \"./soft_hyphen\";\nimport { AddColumnTool, AddRowTool, CreateTableTool, DeleteColumnTool, DeleteRowTool, DeleteTableTool } from \"./tables/TableTools\";\nexport function createMarkdownTools(schema, options) {\n    var tools = [];\n    if (isToolEnabled(\"inline_styles\", options)) {\n        tools = tools.concat(tools, createInlineStylesTools(schema, options));\n    }\n    if (isToolEnabled(\"anchor\", options) && schema.nodes.anchor) {\n        tools.push(AnchorTool(schema));\n    }\n    if (isToolEnabled(\"soft_hyphen\", options) && schema.nodes.soft_hyphen) {\n        tools.push(SoftHyphenTool(schema));\n    }\n    // Alignment\n    if (isToolEnabled(\"align_left\", options)) {\n        tools.push(AlignLeftTool(schema));\n    }\n    if (isToolEnabled(\"align_center\", options)) {\n        tools.push(AlignCenterTool(schema));\n    }\n    if (isToolEnabled(\"align_right\", options)) {\n        tools.push(AlignRightTool(schema));\n    }\n    if (isToolEnabled(\"align_justify\", options)) {\n        tools.push(AlignJustifyTool(schema));\n    }\n    if (schema.nodes.table) {\n        if (isToolEnabled(\"table_create\", options)) {\n            tools.push(CreateTableTool(schema));\n        }\n        if (isToolEnabled(\"table_delete\", options)) {\n            tools.push(DeleteTableTool(schema));\n        }\n        if (isToolEnabled(\"table_row_add\", options)) {\n            tools.push(AddRowTool(schema));\n        }\n        if (isToolEnabled(\"table_col_add\", options)) {\n            tools.push(AddColumnTool(schema));\n        }\n        if (isToolEnabled(\"table_row_delete\", options)) {\n            tools.push(DeleteRowTool(schema));\n        }\n        if (isToolEnabled(\"table_col_delete\", options)) {\n            tools.push(DeleteColumnTool(schema));\n        }\n    }\n    return tools;\n}\nvar MarkdownLanguage = /** @class */ (function () {\n    function MarkdownLanguage(options) {\n        if (options === void 0) { options = {}; }\n        this.name = \"markdown\";\n        this.label = \"Markdown\";\n        var schema = this.createSchema(options);\n        var tools = __spreadArrays(createStandardTools(schema, options), createMarkdownTools(schema, options));\n        var serializer = createMarkdownSerializer(options, this.getNodeSerializers());\n        var parser = createMarkdownParser(schema, options);\n        this.schema = schema;\n        this.tools = tools;\n        this.serializer = serializer;\n        this.parser = parser;\n    }\n    MarkdownLanguage.prototype.serialize = function (doc) {\n        return this.serializeMarkdown(doc);\n    };\n    MarkdownLanguage.prototype.parse = function (data) {\n        return this.parseMarkdown(data);\n    };\n    MarkdownLanguage.prototype.serializeMarkdown = function (doc) {\n        return this.serializer.serialize(doc);\n    };\n    MarkdownLanguage.prototype.canSerializeNodeToMarkdown = function (schema, node) {\n        if (!node.type) {\n            return false;\n        }\n        else {\n            return this.serializer.nodes[node.type] != null;\n        }\n    };\n    MarkdownLanguage.prototype.parseMarkdown = function (data) {\n        if (!data) {\n            data = \"\";\n        }\n        return this.parser.parse(data);\n    };\n    MarkdownLanguage.prototype.getNodeSerializers = function () {\n        return {};\n    };\n    MarkdownLanguage.prototype.createSchema = function (options) {\n        if (options === void 0) { options = {}; }\n        var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\n        return createSchema(options, isInlineStylesEnabled);\n    };\n    return MarkdownLanguage;\n}());\nexport default MarkdownLanguage;\n","import { canInsert } from \"@dc-extension-rich-text/common\";\nimport { Remove } from \"@material-ui/icons\";\nimport React from \"react\";\nexport function SoftHyphenTool(schema) {\n    return {\n        name: \"soft_hyphen\",\n        label: \"Insert Soft Hyphen\",\n        displayIcon: React.createElement(Remove, null),\n        apply: function (state, dispatch) {\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.soft_hyphen.create()));\n        },\n        isEnabled: function (state) { return canInsert(state, schema.nodes.soft_hyphen); },\n    };\n}\n","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n    format: RichLanguageFormat.TEXT\n};\nexport default conf;\n","import MarkdownLanguage from \"./MarkdownLanguage\";\nimport MarkdownLanguageConfiguration from \"./MarkdownLanguageConfiguration\";\nexport default function (options) {\n    return {\n        language: new MarkdownLanguage(options),\n        conf: MarkdownLanguageConfiguration\n    };\n}\nexport * from \"./schema/createSchema\";\nexport { createMarkdownTools } from \"./MarkdownLanguage\";\nexport * from \"./markdown/MarkdownParser\";\nexport * from \"./markdown/MarkdownSerializer\";\nexport { default as MarkdownLanguage } from \"./MarkdownLanguage\";\n","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\n// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar DcImageLinkBlock = /** @class */ (function () {\n    function DcImageLinkBlock() {\n    }\n    DcImageLinkBlock.prototype.canSerialize = function (schema, node) {\n        return node.type === \"dc-image-link\";\n    };\n    DcImageLinkBlock.prototype.serialize = function (schema, nodes) {\n        return nodes.map(function (node) {\n            return {\n                type: \"dc-image-link\",\n                data: node.attrs.value\n            };\n        });\n    };\n    DcImageLinkBlock.prototype.canParse = function (schema, block) {\n        return block.type === \"dc-image-link\";\n    };\n    DcImageLinkBlock.prototype.parse = function (schema, blocks) {\n        var result = [];\n        blocks.forEach(function (block) {\n            result.push({\n                type: \"dc-image-link\",\n                attrs: {\n                    value: block.data\n                }\n            });\n        });\n        return result;\n    };\n    return DcImageLinkBlock;\n}());\nexport default DcImageLinkBlock;\n","// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar MarkdownBlock = /** @class */ (function () {\n    function MarkdownBlock(options, markdownLanguage) {\n        this.options = options;\n        this.markdownLanguage = markdownLanguage;\n    }\n    MarkdownBlock.prototype.canSerialize = function (schema, node) {\n        return this.markdownLanguage.canSerializeNodeToMarkdown(schema, node);\n    };\n    MarkdownBlock.prototype.serialize = function (schema, nodes) {\n        var parsedNodes = Node.fromJSON(schema, {\n            type: \"doc\",\n            content: nodes\n        });\n        return [\n            {\n                type: \"markdown\",\n                data: this.markdownLanguage.serializeMarkdown(parsedNodes)\n            }\n        ];\n    };\n    MarkdownBlock.prototype.canParse = function (schema, block) {\n        return block.type === \"markdown\";\n    };\n    MarkdownBlock.prototype.parse = function (schema, blocks) {\n        var _this = this;\n        var result = [];\n        blocks.forEach(function (block) {\n            var doc = _this.markdownLanguage\n                .parseMarkdown(block.data || \"\")\n                .toJSON();\n            result = result.concat.apply(result, doc.content || []);\n        });\n        return result;\n    };\n    return MarkdownBlock;\n}());\nexport default MarkdownBlock;\n","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n    format: RichLanguageFormat.JSON\n};\nexport default conf;\n","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\n// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar DcContentLinkBlock = /** @class */ (function () {\n    function DcContentLinkBlock() {\n    }\n    DcContentLinkBlock.prototype.canSerialize = function (schema, node) {\n        return node.type === \"dc-content-link\";\n    };\n    DcContentLinkBlock.prototype.serialize = function (schema, nodes) {\n        return nodes.map(function (node) {\n            return {\n                type: \"dc-content-link\",\n                data: node.attrs.value\n            };\n        });\n    };\n    DcContentLinkBlock.prototype.canParse = function (schema, block) {\n        return block.type === \"dc-content-link\";\n    };\n    DcContentLinkBlock.prototype.parse = function (schema, blocks) {\n        var result = [];\n        blocks.forEach(function (block) {\n            result.push({\n                type: \"dc-content-link\",\n                attrs: {\n                    value: block.data\n                }\n            });\n        });\n        return result;\n    };\n    return DcContentLinkBlock;\n}());\nexport default DcContentLinkBlock;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { MarkdownLanguage } from \"@dc-extension-rich-text/language-markdown\";\nimport { createDynamicContentTools, DcContentLinkNode, DcImageLinkNode, } from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport DcContentLinkBlock from \"./blocks/DcContentLinkBlock\";\nimport DcImageLinkBlock from \"./blocks/DcImageLinkBlock\";\nimport MarkdownBlock from \"./blocks/MarkdownBlock\";\n// tslint:disable-next-line\nvar Schema = require(\"prosemirror-model\").Schema;\n// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar JSONLanguage = /** @class */ (function (_super) {\n    __extends(JSONLanguage, _super);\n    function JSONLanguage(options, blockTypes) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, options) || this;\n        _this.name = \"json\";\n        _this.label = \"JSON\";\n        _this.markdownBlock = new MarkdownBlock(options, _this);\n        _this.blockTypes = blockTypes || [\n            new DcImageLinkBlock(),\n            new DcContentLinkBlock(),\n            _this.markdownBlock,\n        ];\n        _this.tools = __spreadArrays(_this.tools, createDynamicContentTools(_this.schema, options));\n        return _this;\n    }\n    JSONLanguage.prototype.serialize = function (doc) {\n        var _this = this;\n        if (!doc) {\n            return [];\n        }\n        doc = doc.toJSON();\n        var fragments = [];\n        if (!doc.content || doc.content.length === 0) {\n            return fragments;\n        }\n        var nodesByConverter = groupBy(doc.content, function (node) {\n            for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n                var blockType = _a[_i];\n                if (blockType.canSerialize(_this.schema, node)) {\n                    return blockType;\n                }\n            }\n        });\n        var blocks = [];\n        for (var _i = 0, nodesByConverter_1 = nodesByConverter; _i < nodesByConverter_1.length; _i++) {\n            var group = nodesByConverter_1[_i];\n            var groupBlocks = group.group.serialize(this.schema, group.items);\n            blocks = blocks.concat.apply(blocks, groupBlocks);\n        }\n        return blocks;\n    };\n    JSONLanguage.prototype.parse = function (blocks) {\n        var _this = this;\n        if (!blocks || blocks.length === 0) {\n            return Node.fromJSON(this.schema, {\n                type: \"doc\",\n                content: [\n                    {\n                        type: \"paragraph\",\n                    },\n                ],\n            });\n        }\n        var result = {\n            type: \"doc\",\n            content: [],\n        };\n        var blocksGroupedByConverter = groupBy(blocks, function (block) {\n            for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n                var blockType = _a[_i];\n                if (blockType.canParse(_this.schema, block)) {\n                    return blockType;\n                }\n            }\n        });\n        for (var _i = 0, blocksGroupedByConverter_1 = blocksGroupedByConverter; _i < blocksGroupedByConverter_1.length; _i++) {\n            var group = blocksGroupedByConverter_1[_i];\n            var parsedNodes = group.group.parse(this.schema, group.items);\n            result.content = result.content.concat.apply(result.content, parsedNodes);\n        }\n        return Node.fromJSON(this.schema, result);\n    };\n    JSONLanguage.prototype.createSchema = function (options) {\n        var schema = _super.prototype.createSchema.call(this, options);\n        return new Schema({\n            nodes: schema.spec.nodes\n                .addBefore(\"image\", \"dc-image-link\", DcImageLinkNode())\n                .addBefore(\"image\", \"dc-content-link\", DcContentLinkNode()),\n            marks: schema.spec.marks,\n        });\n    };\n    JSONLanguage.prototype.getNodeSerializers = function () {\n        return {\n            \"dc-image-link\": function () { return \"\"; },\n            \"dc-content-link\": function () { return \"\"; },\n        };\n    };\n    return JSONLanguage;\n}(MarkdownLanguage));\nexport default JSONLanguage;\nfunction groupBy(items, groupFn) {\n    var result = [];\n    var currentGroup = null;\n    var currentGroupItems = [];\n    for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n        var item = items_1[_i];\n        var itemGroup = groupFn(item);\n        if (itemGroup === undefined) {\n            continue;\n        }\n        if (currentGroup === null) {\n            currentGroup = itemGroup;\n            currentGroupItems = [item];\n        }\n        else if (currentGroup === itemGroup) {\n            currentGroupItems.push(item);\n        }\n        else {\n            if (currentGroupItems.length > 0) {\n                result.push({\n                    group: currentGroup,\n                    items: currentGroupItems,\n                });\n            }\n            currentGroup = itemGroup;\n            currentGroupItems = [item];\n        }\n    }\n    if (currentGroupItems.length > 0 && currentGroup !== null) {\n        result.push({\n            group: currentGroup,\n            items: currentGroupItems,\n        });\n    }\n    return result;\n}\n"],"sourceRoot":""}